<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from commons.wikimedia.org/wiki/User:Glrx by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 15 Oct 2022 19:10:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>User:Glrx - Wikimedia Commons</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"de286a74-cfb5-44aa-b1cb-b6849e8071e0","wgCSPNonce":false,"wgCanonicalNamespace":"User","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":2,"wgPageName":"User:Glrx","wgTitle":"Glrx","wgCurRevisionId":696349561,"wgRevisionId":696349561,"wgArticleId":113551363,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"User:Glrx","wgRelevantArticleId":113551363,"wgIsProbablyEditable":true,"wgRelevantPageIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRelevantUserName":"Glrx","wgVisualEditor":{"pageLanguageCode"
:"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgMFDisplayWikibaseDescriptions":{"search":true,"watchlist":true,"tagline":true,"nearby":true},"wgWMESchemaEditAttemptStepOversample":false,"wgWMEPageLength":200000,"wgNoticeProject":"commons","wgVector2022PreviewPages":[],"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":false,"wgULSCurrentAutonym":"English","wgEditSubmitButtonLabelPublish":true,"wbmiDefaultProperties":["P180"],"wbmiPropertyTitles":{"P180":"Items portrayed in this file"},"wbmiPropertyTypes":{"P180":"wikibase-item"},"wbmiRepoApiUrl":"/w/api.php","wbmiHelpUrls":{"P180":"https://commons.wikimedia.org/wiki/Special:MyLanguage/Commons:Depicts"},"wbmiExternalEntitySearchBaseUri":"https://www.wikidata.org/w/api.php","wbmiSupportedDataTypes":["wikibase-item","string","quantity","time","monolingualtext","external-id","globe-coordinate","url"],"wgCentralAuthMobileDomain":false,"wgULSPosition":"personal","wgULSisCompactLinksEnabled":true};RLSTATE={
"ext.gadget.Long-Image-Names-in-Categories":"ready","ext.gadget.uploadWizardMobile":"ready","ext.globalCssJs.user.styles":"ready","site.styles":"ready","user.styles":"ready","ext.globalCssJs.user":"ready","user":"ready","user.options":"loading","ext.cite.styles":"ready","ext.pygments":"ready","mediawiki.page.gallery.styles":"ready","ext.math.styles":"ready","skins.vector.styles.legacy":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.wikimediaBadges":"ready","ext.uls.pt":"ready"};RLPAGEMODULES=["ext.cite.ux-enhancements","ext.math.scripts","site","mediawiki.page.ready","mediawiki.toc","https://commons.wikimedia.org/wiki/skins.vector.legacy.js","mmv.head","mmv.bootstrap.autostart","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.eventLogging","ext.wikimediaEvents","ext.wikimediaEvents.wikibase","ext.navigationTiming","ext.centralNotice.geoIP","ext.centralNotice.startUp","ext.gadget.Slideshow","ext.gadget.ZoomViewer","ext.gadget.CollapsibleTemplates",
"ext.gadget.fastcci","ext.gadget.Stockphoto","ext.gadget.WatchlistNotice","ext.gadget.AjaxQuickDelete","ext.gadget.WikiMiniAtlas","ext.gadget.LanguageSelect","ext.centralauth.centralautologin","ext.uls.compactlinks","ext.uls.interface"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="https://commons.wikimedia.org/w/load.php?lang=en&amp;modules=ext.cite.styles%7Cext.math.styles%7Cext.pygments%2CwikimediaBadges%7Cext.uls.pt%7Cext.visualEditor.desktopArticleTarget.noscript%7Cmediawiki.page.gallery.styles%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://commons.wikimedia.org/w/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://commons.wikimedia.org/w/load.php?lang=en&amp;modules=ext.gadget.Long-Image-Names-in-Categories%2CuploadWizardMobile&amp;only=styles&amp;skin=vector"/>
<link rel="stylesheet" href="https://commons.wikimedia.org/w/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.40.0-wmf.5"/>
<meta name="referrer" content="origin"/>
<meta name="referrer" content="origin-when-crossorigin"/>
<meta name="referrer" content="origin-when-cross-origin"/>
<meta name="robots" content="max-image-preview:standard"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=1000"/>
<meta property="og:title" content="User:Glrx - Wikimedia Commons"/>
<meta property="og:type" content="website"/>
<link rel="preconnect" href="http://upload.wikimedia.org/"/>
<link rel="alternate" media="only screen and (max-width: 720px)" href="http://commons.m.wikimedia.org/wiki/User:Glrx"/>
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit"/>
<link rel="apple-touch-icon" href="https://commons.wikimedia.org/static/apple-touch/commons.png"/>
<link rel="icon" href="https://commons.wikimedia.org/static/favicon/commons.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://commons.wikimedia.org/w/opensearch_desc.php" title="Wikimedia Commons"/>
<link rel="EditURI" type="application/rsd+xml" href="http://commons.wikimedia.org/w/api.php?action=rsd"/>
<link rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="canonical" href="https://commons.wikimedia.org/wiki/User:Glrx"/>
<link rel="dns-prefetch" href="http://meta.wikimedia.org/" />
<link rel="dns-prefetch" href="http://login.wikimedia.org/"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-2 ns-subject mw-editable page-User_Glrx rootpage-User_Glrx skin-vector action-view skin-vector-legacy vector-toc-not-collapsed vector-feature-language-in-header-disabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-legacy-toc-disabled vector-feature-visual-enhancement-next-disabled vector-feature-article-tools-disabled"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"><!-- CentralNotice --></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-namespace">User</span><span class="mw-page-title-separator">:</span><span class="mw-page-title-main">Glrx</span></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Wikimedia Commons, the free media repository</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Notes_about_images"><span class="tocnumber">1</span> <span class="toctext">Notes about images</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Information_for_downsampling"><span class="tocnumber">1.1</span> <span class="toctext">Information for downsampling</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Caching"><span class="tocnumber">1.2</span> <span class="toctext">Caching</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Caches_can_cause_trouble"><span class="tocnumber">1.3</span> <span class="toctext">Caches can cause trouble</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#More_on_server_caching"><span class="tocnumber">1.4</span> <span class="toctext">More on server caching</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Domain_names"><span class="tocnumber">1.5</span> <span class="toctext">Domain names</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Alt_text"><span class="tocnumber">1.6</span> <span class="toctext">Alt text</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Page_regeneration"><span class="tocnumber">1.7</span> <span class="toctext">Page regeneration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#SVG_images"><span class="tocnumber">2</span> <span class="toctext">SVG images</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Directly_serving_SVG"><span class="tocnumber">2.1</span> <span class="toctext">Directly serving SVG</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#SVG_is_XML_or_not"><span class="tocnumber">2.2</span> <span class="toctext">SVG is XML or not</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#XML_details"><span class="tocnumber">2.2.1</span> <span class="toctext">XML details</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#SVG_treading_where_it_should_not"><span class="tocnumber">2.2.2</span> <span class="toctext">SVG treading where it should not</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#SVG_DOM"><span class="tocnumber">2.2.3</span> <span class="toctext">SVG DOM</span></a>
<ul>
<li class="toclevel-4 tocsection-15"><a href="#Style_information_in_the_DOM"><span class="tocnumber">2.2.3.1</span> <span class="toctext">Style information in the DOM</span></a></li>
<li class="toclevel-4 tocsection-16"><a href="#Attributes_that_could_be_removed"><span class="tocnumber">2.2.3.2</span> <span class="toctext">Attributes that could be removed</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#SVG_recommendations"><span class="tocnumber">3</span> <span class="toctext">SVG recommendations</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#File_size"><span class="tocnumber">3.1</span> <span class="toctext">File size</span></a>
<ul>
<li class="toclevel-3 tocsection-19"><a href="#Polar_patterns"><span class="tocnumber">3.1.1</span> <span class="toctext">Polar patterns</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Compression_using_pattern_elements"><span class="tocnumber">3.1.2</span> <span class="toctext">Compression using pattern elements</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-21"><a href="#Title_and_description"><span class="tocnumber">3.2</span> <span class="toctext">Title and description</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Metadata"><span class="tocnumber">3.3</span> <span class="toctext">Metadata</span></a>
<ul>
<li class="toclevel-3 tocsection-23"><a href="#Other_metadata"><span class="tocnumber">3.3.1</span> <span class="toctext">Other metadata</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#The_mess_that_is_xml:lang"><span class="tocnumber">3.3.2</span> <span class="toctext">The mess that is xml:lang</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#Creative_Commons_license_requirements"><span class="tocnumber">3.3.3</span> <span class="toctext">Creative Commons license requirements</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#Dublin_Core_and_Creative_Commons"><span class="tocnumber">3.3.4</span> <span class="toctext">Dublin Core and Creative Commons</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#Dublin_Core"><span class="tocnumber">3.3.5</span> <span class="toctext">Dublin Core</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Creative_Commons"><span class="tocnumber">3.3.6</span> <span class="toctext">Creative Commons</span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#Creative_Commons_and_closure"><span class="tocnumber">3.3.7</span> <span class="toctext">Creative Commons and closure</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#Adobe_Systems_XMP"><span class="tocnumber">3.3.8</span> <span class="toctext">Adobe Systems XMP</span></a></li>
<li class="toclevel-3 tocsection-31"><a href="#Inkscape_metadata"><span class="tocnumber">3.3.9</span> <span class="toctext">Inkscape metadata</span></a></li>
<li class="toclevel-3 tocsection-32"><a href="#Well-known_licenses"><span class="tocnumber">3.3.10</span> <span class="toctext">Well-known licenses</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#Metadata_checker"><span class="tocnumber">3.3.11</span> <span class="toctext">Metadata checker</span></a>
<ul>
<li class="toclevel-4 tocsection-34"><a href="#Related_topics"><span class="tocnumber">3.3.11.1</span> <span class="toctext">Related topics</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-35"><a href="#Removing_metadata"><span class="tocnumber">3.3.12</span> <span class="toctext">Removing metadata</span></a></li>
<li class="toclevel-3 tocsection-36"><a href="#Other_uses_of_metadata"><span class="tocnumber">3.3.13</span> <span class="toctext">Other uses of metadata</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-37"><a href="#Detect_symbol_candidates"><span class="tocnumber">3.4</span> <span class="toctext">Detect symbol candidates</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Use_styles"><span class="tocnumber">3.5</span> <span class="toctext">Use styles</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-39"><a href="#SVG_text"><span class="tocnumber">4</span> <span class="toctext">SVG text</span></a>
<ul>
<li class="toclevel-2 tocsection-40"><a href="#Fonts"><span class="tocnumber">4.1</span> <span class="toctext">Fonts</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#Character_encoding"><span class="tocnumber">4.2</span> <span class="toctext">Character encoding</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Character_metrics"><span class="tocnumber">4.3</span> <span class="toctext">Character metrics</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Path_text"><span class="tocnumber">4.4</span> <span class="toctext">Path text</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Glyphs"><span class="tocnumber">4.5</span> <span class="toctext">Glyphs</span></a>
<ul>
<li class="toclevel-3 tocsection-45"><a href="#SVG_2.0_drops_glyph"><span class="tocnumber">4.5.1</span> <span class="toctext">SVG 2.0 drops glyph</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="#Glyphs_would_not_work_with_some_scripts"><span class="tocnumber">4.5.2</span> <span class="toctext">Glyphs would not work with some scripts</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-47"><a href="#WMF_prohibits_web_fonts"><span class="tocnumber">4.6</span> <span class="toctext">WMF prohibits web fonts</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#Alberta_road_signs"><span class="tocnumber">4.7</span> <span class="toctext">Alberta road signs</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#Text_anchors"><span class="tocnumber">4.8</span> <span class="toctext">Text anchors</span></a></li>
<li class="toclevel-2 tocsection-50"><a href="#Text_anchors,_direction,_and_BIDI"><span class="tocnumber">4.9</span> <span class="toctext">Text anchors, direction, and BIDI</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-51"><a href="#SVG_warts"><span class="tocnumber">5</span> <span class="toctext">SVG warts</span></a>
<ul>
<li class="toclevel-2 tocsection-52"><a href="#SVG_is_not_HTML"><span class="tocnumber">5.1</span> <span class="toctext">SVG is not HTML</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="#Zoom_and_pan"><span class="tocnumber">5.2</span> <span class="toctext">Zoom and pan</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-54"><a href="#MediaWiki_problems"><span class="tocnumber">6</span> <span class="toctext">MediaWiki problems</span></a></li>
<li class="toclevel-1 tocsection-55"><a href="#librsvg_color_issue"><span class="tocnumber">7</span> <span class="toctext">librsvg color issue</span></a>
<ul>
<li class="toclevel-2 tocsection-56"><a href="#MediaWiki_whitelisted_namespaces"><span class="tocnumber">7.1</span> <span class="toctext">MediaWiki whitelisted namespaces</span></a>
<ul>
<li class="toclevel-3 tocsection-57"><a href="#MathML_namespace"><span class="tocnumber">7.1.1</span> <span class="toctext">MathML namespace</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-58"><a href="#Future"><span class="tocnumber">8</span> <span class="toctext">Future</span></a></li>
<li class="toclevel-1 tocsection-59"><a href="#General_issues"><span class="tocnumber">9</span> <span class="toctext">General issues</span></a></li>
<li class="toclevel-1 tocsection-60"><a href="#Converting_bitmaps_to_SVG"><span class="tocnumber">10</span> <span class="toctext">Converting bitmaps to SVG</span></a>
<ul>
<li class="toclevel-2 tocsection-61"><a href="#Issues"><span class="tocnumber">10.1</span> <span class="toctext">Issues</span></a>
<ul>
<li class="toclevel-3 tocsection-62"><a href="#Straightforward_conversions"><span class="tocnumber">10.1.1</span> <span class="toctext">Straightforward conversions</span></a></li>
<li class="toclevel-3 tocsection-63"><a href="#Less_simple_conversions"><span class="tocnumber">10.1.2</span> <span class="toctext">Less simple conversions</span></a></li>
<li class="toclevel-3 tocsection-64"><a href="#Conversions_with_gradients"><span class="tocnumber">10.1.3</span> <span class="toctext">Conversions with gradients</span></a></li>
<li class="toclevel-3 tocsection-65"><a href="#Conversions_should_be_good"><span class="tocnumber">10.1.4</span> <span class="toctext">Conversions should be good</span></a></li>
<li class="toclevel-3 tocsection-66"><a href="#Multiline_text_causes_trouble"><span class="tocnumber">10.1.5</span> <span class="toctext">Multiline text causes trouble</span></a></li>
<li class="toclevel-3 tocsection-67"><a href="#Stepped_conversions"><span class="tocnumber">10.1.6</span> <span class="toctext">Stepped conversions</span></a></li>
<li class="toclevel-3 tocsection-68"><a href="#A_stepped_conversion_with_difficult_image"><span class="tocnumber">10.1.7</span> <span class="toctext">A stepped conversion with difficult image</span></a></li>
<li class="toclevel-3 tocsection-69"><a href="#Significant_detail"><span class="tocnumber">10.1.8</span> <span class="toctext">Significant detail</span></a></li>
<li class="toclevel-3 tocsection-70"><a href="#Trees_have_significant_detail"><span class="tocnumber">10.1.9</span> <span class="toctext">Trees have significant detail</span></a></li>
<li class="toclevel-3 tocsection-71"><a href="#Even_synthetic_images_can_have_significant_detail"><span class="tocnumber">10.1.10</span> <span class="toctext">Even synthetic images can have significant detail</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-72"><a href="#Stamps"><span class="tocnumber">10.2</span> <span class="toctext">Stamps</span></a>
<ul>
<li class="toclevel-3 tocsection-73"><a href="#Rectangular_stamp"><span class="tocnumber">10.2.1</span> <span class="toctext">Rectangular stamp</span></a></li>
<li class="toclevel-3 tocsection-74"><a href="#Round_stamp"><span class="tocnumber">10.2.2</span> <span class="toctext">Round stamp</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-75"><a href="#Vectorization"><span class="tocnumber">10.3</span> <span class="toctext">Vectorization</span></a></li>
<li class="toclevel-2 tocsection-76"><a href="#Recovering_text"><span class="tocnumber">10.4</span> <span class="toctext">Recovering text</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-77"><a href="#Translations:_internationalization_and_localization"><span class="tocnumber">11</span> <span class="toctext">Translations: internationalization and localization</span></a>
<ul>
<li class="toclevel-2 tocsection-78"><a href="#Translations_are_welcome,_but_they_have_costs"><span class="tocnumber">11.1</span> <span class="toctext">Translations are welcome, but they have costs</span></a></li>
<li class="toclevel-2 tocsection-79"><a href="#The_translations_do_not_fit"><span class="tocnumber">11.2</span> <span class="toctext">The translations do not fit</span></a></li>
<li class="toclevel-2 tocsection-80"><a href="#MediaWiki_problems_2"><span class="tocnumber">11.3</span> <span class="toctext">MediaWiki problems</span></a></li>
<li class="toclevel-2 tocsection-81"><a href="#MediaWiki_language_matching"><span class="tocnumber">11.4</span> <span class="toctext">MediaWiki language matching</span></a></li>
<li class="toclevel-2 tocsection-82"><a href="#MediaWiki_language_default"><span class="tocnumber">11.5</span> <span class="toctext">MediaWiki language default</span></a></li>
<li class="toclevel-2 tocsection-83"><a href="#MediaWiki_language_advertisements"><span class="tocnumber">11.6</span> <span class="toctext">MediaWiki language advertisements</span></a></li>
<li class="toclevel-2 tocsection-84"><a href="#How_MediaWiki_handles_images"><span class="tocnumber">11.7</span> <span class="toctext">How MediaWiki handles images</span></a></li>
<li class="toclevel-2 tocsection-85"><a href="#MediaWiki_source_code"><span class="tocnumber">11.8</span> <span class="toctext">MediaWiki source code</span></a></li>
<li class="toclevel-2 tocsection-86"><a href="#Language_variants"><span class="tocnumber">11.9</span> <span class="toctext">Language variants</span></a></li>
<li class="toclevel-2 tocsection-87"><a href="#Languages_and_fonts"><span class="tocnumber">11.10</span> <span class="toctext">Languages and fonts</span></a></li>
<li class="toclevel-2 tocsection-88"><a href="#Languages_and_layout"><span class="tocnumber">11.11</span> <span class="toctext">Languages and layout</span></a></li>
<li class="toclevel-2 tocsection-89"><a href="#Internationalization_(i18n)_and_localization_(i10n)"><span class="tocnumber">11.12</span> <span class="toctext">Internationalization (i18n) and localization (i10n)</span></a></li>
<li class="toclevel-2 tocsection-90"><a href="#List_of_languages"><span class="tocnumber">11.13</span> <span class="toctext">List of languages</span></a></li>
<li class="toclevel-2 tocsection-91"><a href="#Problem_file"><span class="tocnumber">11.14</span> <span class="toctext">Problem file</span></a>
<ul>
<li class="toclevel-3 tocsection-92"><a href="#Planar_translations"><span class="tocnumber">11.14.1</span> <span class="toctext">Planar translations</span></a></li>
<li class="toclevel-3 tocsection-93"><a href="#Inkscape"><span class="tocnumber">11.14.2</span> <span class="toctext">Inkscape</span></a></li>
<li class="toclevel-3 tocsection-94"><a href="#Colors"><span class="tocnumber">11.14.3</span> <span class="toctext">Colors</span></a></li>
<li class="toclevel-3 tocsection-95"><a href="#Place_names"><span class="tocnumber">11.14.4</span> <span class="toctext">Place names</span></a></li>
<li class="toclevel-3 tocsection-96"><a href="#Finding_place_names"><span class="tocnumber">11.14.5</span> <span class="toctext">Finding place names</span></a></li>
<li class="toclevel-3 tocsection-97"><a href="#Source_data"><span class="tocnumber">11.14.6</span> <span class="toctext">Source data</span></a>
<ul>
<li class="toclevel-4 tocsection-98"><a href="#Wikidata_API_queries"><span class="tocnumber">11.14.6.1</span> <span class="toctext">Wikidata API queries</span></a></li>
<li class="toclevel-4 tocsection-99"><a href="#Position-based_SPARQL_query"><span class="tocnumber">11.14.6.2</span> <span class="toctext">Position-based SPARQL query</span></a></li>
<li class="toclevel-4 tocsection-100"><a href="#Inverted_SPARQL_query"><span class="tocnumber">11.14.6.3</span> <span class="toctext">Inverted SPARQL query</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-101"><a href="#Fixes"><span class="tocnumber">11.14.7</span> <span class="toctext">Fixes</span></a>
<ul>
<li class="toclevel-4 tocsection-102"><a href="#Locations"><span class="tocnumber">11.14.7.1</span> <span class="toctext">Locations</span></a></li>
<li class="toclevel-4 tocsection-103"><a href="#Styling_with_class"><span class="tocnumber">11.14.7.2</span> <span class="toctext">Styling with class</span></a></li>
<li class="toclevel-4 tocsection-104"><a href="#Dates"><span class="tocnumber">11.14.7.3</span> <span class="toctext">Dates</span></a></li>
<li class="toclevel-4 tocsection-105"><a href="#Symbols"><span class="tocnumber">11.14.7.4</span> <span class="toctext">Symbols</span></a></li>
<li class="toclevel-4 tocsection-106"><a href="#SVG_Translate_bogus_langtags"><span class="tocnumber">11.14.7.5</span> <span class="toctext">SVG Translate bogus langtags</span></a></li>
<li class="toclevel-4 tocsection-107"><a href="#Text_element_within_switches_with_coordinates"><span class="tocnumber">11.14.7.6</span> <span class="toctext">Text element within switches with coordinates</span></a></li>
<li class="toclevel-4 tocsection-108"><a href="#Elements_with_redundant_style_information"><span class="tocnumber">11.14.7.7</span> <span class="toctext">Elements with redundant style information</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-109"><a href="#A_better_understanding_of_casual_group_formatting"><span class="tocnumber">11.14.8</span> <span class="toctext">A better understanding of casual group formatting</span></a></li>
<li class="toclevel-3 tocsection-110"><a href="#Languages:_LTR_and_RTL"><span class="tocnumber">11.14.9</span> <span class="toctext">Languages: LTR and RTL</span></a></li>
<li class="toclevel-3 tocsection-111"><a href="#Metadata_for_the_file"><span class="tocnumber">11.14.10</span> <span class="toctext">Metadata for the file</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-112"><a href="#SVG_Translate"><span class="tocnumber">12</span> <span class="toctext">SVG Translate</span></a>
<ul>
<li class="toclevel-2 tocsection-113"><a href="#SVG_Translate_usage"><span class="tocnumber">12.1</span> <span class="toctext">SVG Translate usage</span></a></li>
<li class="toclevel-2 tocsection-114"><a href="#Translate_me!"><span class="tocnumber">12.2</span> <span class="toctext">Translate me!</span></a></li>
<li class="toclevel-2 tocsection-115"><a href="#Good_translation_targets"><span class="tocnumber">12.3</span> <span class="toctext">Good translation targets</span></a></li>
<li class="toclevel-2 tocsection-116"><a href="#SVG_Translate_Issues"><span class="tocnumber">12.4</span> <span class="toctext">SVG Translate Issues</span></a>
<ul>
<li class="toclevel-3 tocsection-117"><a href="#The_default_clause_problem"><span class="tocnumber">12.4.1</span> <span class="toctext">The default clause problem</span></a></li>
<li class="toclevel-3 tocsection-118"><a href="#Autocomplete"><span class="tocnumber">12.4.2</span> <span class="toctext">Autocomplete</span></a></li>
<li class="toclevel-3 tocsection-119"><a href="#SVG_Translate_should_handle_textPath"><span class="tocnumber">12.4.3</span> <span class="toctext">SVG Translate should handle textPath</span></a></li>
<li class="toclevel-3 tocsection-120"><a href="#SVG_Translate_descends_too_deeply"><span class="tocnumber">12.4.4</span> <span class="toctext">SVG Translate descends too deeply</span></a></li>
<li class="toclevel-3 tocsection-121"><a href="#Does_SVG_Translate_multiply_text?_No."><span class="tocnumber">12.4.5</span> <span class="toctext">Does SVG Translate multiply text? No.</span></a></li>
<li class="toclevel-3 tocsection-122"><a href="#SVG_Translate_switch_processing"><span class="tocnumber">12.4.6</span> <span class="toctext">SVG Translate switch processing</span></a></li>
<li class="toclevel-3 tocsection-123"><a href="#Check_switch_processing"><span class="tocnumber">12.4.7</span> <span class="toctext">Check switch processing</span></a></li>
<li class="toclevel-3 tocsection-124"><a href="#DOM:_tags_and_namespace"><span class="tocnumber">12.4.8</span> <span class="toctext">DOM: tags and namespace</span></a></li>
<li class="toclevel-3 tocsection-125"><a href="#Is_the_svg_prefix_required?"><span class="tocnumber">12.4.9</span> <span class="toctext">Is the svg prefix required?</span></a></li>
<li class="toclevel-3 tocsection-126"><a href="#Reorder_text_elements"><span class="tocnumber">12.4.10</span> <span class="toctext">Reorder text elements</span></a></li>
<li class="toclevel-3 tocsection-127"><a href="#The_underscore_issue"><span class="tocnumber">12.4.11</span> <span class="toctext">The underscore issue</span></a></li>
<li class="toclevel-3 tocsection-128"><a href="#The_number_of_tspan_elements_must_match"><span class="tocnumber">12.4.12</span> <span class="toctext">The number of tspan elements must match</span></a></li>
<li class="toclevel-3 tocsection-129"><a href="#The_$_issue"><span class="tocnumber">12.4.13</span> <span class="toctext">The $ issue</span></a></li>
<li class="toclevel-3 tocsection-130"><a href="#The_style_element_must_have_trailing_characters"><span class="tocnumber">12.4.14</span> <span class="toctext">The style element must have trailing characters</span></a></li>
<li class="toclevel-3 tocsection-131"><a href="#Hoisting_style_attributes"><span class="tocnumber">12.4.15</span> <span class="toctext">Hoisting style attributes</span></a></li>
<li class="toclevel-3 tocsection-132"><a href="#Splitting_langtags_duplicates_identifiers"><span class="tocnumber">12.4.16</span> <span class="toctext">Splitting langtags duplicates identifiers</span></a></li>
<li class="toclevel-3 tocsection-133"><a href="#PHP_static_analyzer"><span class="tocnumber">12.4.17</span> <span class="toctext">PHP static analyzer</span></a></li>
<li class="toclevel-3 tocsection-134"><a href="#Mere_mortals_cannot_view_the_log"><span class="tocnumber">12.4.18</span> <span class="toctext">Mere mortals cannot view the log</span></a></li>
<li class="toclevel-3 tocsection-135"><a href="#Phabricator_tickets"><span class="tocnumber">12.4.19</span> <span class="toctext">Phabricator tickets</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-136"><a href="#Hoisting_attributes"><span class="tocnumber">12.5</span> <span class="toctext">Hoisting attributes</span></a>
<ul>
<li class="toclevel-3 tocsection-137"><a href="#Class_and_Style_confuse_the_issue"><span class="tocnumber">12.5.1</span> <span class="toctext">Class and Style confuse the issue</span></a></li>
<li class="toclevel-3 tocsection-138"><a href="#Prefer_class"><span class="tocnumber">12.5.2</span> <span class="toctext">Prefer class</span></a></li>
<li class="toclevel-3 tocsection-139"><a href="#Transformation_rewrites"><span class="tocnumber">12.5.3</span> <span class="toctext">Transformation rewrites</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-140"><a href="#Multiline_trick"><span class="tocnumber">12.6</span> <span class="toctext">Multiline trick</span></a></li>
<li class="toclevel-2 tocsection-141"><a href="#WMF_warts"><span class="tocnumber">12.7</span> <span class="toctext">WMF warts</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-142"><a href="#SVG_and_Inkscape"><span class="tocnumber">13</span> <span class="toctext">SVG and Inkscape</span></a>
<ul>
<li class="toclevel-2 tocsection-143"><a href="#Inkscape_units"><span class="tocnumber">13.1</span> <span class="toctext">Inkscape units</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-144"><a href="#Accuracy"><span class="tocnumber">14</span> <span class="toctext">Accuracy</span></a>
<ul>
<li class="toclevel-2 tocsection-145"><a href="#Motors"><span class="tocnumber">14.1</span> <span class="toctext">Motors</span></a></li>
<li class="toclevel-2 tocsection-146"><a href="#Microphones_and_flux_path"><span class="tocnumber">14.2</span> <span class="toctext">Microphones and flux path</span></a></li>
<li class="toclevel-2 tocsection-147"><a href="#Vacuum_pumps_and_details"><span class="tocnumber">14.3</span> <span class="toctext">Vacuum pumps and details</span></a></li>
<li class="toclevel-2 tocsection-148"><a href="#Biology"><span class="tocnumber">14.4</span> <span class="toctext">Biology</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-149"><a href="#Copyright"><span class="tocnumber">15</span> <span class="toctext">Copyright</span></a></li>
<li class="toclevel-1 tocsection-150"><a href="#MediaWiki_upgrades"><span class="tocnumber">16</span> <span class="toctext">MediaWiki upgrades</span></a>
<ul>
<li class="toclevel-2 tocsection-151"><a href="#Command_line_arguments"><span class="tocnumber">16.1</span> <span class="toctext">Command line arguments</span></a></li>
<li class="toclevel-2 tocsection-152"><a href="#Resvg_command_line_arguments"><span class="tocnumber">16.2</span> <span class="toctext">Resvg command line arguments</span></a></li>
<li class="toclevel-2 tocsection-153"><a href="#MediaWiki_external_converter"><span class="tocnumber">16.3</span> <span class="toctext">MediaWiki external converter</span></a></li>
<li class="toclevel-2 tocsection-154"><a href="#Thumbor"><span class="tocnumber">16.4</span> <span class="toctext">Thumbor</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-155"><a href="#HTML_5"><span class="tocnumber">17</span> <span class="toctext">HTML 5</span></a></li>
<li class="toclevel-1 tocsection-156"><a href="#References"><span class="tocnumber">18</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Notes_about_images">Notes about images</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=1" title="Edit section: Notes about images">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:Mona_Lisa,_by_Leonardo_da_Vinci,_from_C2RMF_retouched.jpg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/220px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg" decoding="async" width="220" height="328" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/330px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/440px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg 2x" data-file-width="7479" data-file-height="11146" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:Mona_Lisa,_by_Leonardo_da_Vinci,_from_C2RMF_retouched.jpg" class="internal" title="Enlarge"></a></div>Mona Lisa JPEG image is 90&#160;MB. The served JPEG is 21&#160;kB.</div></div></div>
<p>WMF does some interesting processing when it displays images. One might think that a JPEG image of the Mona Lisa is just transmitted to a browser, but that is not the case. The <a href="https://commons.wikimedia.org/wiki/File:Mona_Lisa,_by_Leonardo_da_Vinci,_from_C2RMF_retouched.jpg" title="File:Mona Lisa, by Leonardo da Vinci, from C2RMF retouched.jpg">File:Mona Lisa, by Leonardo da Vinci, from C2RMF retouched.jpg</a> is 90&#160;MB, and that much data takes time to transmit (about 1 second at 1&#160;Gbit/s or 10 seconds at 100&#160;Mbit/s) and could put a big dent in a modest cellular telephone data plan.
</p><p>Instead, WMF does something different. The 90&#160;MB, 7,479 × 11,146 pixel, JPEG is downsampled to the display size. The result is a small image is transferred over the network. The transfer is faster, and the impact on data bandwidth and data plans is much smaller. For example, the downsampled JPEG is just 21143 bytes, a mere fraction of 90&#160;MB.
</p>
<h3><span class="mw-headline" id="Information_for_downsampling">Information for downsampling</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=2" title="Edit section: Information for downsampling">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The wiki markup will specify a particular image to display. The markup will specify a desired size (such as a width of 160 pixels).
</p><p>Below is speculation. JPEG and PNG files may be reparsed at each inclusion. I need to check the sources.
</p><p>I expect a database to hold critical properties. With quick access to some properties, it will not be necessary to parse the image file or the image description page. Such properties would be a base URL, file type, width, and height should be accessed quickly. From that information, one could quickly determine the HTML to include the image. The <code>img</code> element's width, height, and URL can be determined without reading the image file.
</p><p>That is not true for SVG files. The image size can be determined, but SVG URLs many need to specify the desired language. My understanding is the SVG file must be parsed to learn the IETF language tags that the file supports (that step can be skipped if <style data-mw-deduplicate="TemplateStyles:r588530194">.mw-parser-output .nowrap,.mw-parser-output .nowrap a:before,.mw-parser-output .nowrap .selflink:before{white-space:nowrap}</style><code class="nowrap">&#124;lang&#61;</code> is set or for the en.Wiki). Reparsing the file makes using an SVG file expensive.
</p><p><small>
</small></p><small><dl><dd><b>Note</b>: Looks like SVG files need not be reparsed for languages. The MW database has an edited list of languages in its metadata. A MediaWiki API <code>imageinfo</code> query provides metadata and languages (MW type not IETF?):
<ul><li><a class="external free" href="https://commons.wikimedia.org/w/api.php?action=query&amp;format=jsonfm&amp;prop=imageinfo&amp;titles=File%3A2022_Russian_invasion_of_Ukraine.svg&amp;iiprop=timestamp%7Cuser%7Cmetadata">https://commons.wikimedia.org/w/api.php?action=query&amp;format=jsonfm&amp;prop=imageinfo&amp;titles=File%3A2022_Russian_invasion_of_Ukraine.svg&amp;iiprop=timestamp%7Cuser%7Cmetadata</a></li></ul></dd>
<dd>Languages are filtered: <code>zh_CN</code> does not appear. Non-existent langtags also appear: <code>zh</code>.</dd>
<dd><a class="external free" href="https://www.mediawiki.org/wiki/Manual:File_metadata_handling">https://www.mediawiki.org/wiki/Manual:File_metadata_handling</a></dd></dl></small><small></small><p><small></small>
</p>
<h3><span class="mw-headline" id="Caching">Caching</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=3" title="Edit section: Caching">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The WMF servers confront a computational burden because they must downsample the image, but local computation is less expensive than data bandwidth.
</p><p>In addition, WMF servers also cache the images that it downsamples. If I ask for Mona Lisa at a particular width, then a WMF server will generate that size. That work is stored in a cache, so if I or somebody else asks for the same size image at another time, the cached version is supplied rather than re-downsampling the image. The cache saves computation and time.
</p><p>The moment when the caching is done is also significant. Although I can ask for images at particular sizes, the usual scenario is the image (such as Mona Lisa) is used on a wiki article page. When a wiki page is updated, MediaWiki rebuilds the wiki page (creating a cached version of the wiki page) and also caching any new images that were added to the page. That can require a lot of computation, but the result is the wiki page and all of its images are now in the server caches. Preloading the cache reduces the latency that a user would experience when he views the page. He need only wait for the data to be transferred; he would not wait for the downsampling because it has already been done.
</p><p>Moreover, WMF is telling my browser to cache local copies on my computer. If I view a wiki page with the Mona Lisa image on it, the wiki page and the Mona Lisa image are copied to my computer. I can leave that wiki page, but the local copies remain on my computer. If I reload the page later, my browser can display the page without re-downloading the page and image from the WMF server.
</p><p>That local caching interaction can be involved. The mechanism is part of the Hyper Text Transfer Protocol (HTTP). When a server transfers web pages or images using HTTP, it will specify some caching information. That information tells my browser if it may cache the data and how long the cached data is accurate.<sup id="cite_ref-1" class="reference"><a href="#cite_note-1">&#91;1&#93;</a></sup>
</p>
<h3><span class="mw-headline" id="Caches_can_cause_trouble">Caches can cause trouble</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=4" title="Edit section: Caches can cause trouble">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Say wiki page ABC uses an image XYZ.
</p><p>If page ABC is rebuilt every time it is accessed, then the page will always be up to date. If the page is cached, then the cache may have a stale version.
</p><p>If somebody edits page ABC, then it is clear that page ABC should be purged from the cache.
</p><p>If somebody edits image XYZ, then the cache should be cleared of XYZ. But the appearance of page ABC may also change even though none of the wikitext for page ABC has changed. How does page ABC get updated?
</p><p>If the aspect ratio of XYZ does not change, then nothing much needs to happen. When page ABC is accessed, it comes out of the cache. The cached page has a reference to XYZ, but that image has been invalidated, so the new version of XYZ is fetched.
</p><p>If the aspect ratio of XYZ changed, then the layout of ABC may have been altered. ABC needs to be rebuilt. MW maintains a database of where each image is used, so MW can invalidate all of the pages that use XYZ. There is a cascade: the invalidated pages may be transcluded, so more pages may need to be invalidated and rebuilt.
</p>
<h3><span class="mw-headline" id="More_on_server_caching">More on server caching</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=5" title="Edit section: More on server caching">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The server cache can be a separate set of servers positioned between the users and the actual servers. WMF uses Varnish.
</p>
<ul><li><a rel="nofollow" class="external free" href="https://wp-rocket.me/blog/varnish-http-cache-server/">https://wp-rocket.me/blog/varnish-http-cache-server/</a> Varnish Cache: How It Works and How to Use It on Your WordPress Site, July 29, 2021, Alice Orru</li>
<li><a rel="nofollow" class="external free" href="https://www.oreilly.com/library/view/getting-started-with/9781491972212/ch01.html">https://www.oreilly.com/library/view/getting-started-with/9781491972212/ch01.html</a> Getting Started with Varnish Cache, 15 September 2016, Thijs Feryn</li>
<li><a href="https://en.wikipedia.org/wiki/Varnish_(software)" class="extiw" title="w:Varnish (software)">w:Varnish (software)</a></li>
<li><a rel="nofollow" class="external free" href="https://queue.acm.org/detail.cfm?id=1814327">https://queue.acm.org/detail.cfm?id=1814327</a> You're Doing It Wrong, Queue vol. 8, no. 6, 11 June 2010, Poul-Henning Kamp</li></ul>
<h3><span class="mw-headline" id="Domain_names">Domain names</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=6" title="Edit section: Domain names">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Domain names such as <code>commons.wikimedia.org</code> or <code>upload.wikimedia.org</code> must be resolved to an IP address. That resolution need not be to a single IP address. Check namespace resolution and redirect messages as ways to shuffle the load.
</p><p>A domain name resolves to one IP address. Many domain names may resolve to the same IP address.<sup id="cite_ref-2" class="reference"><a href="#cite_note-2">&#91;2&#93;</a></sup> But I think a name may have many <code>A</code> records. I'm looking for information about random selection.<sup id="cite_ref-3" class="reference"><a href="#cite_note-3">&#91;3&#93;</a></sup>
</p>
<h3><span class="mw-headline" id="Alt_text">Alt text</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=7" title="Edit section: Alt text">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Proposal about <code>alt=</code> text being added to HTML.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/Commons:Village_pump/Proposals#Adding_alt_texts_through_structured_data" title="Commons:Village pump/Proposals">Commons:Village_pump/Proposals#Adding_alt_texts_through_structured_data</a> circa July 2022</li></ul>
<h3><span class="mw-headline" id="Page_regeneration">Page regeneration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=8" title="Edit section: Page regeneration">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Consider a typical Wikipedia page. It will use templates and images.
</p><p>If one of the templates is edited, then the Wikipedia page probably needs to be rebuilt. The template may affect the page content or layout. MediaWiki keeps track of which pages use a template, so when a template is edited, then MediaWiki knows which pages need to be regenerated. There can also be as cascade because some templates use other templates.
</p><p>That means that editing a template that is used on thousands of Wikipedia pages would trigger the regeneration of thousands of Wikipedia pages. Editing commonly used templates should not be done lightly. Commonly used templates may be protected. For example, <a href="https://commons.wikimedia.org/wiki/Template:Cite_book" title="Template:Cite book"><span style="font-family:monospace,monospace;">&#123;&#123;Cite book&#125;&#125;</span></a> on the English Wikipedia affects almost 1.5 million pages.
</p><p>Editing an image does not require rebuilding the pages that use the image. The page still references the same image name, but now the image scalers will supply the new image rather than the old one. The cached HTML of the Wikipedia page is still good.
</p><p>Well, not quite. When MediaWiki builds a page, it specifies the <code>width</code> and <code>height</code> attributes of the <code>img</code> element. That allows the browser to layout the page before it has downloaded all the images. That avoids continual layout adjustments as image sizes are learned. So rebuilding pages may be required. WikiMedia could just do it all the time, or it could update pages only if a significant change occurred. If the image aspect ratio changed, then <code>img</code> elements would need to be updated. If a multilingual SVG file added another language, then pages may need updating.
</p>
<h2><span class="mw-headline" id="SVG_images">SVG images</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=9" title="Edit section: SVG images">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:Gibraltar_map-en.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Gibraltar_map-en.svg/220px-Gibraltar_map-en.svg.png" decoding="async" width="220" height="342" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Gibraltar_map-en.svg/330px-Gibraltar_map-en.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Gibraltar_map-en.svg/440px-Gibraltar_map-en.svg.png 2x" data-file-width="2020" data-file-height="3140" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:Gibraltar_map-en.svg" class="internal" title="Enlarge"></a></div>SVG Map of Gibraltar is 290&#160;kB. The served PNG is 48&#160;kB.</div></div></div>
<p>WMF processes SVG images in a similar manner as JPEG images. Instead of serving the actual SVG file on a wiki page, WMF builds a PNG file of the requested width and serves the PNG. There are a couple of advantages to serving a PNG.
</p><p>First, serving the PNG file can be much smaller than the SVG file. For example, the SVG map of Gibraltar is 290&#160;kB. The request above produced a 48&#160;kB PNG file:
</p>
<pre>accept-ranges: bytes
access-control-allow-origin: *
access-control-expose-headers: Age, Date, Content-Length, Content-Range, X-Content-Duration, X-Cache
age: 74796
content-disposition: inline;filename*=UTF-8''Gibraltar_map-en.svg.png
content-length: 47987
content-type: image/png
date: Tue, 21 Dec 2021 02:25:44 GMT
etag: 8391f68640a7f0cedd3971fef7b8b3d3
last-modified: Mon, 01 Feb 2021 12:23:52 GMT
nel: { "report_to": "wm_nel", "max_age": 86400, "failure_fraction": 0.05, "success_fraction": 0.0}
permissions-policy: interest-cohort=()
report-to: { "group": "wm_nel", "max_age": 86400, "endpoints": [{ "url": "https://intake-logging.wikimedia.org/v1/events?stream=w3c.reportingapi.network_error&amp;schema_uri=/w3c/reportingapi/network_error/1.0.0" }] }
server: ATS/8.0.8
server-timing: cache;desc="hit-front", host;desc="cp1078"
strict-transport-security: max-age=106384710; includeSubDomains; preload
timing-allow-origin: *
x-cache: cp1078 hit, cp1078 hit/2
x-cache-status: hit-front
x-timestamp: 1612182231.00644
</pre>
<p>However, the SVG file is transferred with GZip compression; the transfer size is only 89&#160;kB. The compression factor is 290/89 = 3.26. The transfer size is larger than the PNG, but it is less than twice the size of the PNG (89/48 = 1.85).
</p><p>Second, when WMF started supporting the SVG file format, the browser support for SVG was nonexistent or uneven. Serving PNG files had strong support. Serving PNG renditions of SVG files also gives a uniform presentation. SVG images can vary depending upon the availability of particular fonts and the depth of SVG support.
</p>
<h3><span class="mw-headline" id="Directly_serving_SVG">Directly serving SVG</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=10" title="Edit section: Directly serving SVG">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><a href="https://phabricator.wikimedia.org/T5593" class="extiw" title="phab:T5593">SVG client side rendering (Phabricator T5593)</a>
</p><p>The <code>img</code> element allows animations but should block scripts. The <code>object</code> element allows scripts.
</p><p>Scripts can be malicious. WMF blocks uploading SVG files that contain scripts.
</p><p>What happens to mouse clicks? Wrap an <code>a</code> element around a bitmap file. Wrap it around an SVG file.
</p><p>SVG files can be malicious. An SVG file could be a computational nightmare that taxes the computer. PNG files will render in finite time. The SVG renderer on WMF servers put a time limit on the rendering. If it does not complete within a few seconds, then the process is terminated. There are some SVG files on Commons that can hit that time limit.
</p><p>There are some language translation differences when an SVG file is directly served; see below.
</p>
<h3><span class="mw-headline" id="SVG_is_XML_or_not">SVG is XML or not</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=11" title="Edit section: SVG is XML or not">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Dislike XML.
</p><p>SVG has namespaces, but HTML does not. HTML lossage creeps in.
</p><p>If XML is so good, why is CSS not XML?
</p>
<h4><span class="mw-headline" id="XML_details">XML details</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=12" title="Edit section: XML details">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Some notes for later.
</p><p>The XML Spec 1.0 (Fifth edition). <a rel="nofollow" class="external free" href="https://www.w3.org/TR/xml/">https://www.w3.org/TR/xml/</a>
</p><p>The XML prolog is optional.
</p>
<ul><li>XML version</li>
<li>encoding (ASCII / ISO issue) EBCDIC and UTF 16.</li>
<li>standalone
<dl><dd>From the XML specification &#167; 2.9:
<dl><dd>The standalone document declaration must have the value "no" if any external markup declarations contain declarations of:
<ul><li>attributes with default values, if elements to which these attributes apply appear in the document without specifications of values for these attributes, or</li>
<li>entities (other than <code>amp, lt, gt, apos, quot</code>), if references to those entities appear in the document, or</li>
<li>attributes with tokenized types, where the attribute appears in the document with a value such that <i>normalization</i> will produce a different value from that which would be produced in the absence of the declaration, or</li>
<li>element types with element content, if white space occurs directly within any instance of those types.</li></ul></dd></dl></dd></dl></li></ul>
<p>The default attribute values raise issues with <code>#REQUIRED</code>, <code>#IMPLIED</code>, <code>#FIXED</code> and <code>default</code>. <a rel="nofollow" class="external free" href="https://www.w3.org/TR/xml/#dt-default">https://www.w3.org/TR/xml/#dt-default</a>
</p><p>The SVG 1.1 <code>style</code> element has the <code>type</code> attribute, and that attribute is <code>#REQUIRED</code>. See <a rel="nofollow" class="external free" href="https://www.w3.org/Graphics/SVG/1.1/styling.html#StyleElement">https://www.w3.org/Graphics/SVG/1.1/styling.html#StyleElement</a>
That means <a href="https://phabricator.wikimedia.org/T68672" class="extiw" title="phab:T68672">Phab:T68672</a> ("SVG style element ignored if no type attribute is specified") may have been invalid, and that <a href="https://commons.wikimedia.org/wiki/Commons:Commons_SVG_Checker" title="Commons:Commons SVG Checker">Commons:Commons SVG Checker</a> should require <code>type="text/css"</code>.
</p><p>The <a rel="nofollow" class="external text" href="https://www.w3.org/TR/SVG11/svgdtd.html">SVG 1.1 DTD</a> has
</p>
<div class="mw-highlight mw-highlight-lang-dtd mw-content-ltr" dir="ltr"><pre><span></span><span class="k">&lt;!ATTLIST</span> <span class="nt">%SVG.style.qname;</span>
    <span class="kr">xml:space</span> <span class="o">(</span> <span class="na">preserve</span> <span class="o">)</span> <span class="kc">#FIXED</span> <span class="s1">&#39;preserve&#39;</span>
    <span class="ni">%SVG.id.attrib;</span>
    <span class="ni">%SVG.base.attrib;</span>
    <span class="ni">%SVG.lang.attrib;</span>
    <span class="ni">%SVG.Core.extra.attrib;</span>
    <span class="na">type</span> <span class="ni">%ContentType.datatype;</span> <span class="kc">#REQUIRED</span>
    <span class="na">media</span> <span class="ni">%MediaDesc.datatype;</span> <span class="kc">#IMPLIED</span>
    <span class="na">title</span> <span class="ni">%Text.datatype;</span> <span class="kc">#IMPLIED</span>
<span class="k">&gt;</span>
</pre></div>
<p>For SVG 2.0, the <code>type</code> attribute has an initial value of <code>text/css</code>. <a rel="nofollow" class="external free" href="https://svgwg.org/svg2-draft/styling.html#StyleElement">https://svgwg.org/svg2-draft/styling.html#StyleElement</a>
</p><p>There is also the <code>style</code> element content being a CDATA section. The SVG 1.1 conservative view was
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span>  <span class="nt">&lt;defs&gt;</span>
    <span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span><span class="cp">&lt;![CDATA[</span>
<span class="cp">      rect {</span>
<span class="cp">        fill: red;</span>
<span class="cp">        stroke: blue;</span>
<span class="cp">        stroke-width: 3</span>
<span class="cp">      }</span>
<span class="cp">    ]]&gt;</span><span class="nt">&lt;/style&gt;</span>
  <span class="nt">&lt;/defs&gt;</span>
</pre></div>
<p>The CDATA section was needed to avoid entity interpretation and &lt;. I remember having trouble at some point, but I think that was resolved by using CSS character literals rather than XML character literals. It may also be that the modern <code>style</code> element is a CDATA section rather than PCDATA. Find the references.
</p><p>That SVG snippet also shows the <code>style</code> element within a <code>defs</code> element. That used to be common practice, but it may have never been needed. The advantage of the <code>defs</code> element was its content would never be rendered. There is more to say about <code>defs</code>; many elements (such as <code>linearGradient</code>) do not need to be within a <code>defs</code> element.
</p>
<h4><span class="mw-headline" id="SVG_treading_where_it_should_not">SVG treading where it should not</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=13" title="Edit section: SVG treading where it should not">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>SVG is about representing vector images, but it often steps into areas that do not affect the appearance of the image or where it has no authority.
</p><p>Reinventing namespaces.
</p><p>Effectively merging <code>xml:lang</code> and <code>lang</code> attributes. If both exist, they must be equal. Why not just keep one? It also complicates the CSS <code>lang()</code> psuedo-selector. The only bad thing about <code>xml:lang</code> is its impact on RDF metadata, but that can be fixed with <code>xml:lang=""</code>. (Check XML specification.)
</p><p>Deprecating <code>xml:space</code> for CSS. XSLT knows how to handle <code>xml:space</code> but it does not know how to handle CSS. Compare the options. Also raise the issue about <code>text-anchor</code> and directions.
</p><p>Why merge <code>xlink:href</code> and <code>href</code>? The XLink specification exists and was incorporated. Look at other parts of XLink. Yes, there are better ways to handle titles. List the XLink attributes. A more pointed complaint is that having adopted <code>xlink:href</code> in SVG 1.0, switching to <code>href</code> in SVG 2.0 is not downward compatible. Why make a breaking change?
</p><p>The <code>translate</code> attribute is inherited from ITS and its <code>its:translate</code> attribute. The attribute tells language translators to not translate this text. It has no impact on the display of SVG. SVG is also missing features such as <code>its:term</code>. That tells language translators that the phrase is a technical term that should have a consistent translation. SVG should have just pointed to ITS and suggested its use. Yes, ITS should not be using multiple namespaces.
</p><p>The <code>data-*</code> attributes reinvent what should be the <code>data</code> namespace. Inherited from HTML. Also inherited is the crazy case-insensitive mapping that is not needed in case-sensitive XML. Show some examples. These attributes have no impact on the display of SVG. They are there to simplify some handling in the DOM, but that should be a separable extension.
</p><p>The <code>aria-*</code> attributes reinvent what should be the <code>aria</code> namespace. The SVG Working Group does not control the meaning of these screen reading attributes, so it should have just pointed to the ARIA specification. That specification should have used namespace syntax.
</p>
<h4><span class="mw-headline" id="SVG_DOM">SVG DOM</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=14" title="Edit section: SVG DOM">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Significant advantage.
</p><p>Looking for type hierarchy, but not seeing what I want.
</p><p>Descriptive elements <code>desc</code> and <code>title</code>.
</p><p>Metadata element <code>metadata</code>.
</p><p>Container elements such as <code>g</code>.
SVG 2.0 says, "An element which can have graphics elements and other container elements as child elements. Specifically: ‘a’, ‘clipPath’, ‘defs’, ‘g’, ‘marker’, ‘mask’, ‘pattern’, ‘svg’, ‘switch’ and ‘symbol’."
</p><p>Graphics elements such as <code>line</code> and <code>text</code>.
Inherits from
<a rel="nofollow" class="external text" href="https://developer.mozilla.org/en-US/docs/Web/API/SVGGraphicsElement">SVGGraphicsElement</a>, so it has some methods, but not a type?
<a rel="nofollow" class="external text" href="https://svgwg.org/svg2-draft/types.html#InterfaceSVGGraphicsElement">Interface SVGGraphicsElement</a>.
</p>
<h5><span class="mw-headline" id="Style_information_in_the_DOM">Style information in the DOM</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=15" title="Edit section: Style information in the DOM">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>I do not believe the SVG DOM makes all the <code>style</code> information available. A couple years ago I went looking for aural stylesheet information, and it was not there. Consequently, I do not believe that style properties such as <code>-inkscape-font-specification</code> are broken out. Does that mean that they disappear completely when the DOM is written out?
</p><p>It may be that none of such style properties make any difference, so removing them could be seen as beneficial.
</p>
<h5><span class="mw-headline" id="Attributes_that_could_be_removed">Attributes that could be removed</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=16" title="Edit section: Attributes that could be removed">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Is there a list of Inkscape attributes that are always safe to remove? For example, Inkscape could always regenerate the node type list. If Inkscape can regenerate the information, then why keep it?
</p>
<ul><li><code>sodipodi:nodetypes</code> attribute can be regenerated</li>
<li><code>sodipodi:role="line"</code></li>
<li><code>-inkscape-font-specification</code> CSS can be removed</li>
<li><code>line-height</code> CSS (has multiple defaults)</li>
<li><code>font-style</code> if default</li>
<li><code>font-weight</code> if default</li>
<li><code>font-stretch</code> if default</li>
<li><code>font-variant</code> if default (short cut?)</li>
<li><code>font-variant-ligatures</code> if default</li>
<li><code>font-variant-caps</code> if default</li>
<li><code>font-variant-numeric</code> if default</li>
<li><code>font-variant-east-asian</code> if default</li>
<li><code>letter-spacing</code> property if default</li>
<li><code>word-spacing</code> property if default</li></ul>
<p>Some Inkscape and sodipodi attributes should be preserved. Some <code>g</code> elements are identified as layers. Information about drawing grids does not take up much space, so removing that information does not have much benefit.
</p>
<ul><li><code>g</code> element (perhaps toplevel) with <code>inkscape:groupmode="layer"</code> and <code>inkscape:label="<i>name</i>"</code> and <code>id="<i>identifier</i>"</code>
<dl><dd>the <code>sodipodi:namedview</code> element will have <code>inkscape:current-layer="<i>identifier</i>"</code></dd></dl></li></ul>
<p>The significant benefit is removing verbose style information.
</p><p>Additional information to remove would be needless graphics state. For example, if <code>stroke="none"</code>, then we probably do not care about <code>stroke-width</code>, <code>stroke-dasharray</code>, <code>stroke-dashoffset</code>, line joins, and end caps. Some font information may be a little different. If text has been converted to curves, keeping that information around would help in reconstructing the text.
</p>
<h2><span class="mw-headline" id="SVG_recommendations">SVG recommendations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=17" title="Edit section: SVG recommendations">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Small size is a significant goal.
</p><p>SVG is not arbitrarily scalable. Scalable is more about eliminating jaggies.
</p><p>Fixed width lines. (CSS can adjust.)
</p><p>SVG is not a good file format for bitmap images such as bar codes and QR codes. Those objects are not arbitrarily scalable; they must fit on a pixel grid. One could use barcode fonts within an SVG file; fonts will align to an underlying pixel grid.
</p><p>Not for photographs (but can be used to label photographs).
</p><p>Limited colors (can use color gradients). Color blocking suggestions rather than enormous detail.
</p><p>Filters can produce complex objects such as chalk textures and clouds.
</p>
<h3><span class="mw-headline" id="File_size">File size</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=18" title="Edit section: File size">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>SVG files can be small, but they can also be surprisingly large.
</p>
<h4><span class="mw-headline" id="Polar_patterns">Polar patterns</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=19" title="Edit section: Polar patterns">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Consider some images from <a href="https://commons.wikimedia.org/wiki/Category:NAVAID_pictograms" title="Category:NAVAID pictograms">Category:NAVAID pictograms</a>:<sup id="cite_ref-4" class="reference"><a href="#cite_note-4">&#91;4&#93;</a></sup>
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:22.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Pictogram_TACAN.svg" class="image" title="TACAN navigation symbol is a reasonable 4&#160;kB."><img alt="TACAN navigation symbol is a reasonable 4&#160;kB." src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Pictogram_TACAN.svg/120px-Pictogram_TACAN.svg.png" decoding="async" width="120" height="105" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Pictogram_TACAN.svg/180px-Pictogram_TACAN.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Pictogram_TACAN.svg/240px-Pictogram_TACAN.svg.png 2x" data-file-width="97" data-file-height="85" /></a></div></div>
			<div class="gallerytext">
<p>TACAN navigation symbol is a reasonable 4&#160;kB.
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Pictogram_NDB.svg" class="image" title="NDB navigation symbol is a huge 224&#160;kB."><img alt="NDB navigation symbol is a huge 224&#160;kB." src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Pictogram_NDB.svg/120px-Pictogram_NDB.svg.png" decoding="async" width="120" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Pictogram_NDB.svg/180px-Pictogram_NDB.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Pictogram_NDB.svg/240px-Pictogram_NDB.svg.png 2x" data-file-width="95" data-file-height="95" /></a></div></div>
			<div class="gallerytext">
<p>NDB navigation symbol is a huge 224&#160;kB.
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Pictogram_NDB-DME.svg" class="image" title="NDB-DME navigation symbol is nearly as complex but uses only 11&#160;kB."><img alt="NDB-DME navigation symbol is nearly as complex but uses only 11&#160;kB." src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/Pictogram_NDB-DME.svg/120px-Pictogram_NDB-DME.svg.png" decoding="async" width="120" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/Pictogram_NDB-DME.svg/180px-Pictogram_NDB-DME.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/Pictogram_NDB-DME.svg/240px-Pictogram_NDB-DME.svg.png 2x" data-file-width="95" data-file-height="95" /></a></div></div>
			<div class="gallerytext">
<p>NDB-DME navigation symbol is nearly as complex but uses only 11&#160;kB.
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:45px auto;"><a href="https://commons.wikimedia.org/wiki/File:SVG_test_dasharray.svg" class="image" title="Test the display of zero-length dashes."><img alt="Test the display of zero-length dashes." src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f9/SVG_test_dasharray.svg/120px-SVG_test_dasharray.svg.png" decoding="async" width="120" height="60" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f9/SVG_test_dasharray.svg/180px-SVG_test_dasharray.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/f9/SVG_test_dasharray.svg/240px-SVG_test_dasharray.svg.png 2x" data-file-width="512" data-file-height="256" /></a></div></div>
			<div class="gallerytext">
<p>Test the display of zero-length dashes.
</p>
			</div>
		</div></li>
</ul>
<p>The first image is a central dot and 12 line segments, and it has a simple representation. The second image is problematic. it is a central dot, a central solid ring, and 10 dotted radial rings. It has a lot of dots, but why does it need so many bytes? Each dot is not a circle element, but rather a path that looks like a circle. The third image is nearly as complex (only 7 dotted rings), but it is a more efficient representation. Instead of round dots, it uses <code>stroke-dasharray</code> for the dots. Notice that the dash array has some issues along the north axis.
</p><p>We can get dots easily. Use a <code>circle</code> element (stroked but no fill), set the <code>stroke-dasharray="0 xxx"</code>, and set <code>stroke-linecap="round"</code>. The value <code>xxx</code> is chosen to be an integer fraction of the circumference. A close look at the NDB-DME symbol shows dashes instead of dots.
</p><p>There is a problem with <code>librsvg</code>: the <code>stroke-dasharray</code> attribute must use commas rather than spaces.
</p>
<h4><span class="mw-headline" id="Compression_using_pattern_elements">Compression using pattern elements</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=20" title="Edit section: Compression using pattern elements">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Here is a simple file that takes 307&#160;kB:
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Blason_ville_fr_Dinard_(Ille-et-Vilaine).svg" class="image" title="307&#160;kB on 2022-09-20."><img alt="307&#160;kB on 2022-09-20." src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Blason_ville_fr_Dinard_(Ille-et-Vilaine).svg/109px-Blason_ville_fr_Dinard_(Ille-et-Vilaine).svg.png" decoding="async" width="109" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Blason_ville_fr_Dinard_%28Ille-et-Vilaine%29.svg/164px-Blason_ville_fr_Dinard_%28Ille-et-Vilaine%29.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Blason_ville_fr_Dinard_%28Ille-et-Vilaine%29.svg/218px-Blason_ville_fr_Dinard_%28Ille-et-Vilaine%29.svg.png 2x" data-file-width="512" data-file-height="563" /></a></div></div>
			<div class="gallerytext">
<p>307&#160;kB on 2022-09-20.
</p>
			</div>
		</div></li>
</ul>
<p>It has linear and radial gradients, and many groups are scaled. It should use a <code>pattern</code> or <code>feTile</code>.
</p><p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> Reduced file size to 9&#160;kB. The interesting challenge here is the pattern fill. The shield outline is simple (and its path can be used for clipping). The shield can have a solid green fill that is overlaid with left and right red stripes. The white cross can be a path with a white fill (the path needs to be stroked within the shield, so overlaying two rectangles does not work). The pattern is difficult because it does not have a simple rectangular pitch. After filling the white cross, it is drawn two more times: first with a rectangular pattern of half the figures, and second with a similar pattern offset by half the pitch. The whole shield is then covered by a radial gradient. Finally, the outline of the shield is stroked at 3 pixels.
</p><p>Three are many similar designs at <a href="https://en.wikipedia.org/wiki/List_of_Breton_flags" class="extiw" title="w:List of Breton flags">w:List of Breton flags</a>.
</p><p>This file should have a trivial size:
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Blason_ville_Chauvigné_35.svg" class="image" title="164&#160;kB on 2022-09-22."><img alt="164&#160;kB on 2022-09-22." src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Blason_ville_Chauvigné_35.svg/109px-Blason_ville_Chauvigné_35.svg.png" decoding="async" width="109" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Blason_ville_Chauvign%C3%A9_35.svg/164px-Blason_ville_Chauvign%C3%A9_35.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Blason_ville_Chauvign%C3%A9_35.svg/218px-Blason_ville_Chauvign%C3%A9_35.svg.png 2x" data-file-width="600" data-file-height="660" /></a></div></div>
			<div class="gallerytext">
<p>164&#160;kB on 2022-09-22.
</p>
			</div>
		</div></li>
</ul>
<h3><span class="mw-headline" id="Title_and_description">Title and description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=21" title="Edit section: Title and description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>It is reasonable to include <code>title</code> and <code>desc</code> elements.
</p><p>SVG 2.0 will allow language versions (using the <code>lang</code> or <code>xml:lang</code> attribute &#8212; not the <code>systemLanguage</code> attribute).<sup id="cite_ref-5" class="reference"><a href="#cite_note-5">&#91;5&#93;</a></sup> The acceptance of the language versions is not clear, and it has an at-risk warning in the SVG 2.0 specification.
</p><p>The <code>title</code> and <code>desc</code> elements are not display elements. For that reason, they cannot be selected within a <code>switch</code> element. In that context, the elements would be giving a title and a description to the parent <code>switch</code> element.
</p><p>There should be support for the Dublin Core <code>dc:title</code> and <code>dc:description</code> elements with <code>xml:lang</code> attributes.
</p>
<h3><span class="mw-headline" id="Metadata">Metadata</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=22" title="Edit section: Metadata">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section needs reorganization and clarity about types. It is about machine readable metadata.
</p><p>Machine readable often turns to RDF. RDF is sophisticated, so the use is often a limited subset.
</p><p>There are vocabularies such as Dublin Core. There are also schemas that describe how the vocabulary is used.
</p><p>Then there is how the metadata is actually used.
</p><p>Metadata and copyright are intertwined. Metadata should include information about the origin of an image, and several copyright licenses require that some information be provided.
</p><p>The Creative Commons licenses require some specific information. For example, there should be a link to the CC license. Derivative works need to say what was changed. In many cases, these requirements may not be met.
</p><p>I believe all SVG files should include metadata. It is not hard to add, and it can be useful. Including license data in the image metadata may fulfill licensing requirements or at least provide a colorable defense. Failure to follow all licensing requirements may lead to trouble.<sup id="cite_ref-6" class="reference"><a href="#cite_note-6">&#91;6&#93;</a></sup><sup id="cite_ref-7" class="reference"><a href="#cite_note-7">&#91;7&#93;</a></sup><sup id="cite_ref-8" class="reference"><a href="#cite_note-8">&#91;8&#93;</a></sup>
</p><p><a href="https://en.wikipedia.org/wiki/Moral_rights" class="extiw" title="w:Moral rights">Moral rights</a>. Even if I do not need to credit an author, there may be a moral obligation to give them credit. Sometimes that moral right can become a legal right. Some contributors allow free use of some or all of their work. <a href="https://commons.wikimedia.org/wiki/User:LadyofHats" title="User:LadyofHats">LadyofHats</a> is a notable example. That means I can use the work for any purpose, and I do not need to give anyone credit. That does not seem reasonable or even right. I could take Herman Melville's Moby Dick and publish it under my own name. It seems far better to say it is Melville's work.
</p><p>Providing metadata also makes it easier for someone else to check the licensing rights. Commons encourages everybody (not just its wikipedia projects) to use the available art. Say Alice uses some CC0 SVG images from Commons on her website. The images are CC0, so Alice does not mention any licensing details. Bob sees Alice's website and likes the images, but how can Bob determine the licensing of the images?
</p><p>The license check would be simple if the SVG file included the licensing information. Just given an image, it may be hard to find out who made it. If the image has metadata, then that information may be easy to find. The information may not be accurate (somebody may be license washing), but it is a starting point and could serve as a good defense.
</p><p><a rel="nofollow" class="external free" href="https://www.dublincore.org/specifications/dublin-core/dcq-rdf-xml/">https://www.dublincore.org/specifications/dublin-core/dcq-rdf-xml/</a>
</p>
<h4><span class="mw-headline" id="Other_metadata">Other metadata</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=23" title="Edit section: Other metadata">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Metadata is not about just copyright information. Metadata can include other relevant information.
</p><p>For maps, the metadata may include information about the map projection. With that information, one could take the (<i>x</i>, <i>y</i>) location of a point on the map and convert it to the corresponding latitude and longitude.
</p><p>For chemicals, the metadata may include structured descriptions of the chemical.
</p><p>I'm leery of too much metadata. SVG should be more of an output format rather than a container for detailed information. Providing a small amount of information is reasonable, but including lots of information may be inappropriate. The intended use of SVG is to display an image.
</p>
<h4><span class="mw-headline" id="The_mess_that_is_xml:lang">The mess that is <code>xml:lang</code></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=24" title="Edit section: The mess that is xml:lang">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The issues with <code>lang</code> and <code>xml:lang</code>. Watch out for accidental captures.
</p>
<h4><span class="mw-headline" id="Creative_Commons_license_requirements">Creative Commons license requirements</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=25" title="Edit section: Creative Commons license requirements">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Creative Commons licenses are used extensively on Commons and WMF servers.
</p><p>State the common legal requirements of CC licenses.
</p>
<ol><li>CC- requires a link to the CC license. That means a it is easy to find the license terms. Check if a CC0 license also has this requirement.</li>
<li>CC-BY must provide reasonable attribution. May distribute and alter. May impose more restrictive license.</li>
<li>CC-SA (implies a derivative work) must not use a more restrictive license and must describe the changes.</li>
<li>CC-ND allows use but not modification.</li>
<li>CC-NC does not allow commercial use. (What is the constraint on commercial? May a nonprofit use the work in its fundraising? May the Girl Scouts use it to sell their cookies? In the US, agency settles some of these questions.)</li></ol>
<p>State the failings.
</p><p>The file description pages are often inadequate. Sometimes there are gross errors such as an improper license. Derivative works often omit the attribution information in the license. The description of a derivative work often fails to describe the changes made to the original work.
</p><p>Most file uses on WMF servers satisfy the requirements because MW links the file to its description page:
</p>
<dl><dd><code>[[File:Yellow banana.svg|A picture of a yellow banana.]]</code></dd></dl>
<p>Presumably, the file description page has a link to the CC license and meets the attribution and modification requirements.
</p><p>However, the file use may alter that link (<a href="https://www.mediawiki.org/wiki/Help:Images" class="extiw" title="mw:Help:Images">MW:Help:Images</a>).
</p>
<dl><dd><code>[[File:Yellow banana.svg|link=https://www.nowhere.com/bitbucket|A picture of a yellow banana.]]</code></dd></dl>
<p>or
</p>
<dl><dd><code>[[File:Yellow banana.svg|link=|A picture of a yellow banana.]]</code></dd></dl>
<p>If the override link does not provide the needed licensing information, then the license is violated. There can be disastrous ramifications. MW should not allow such links for CC-licensed material.
</p>
<h4><span class="mw-headline" id="Dublin_Core_and_Creative_Commons">Dublin Core and Creative Commons</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=26" title="Edit section: Dublin Core and Creative Commons">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Reasonable SVG metadata should use both Dublin Core and Creative Commons vocabularies. The metadata can be expressed using RDF.
</p>
<h4><span class="mw-headline" id="Dublin_Core">Dublin Core</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=27" title="Edit section: Dublin Core">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>A general reference:
</p>
<ul><li><a rel="nofollow" class="external free" href="https://guides.library.ucsc.edu/c.php?g=618773&amp;p=4306386">https://guides.library.ucsc.edu/c.php?g=618773&amp;p=4306386</a></li></ul>
<p>It suggests some vocabularies. Looking for "Terman, Frederick" gives the MARC value
</p>
<ul><li><a rel="nofollow" class="external free" href="https://authorities.loc.gov/cgi-bin/Pwebrecon.cgi?AuthRecID=6104582&amp;v1=1&amp;HC=1&amp;SEQ=20220810164445&amp;PID=REbDGJ6P_nYjOw83gOGJlAHS490">https://authorities.loc.gov/cgi-bin/Pwebrecon.cgi?AuthRecID=6104582&amp;v1=1&amp;HC=1&amp;SEQ=20220810164445&amp;PID=REbDGJ6P_nYjOw83gOGJlAHS490</a></li>
<li>permalink: <a rel="nofollow" class="external free" href="https://lccn.loc.gov/n2003015013">https://lccn.loc.gov/n2003015013</a></li></ul>
<p>Dublin Core provides a vocabulary for references. There are two Dublin Core namespaces:
</p>
<ul><li><code>dc: <a rel="nofollow" class="external free" href="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</a></code> Original 15 element namespace defined in 2000.</li>
<li><code>dcterms: <a rel="nofollow" class="external free" href="http://purl.org/dc/terms/">http://purl.org/dc/terms/</a></code> Extended namespace defined in 2001. Everything in elements was mirrored in 2008.</li></ul>
<p>Sometimes, the <code>dcterms</code> namespace uses the <code>dc</code> prefix. The goal is to use the <code>dcterms</code> vocabulary rather than the 15-element <code>dc</code> namespace. It is possible to translate <code>dc</code> to <code>dcterms</code> (e.g., using XSLT), but that translation may confuse existing software.
</p><p>Dublin Core <code>elements/1.1/</code> is a short (15 term), general, vocabulary for works:
</p>
<ul><li><code>dc:title</code> (there is also an SVG <code>title</code> element)</li>
<li><code>dc:date</code></li>
<li><code>dc:creator</code></li>
<li><code>dc:contributor</code> (I would use for translators)</li>
<li><code>dc:source</code></li>
<li><code>dc:format</code> (less important) for SVG, use <code>image/svg+xml</code></li>
<li><code>dc:type</code> (less important) often <code>rdf:resource="<a rel="nofollow" class="external free" href="http://purl.org/dc/dcmitype/StillImage">http://purl.org/dc/dcmitype/StillImage</a>"</code></li>
<li><code>dc:publisher</code> (If empty, I would have this point to Wikimedia Commons)</li>
<li><code>dc:subject</code> DC states, "Typically, the subject will be represented using keywords, key phrases, or classification codes. Recommended best practice is to use a controlled vocabulary." I do not see a widely adopted practice here. Most people would probably use a text string of comma-separated keyword phrases. That would match the HTML <code>meta</code> tag: e.g., <code>&lt;meta name="keywords" content="HTML, CSS, Javascript" &gt;</code>. However, the obvious RDF approach would use an <code>rdf:Bag</code> that holds each keyword phrase: <code>&lt;cc:license&gt;&lt;rdf:Bag&gt;&lt;rdf:li&gt;HTML&lt;/rdf:li&gt;&lt;rdf:li&gt;CSS&lt;/rdf:li&gt;&lt;rdf:li&gt;Javascript&lt;/rdf:li&gt;&lt;/rdf:Bag&gt;&lt;/cc:license&gt;</code>. <u>The <code>dcterms:</code> mirror is not a list of keywords.</u></li>
<li><code>dc:coverage</code> Time or location. Not widely used? E.g., Port Royal earthquake.</li>
<li><code>dc:description</code></li>
<li><code>dc:identifier</code></li>
<li><code>dc:language</code></li>
<li><code>dc:relation</code></li>
<li><code>dc:rights</code> The clearer practice here would be to use <code>cc:license</code></li></ul>
<p>The Dublin Core vocabulary uses general rather than specific terms. For example, the <code>dc:creator</code> predicate covers several possibilities such as author, composer, lyricist, illustrator, and photographer. There are vocabularies that make finer distinctions,<sup id="cite_ref-9" class="reference"><a href="#cite_note-9">&#91;9&#93;</a></sup> but those distinctions may not be necessary for many works, and most applications probably do not support the terms.
</p><p>Usage examples:
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.dublincore.org/specifications/dublin-core/usageguide/2001-04-12/generic/">https://www.dublincore.org/specifications/dublin-core/usageguide/2001-04-12/generic/</a></li>
<li><a rel="nofollow" class="external free" href="https://www.dublincore.org/specifications/dublin-core/usageguide/2003-08-26/elements/">https://www.dublincore.org/specifications/dublin-core/usageguide/2003-08-26/elements/</a>
<dl><dd>list creators separately...</dd></dl></li></ul>
<p>Interesting metadata in
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:DCMI-logo.svg" title="File:DCMI-logo.svg">File:DCMI-logo.svg</a></li></ul>
<p>Specifies data types.
</p><p>Here is the metadata secion:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;metadata&gt;</span>
<span class="nt">&lt;rdf:RDF</span>
  <span class="na">xmlns:rdf=</span><span class="s">&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
  <span class="na">xmlns:dc=</span><span class="s">&quot;http://purl.org/dc/elements/1.1/&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;rdf:Description</span> <span class="na">rdf:about=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;dc:title</span> <span class="na">xml:lang=</span><span class="s">&quot;ja&quot;</span><span class="nt">&gt;</span>DCMIのロゴ<span class="nt">&lt;/dc:title&gt;</span>
		<span class="nt">&lt;dc:creator</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://meta.wikimedia.org/?curid=10484470&quot;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;dc:subject</span> <span class="na">rdf:datatype=</span><span class="s">&quot;http://ndl.go.jp/dcndl/terms/NIISubject&quot;</span><span class="nt">&gt;</span>情報学<span class="nt">&lt;/dc:subject&gt;</span>
		<span class="nt">&lt;dc:description</span> <span class="na">xml:lang=</span><span class="s">&quot;ja&quot;</span> <span class="na">rdf:parseType=</span><span class="s">&quot;Resource&quot;</span><span class="nt">&gt;</span>
			<span class="nt">&lt;dc:format</span> <span class="na">rdf:datatype=</span><span class="s">&quot;http://purl.org/dc/terms/IMT&quot;</span><span class="nt">&gt;</span>text/x-wiki<span class="nt">&lt;/dc:format&gt;</span>
			<span class="nt">&lt;rdf:value&gt;</span><span class="cp">&lt;![CDATA[</span>
<span class="cp">[https://www.dublincore.org/ &#39;&#39;&#39;ダブリンコアメタデータイニシアチブ&#39;&#39;&#39;]（{{en|1=Dublin Core Metadata Initiative; DCMI|inline=inline}}）のロゴ画像。</span>
<span class="cp">{{quote|lang=ja|text=</span>
<span class="cp">中央の円はイニシアチブの中核を，それを取り囲む内側の円達は[[w:ja:Dublin_Core#基本記述要素一覧|DCMIメタデータ要素集合]]（[https://webdesk.jsa.or.jp/books/W11M0090/index/?bunsyo_id=JIS+X+0836:2005 JIS X 0836:2005]）で利用できる15の基本記述要素を，外側の円達は要素集合の解釈及び拡張を，それぞれ表す。</span>
<span class="cp">|cite=ダブリンコアメタデータイニシアチブ</span>
<span class="cp">|source=[https://www.dublincore.org/about/#web-site-policies-software-logo-banner About DCMI/Web site, policies, software, logo, banner]の[[User:cmplstofB]]による試訳</span>
<span class="cp">}}</span>
<span class="cp">]]&gt;</span><span class="c">&lt;!--  --&gt;</span><span class="nt">&lt;/rdf:value&gt;</span>
		<span class="nt">&lt;/dc:description&gt;</span>
		<span class="nt">&lt;dc:contributor</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://www.dublincore.org/&quot;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;dc:date</span> <span class="na">rdf:datatype=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchemadate&quot;</span><span class="nt">&gt;</span>2019-09-11<span class="nt">&lt;/dc:date&gt;</span>
		<span class="nt">&lt;dc:type</span> <span class="na">rdf:datatype=</span><span class="s">&quot;http://purl.org/dc/terms/DCMIType&quot;</span><span class="nt">&gt;</span>StillImage<span class="nt">&lt;/dc:type&gt;</span>
		<span class="nt">&lt;dc:format</span> <span class="na">rdf:datatype=</span><span class="s">&quot;http://purl.org/dc/terms/IMT&quot;</span><span class="nt">&gt;</span>image/svg+xml<span class="nt">&lt;/dc:format&gt;</span>
		<span class="nt">&lt;dc:source</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://www.dublincore.org/images/DCMI_logo_cropped.jpg&quot;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;dc:language</span> <span class="na">rdf:datatype=</span><span class="s">&quot;http://purl.org/dc/terms/ISO639-2&quot;</span><span class="nt">&gt;</span>jpn<span class="nt">&lt;/dc:language&gt;</span>
		<span class="nt">&lt;dc:rights</span> <span class="na">rdf:resource=</span><span class="s">&quot;http://www.wtfpl.net/about/&quot;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/rdf:Description&gt;</span>
<span class="nt">&lt;/rdf:RDF&gt;</span>
<span class="nt">&lt;/metadata&gt;</span>
</pre></div>
<p>Many of the Dublin Core fields are text. They will use <code>rdf:datatype</code> attributes. Some of those use the <code>dcterms</code> vocabulary, but sometimes they use some another set of types. Consider <code>dc:date</code>: it uses <code><a rel="nofollow" class="external free" href="http://www.w3.org/2001/XMLSchemadate">http://www.w3.org/2001/XMLSchemadate</a></code>. Some other fields use <code>rdf:resource</code> rather than text. Is there a rewrite rule for <code>rdf:resource</code>? A URI string with a URI datatype?
</p><p>Dublin Core schemas:
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.dublincore.org/schemas/xmls/">https://www.dublincore.org/schemas/xmls/</a></li></ul>
<p>Looking at a schema for <code>elements</code>
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.dublincore.org/schemas/xmls/simpledc20021212.xsd">https://www.dublincore.org/schemas/xmls/simpledc20021212.xsd</a></li></ul>
<p>Looks like an arbitrary sequence of the 15 elements. Looks like the element content is text only (<code>xml:lang</code> attributes are allowed).
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span>  <span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">&quot;elementType&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xs:simpleContent&gt;</span>
      <span class="nt">&lt;xs:extension</span> <span class="na">base=</span><span class="s">&quot;xs:string&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">ref=</span><span class="s">&quot;xml:lang&quot;</span> <span class="na">use=</span><span class="s">&quot;optional&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/xs:extension&gt;</span>
    <span class="nt">&lt;/xs:simpleContent&gt;</span>
  <span class="nt">&lt;/xs:complexType&gt;</span>
</pre></div>
<p>Significantly, this declaration does not show using <code>rdf:resource</code> attribute.
</p><p>I expected the <code>dcterms</code> schema to be more restrictive.
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.dublincore.org/schemas/xmls/qdc/2008/02/11/dcterms.xsd">https://www.dublincore.org/schemas/xmls/qdc/2008/02/11/dcterms.xsd</a></li></ul>
<p>However, the schema states
</p>
<blockquote>
<p>Encoding schemes are defined as complexTypes which are restrictions of the dc:SimpleLiteral complexType. These complexTypes restrict values to an appropriates syntax or format using data typing, regular expressions, or enumerated lists. In order to specify one of these encodings an xsi:type attribute must be used in the instance document. Also, note that one shortcoming of this approach is that any type can be applied to any of the elements or refinements. There is no convenient way to restrict types to specific elements using this approach.
</p>
</blockquote>
<p>Here's a <code>dcterms</code> to <code>dc</code> and what looks like a <i>W3C Date-Time Format</i>.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">&quot;date&quot;</span> <span class="na">substitutionGroup=</span><span class="s">&quot;dc:date&quot;</span><span class="nt">/&gt;</span>

<span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">&quot;W3CDTF&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xs:simpleContent&gt;</span>
    <span class="nt">&lt;xs:restriction</span> <span class="na">base=</span><span class="s">&quot;dc:SimpleLiteral&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;xs:simpleType&gt;</span>
        <span class="nt">&lt;xs:union</span> <span class="na">memberTypes=</span><span class="s">&quot;xs:gYear xs:gYearMonth xs:date xs:dateTime&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/xs:simpleType&gt;</span>
      <span class="nt">&lt;xs:attribute</span> <span class="na">ref=</span><span class="s">&quot;xml:lang&quot;</span> <span class="na">use=</span><span class="s">&quot;prohibited&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:restriction&gt;</span>
  <span class="nt">&lt;/xs:simpleContent&gt;</span>
<span class="nt">&lt;/xs:complexType&gt;</span>
</pre></div>
<p>The details are both troubling and confusing. Dublin Core looks like simple text (<code>simpleType</code>). What impact does that have? For multiple authors, one either uses several <code>creator</code> elements or puts the list in simple text. The <code>dcterms</code> set does not provide access to <code>rdf:Seq</code>.
</p><p>Does common usage of Dublin Core violate the schema?
</p><p>The schemas, without more, do not do a sensible validation of, for example, date syntax.
</p><p>A reification from <code>dcterms</code> to <code>elements</code> is clear.
</p>
<h4><span class="mw-headline" id="Creative_Commons">Creative Commons</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=28" title="Edit section: Creative Commons">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Creative Commons adds some terms for specifying the license and attribution:
</p>
<ul><li><code>cc:license</code> (said to be the same as <code>xhtml:license</code>; Commons does not allow uploading SVG that uses the <code>xhtml</code> namespace)</li>
<li><code>cc:attributionURL</code> (may be needed for CC-BY; I would have this point to the File: page on Commons)</li>
<li><code>cc:attributionName</code> (may be needed for CC-BY)</li></ul>
<p>For Commons files, making the <code>cc:attributionURL</code> point to the file page on Commons may satisfy the attribution requirements of CC-BY licenses.
</p><p>Resource Description Framework (RDF) statements have a subject, a predicate, and an object.
</p><p>Although vocabularies are specified, how those vocabularies should be used is not nailed down. If there are two creators, how should that be specified? Should there be an RDF <code>dc:creator</code> statement for each creator? Should there be one <code>dc:creator</code> statement whose object is a set of the creators? The situation for licenses is more obvious. If the user gets to choose which of several licenses, then there should be one <code>cc:license</code>, and the object should be an <code>rdf:Alt</code>  that identifies the alternative licenses. However, most software probably expects exactly one license rather than a list of alternatives. The simple approach is to offer only one license.
</p><p>The lack of consistency implies problems. If a graphics program does not understand the input RDF, then it may get corrupted on output. The appropriate goal is to have metadata that most graphics editors understand. That way, the metadata is preserved during import and export.
</p><p>Consistency and accuracy are also missing in many Commons licenses.
</p><p>Say Alice creates a CC-BY-SA image and uploads it to Commons. Bob then reuses Alice's image. Bob is required to use a CC-BY-SA license, and Bob's image must carry attribution to Alice. Many mistakes happen on Commons. Bob's image may not mention Alice's licensed image. Bob may claim his work is CC0 (license washing). Bob may use CC-BY-SA, but he may not point out that Alice must be acknowledged, too. Given license information on Commons may be missing or incomplete, it is no surprise that license metadata may be haphazard, too.
</p><p>A CC-BY-SA license permits modification (i.e., derivative works). The licenses require the modifier to describe the changes, but Creative Commons does not have a vocabulary term for describing the modifications.
</p>
<h4><span class="mw-headline" id="Creative_Commons_and_closure">Creative Commons and closure</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=29" title="Edit section: Creative Commons and closure">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Creative Commons does a good job for the original work. The license is declared, and there are constructs for attribution. If a work is used without modification, then the metadata has the information for proper attribution.
</p><p>The metadata is insufficient when the original work is modified. The license requires that the changes be identified, but there are no XML elements for describing the changes.
</p><p>List the licenses and the issues.
</p>
<ul><li>0</li>
<li>-BY</li>
<li>-SA</li>
<li>-ND</li>
<li>-NC</li></ul>
<p>Another issue is how graphics editors can merge metadata.
</p>
<h4><span class="mw-headline" id="Adobe_Systems_XMP">Adobe Systems XMP</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=30" title="Edit section: Adobe Systems XMP">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Adobe XMP uses the <code>elements</code> namespace:
</p>
<ul><li>"The [Dublin Core] namespace URI shall be <code><a rel="nofollow" class="external free" href="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</a></code>."</li></ul>
<p>Sigh.
</p><p>Adobe Systems includes metadata, and it has settled on a specific syntax with its eXtensible Metadata Platform (XMP). Adobe solves the multiple creator problem by always using a set of creators (even if there is only one creator). Adobe also restricts the use of complex RDF syntax.
</p><p>In XMP, the <code>dc:creator</code> should be an ordered list of <code>ProperName</code>.<sup id="cite_ref-10" class="reference"><a href="#cite_note-10">&#91;10&#93;</a></sup> A <code>ProperName</code> is a simple text value.
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;rdf:Description</span> <span class="na">rdf:about=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dc:creator&gt;</span>
    <span class="nt">&lt;rdf:Seq&gt;</span>
      <span class="nt">&lt;rdf:li&gt;</span>John Smith<span class="nt">&lt;/rdf:li&gt;</span>
      <span class="nt">&lt;rdf:li&gt;</span>Richard Roe<span class="nt">&lt;/rdf:li&gt;</span>
    <span class="nt">&lt;/rdf:Seq&gt;</span>
  <span class="nt">&lt;/dc:creator&gt;</span>
<span class="nt">&lt;/rdf:Description&gt;</span>
</pre></div></dd></dl>
<p>Should discuss the equivalent form.
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;cc:Work</span> <span class="na">rdf:about=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dc:creator&gt;</span>Alice<span class="nt">&lt;/dc:creator&gt;</span>
<span class="nt">&lt;/cc:Work&gt;</span>
</pre></div></dd></dl>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;rdf:Description</span> <span class="na">rdf:about=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;rdf:type</span> <span class="na">rdf:resource=</span><span class="s">&quot;http://creativecommons.org/ns#Work&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;dc:creator&gt;</span>Alice<span class="nt">&lt;/dc:creator&gt;</span>
<span class="nt">&lt;/rdf:Description&gt;</span>
</pre></div></dd></dl>
<h4><span class="mw-headline" id="Inkscape_metadata">Inkscape metadata</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=31" title="Edit section: Inkscape metadata">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Which namespace does Inkscape use? <code>elements</code> or <code>dcterms</code>? If it uses <code>elements</code>, then it should upgrade. Or at least accept one or the other. I'm looking at a file I believe to be Inkscape, and it has <code>xmlns:dc="<a rel="nofollow" class="external free" href="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</a>"</code>.
</p><p>Inkscape has a metadata form to fill in, but Inkscape uses an agent description. (Pull a copy of Inkscape metadata).
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;dc:creator&gt;</span>
  <span class="nt">&lt;cc:Agent&gt;</span>
    <span class="nt">&lt;dc:title&gt;</span>Andy Fitzsimon<span class="nt">&lt;/dc:title&gt;</span>
  <span class="nt">&lt;/cc:Agent&gt;</span>
<span class="nt">&lt;/dc:creator&gt;</span>
</pre></div></dd></dl>
<p>Please note that <code>cc:Agent</code> is not part of the <code><a rel="nofollow" class="external free" href="https://creativecommons.org/ns">http://creativecommons.org/ns</a></code> namespace.
</p><p>Dublin Core has a <code>dc:Agent</code>, so it is possible that Inkscape meant <code>dc:Agent</code> rather than <code>cc:Agent</code>.
</p><p>I'm not a happy camper...
</p>
<ul><li><a rel="nofollow" class="external free" href="https://gitlab.com/inkscape/inkscape/-/blob/master/src/rdf.cpp">https://gitlab.com/inkscape/inkscape/-/blob/master/src/rdf.cpp</a></li></ul>
<p>The page does not include the <code>attributionName</code> or <code>attributionURL</code> elements. It has a set of licenses. It also points to some SIL licenses.
</p><p>There is a significant but unresolved issue here.<sup id="cite_ref-11" class="reference"><a href="#cite_note-11">&#91;11&#93;</a></sup> An original goal is to identify the license and the creator. Not a lot of information is needed to acknowledge those rights; a simple text reference to a name might be good enough. However, more details can be given about the rights holder, so should the representation give more details? At what point would there be too much information. More information could be added, but very few systems will be able to process that information. The simple approach is to keep the information simple enough to satisfy license requirements and avoid adding extraneous details.
</p><p>A URL is a better method of identifying a person than some text. Many people have the name John Smith, but the URL <a rel="nofollow" class="external free" href="https://www.imdb.com/name/nm0808774/">https://www.imdb.com/name/nm0808774/</a> identifies a particular John Smith. Unfortunately, many applications probably expect a text string and cannot handle a URL. If an application expects this input
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;dc:creator&gt;</span>John Smith<span class="nt">&lt;/dc:creator&gt;</span>
</pre></div></dd></dl>
<p>then how will it handle this input (i.e., a URL that identifies a particular John Smith)?
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;dc:creator</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://www.imdb.com/name/nm0808774/&quot;</span> <span class="nt">/&gt;</span>
</pre></div></dd></dl>
<p>Try this out in Inkscape....
Try this out in Adobe Illustrator....
</p>
<h4><span class="mw-headline" id="Well-known_licenses">Well-known licenses</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=32" title="Edit section: Well-known licenses">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Creative Commons wants a <code>cc:License</code> element that summarizes the license, but I do not like that practice for well-known licenses. What happens if the summary is inaccurate? Say the license URL is CC-BY-SA 4.0 but the license summary prohibits commercial use? Does the summary take precedence over the URL?
</p><p>In theory, it should be easy to obtain the RDF description of a well-known license. For example, the license HTML at
</p>
<ul><li><a rel="nofollow" class="external free" href="https://creativecommons.org/licenses/by-sa/4.0/">https://creativecommons.org/licenses/by-sa/4.0/</a></li></ul>
<p>has a link in the HTML
</p>
<ul><li><div class="mw-highlight mw-highlight-lang-html mw-content-ltr" dir="ltr"><pre><span></span><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;alternate&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;application/rdf+xml&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;rdf&quot;</span> <span class="p">/&gt;</span>
</pre></div></li></ul>
<p>which refers to the license RDF at
</p>
<ul><li><a rel="nofollow" class="external free" href="https://creativecommons.org/licenses/by-sa/4.0/rdf">https://creativecommons.org/licenses/by-sa/4.0/rdf</a></li></ul>
<p>Consequently, an RDF description of a well-known license is available.
</p><p>It is possible to check whether the license summary is consistent with the published URL.
</p><p>Creators also misuse CC-BY licenses on Commons by stating additional license terms. For example, the creator may state that the attribution must appear next to where the image is used. Creative Commons CC-BY licenses require attribution, but the license lets the licensee use any reasonable method of attribution. Here's the text about attribution from <a rel="nofollow" class="external text" href="https://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA 4.0</a>:
</p>
<dl><dd><b>Attribution</b> — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use.</dd></dl>
<p>If a creator states the license is CC-BY-SA 4.0, then the creator should not be able to state additional requirements. Additional requirements contradict the terms of CC-BY-SA 4.0.
</p>
<h4><span class="mw-headline" id="Metadata_checker">Metadata checker</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=33" title="Edit section: Metadata checker">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>A few years ago, I did some tests on RDF XML validation.
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.w3.org/RDF/Validator/">https://www.w3.org/RDF/Validator/</a>
<dl><dd><a rel="nofollow" class="external text" href="https://www.w3.org/RDF/Validator/rdfval?URI=https%3A%2F%2Fupload.wikimedia.org%2Fwikipedia%2Fcommons%2Farchive%2F1%2F1d%2F20151118210615%2521First_Ionization_Energy.svg&amp;PARSE=Parse+URI%3A+&amp;TRIPLES_AND_GRAPH=PRINT_TRIPLES&amp;FORMAT=PNG_EMBED">RDF validate old version of </a><a href="https://commons.wikimedia.org/wiki/File:First_Ionization_Energy.svg" title="File:First Ionization Energy.svg">File:First Ionization Energy.svg</a>.</dd></dl></li></ul>
<p>A sophisticated metadata checker could...
</p>
<ul><li>look for appropriate namespaces</li>
<li>check value consistency (ISO dates, finite set ranges)</li>
<li>calculate a list of ranges</li>
<li>validate XML schemas (valid RDF, valid CC, ...)</li>
<li>learn frequency of metadata (lots of image/xml+svg but little cc:creator)</li>
<li>possibility of rewriting metadata</li>
<li>possibility of adding metadata</li></ul>
<p>My notes on RDF. GRIDDL.
</p>
<h5><span class="mw-headline" id="Related_topics">Related topics</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=34" title="Edit section: Related topics">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>A more general topic, SVG validation, is <a href="https://commons.wikimedia.org/wiki/Help:SVG" title="Help:SVG">Help:SVG</a>. There were more involved discussions about SVG validation. Validation is often too strict (complaining about extensions such as Inkscape or new SVG features).
</p><p><a href="https://commons.wikimedia.org/wiki/Commons:Overwriting_existing_files" title="Commons:Overwriting existing files">Commons:Overwriting existing files</a>.
</p>
<h4><span class="mw-headline" id="Removing_metadata">Removing metadata</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=35" title="Edit section: Removing metadata">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>To me, removing metadata from an SVG file (or any other file) may be inappropriate. The bottom line is removing metadata may trigger legal issues but leaving it in has minimal cost.
</p><p>Consider a signed painting. Should someone come along and paint over the signature?
</p><p>Removing metadata is similar to removing a watermark. See <a href="https://commons.wikimedia.org/wiki/Commons:Watermarks#Legal_issues_with_the_removal_of_watermarks" title="Commons:Watermarks">Legal issues with the removal of watermarks</a> and <a href="https://meta.wikimedia.org/wiki/Wikilegal/Removal_of_watermarks_from_Commons_images" class="extiw" title="meta:Wikilegal/Removal of watermarks from Commons images">Removal of watermarks from Commons images</a>. WMF legal staff opines that removing a watermark could violate the <a href="https://en.wikipedia.org/wiki/Digital_Millenium_Copyright_Act" class="extiw" title="w:Digital Millenium Copyright Act">DMCA</a> and even violate the terms of some Creative Commons licenses.
</p><p>Compare to removing a watermark that was not part of the original image. Sometimes a person who hosts an image may add a watermark.
</p><p>Sometimes metadata is inadvertently removed. When <code>librsvg</code> produces a PNG, I doubt that it copies metadata from the SVG to the PNG.
</p>
<h4><span class="mw-headline" id="Other_uses_of_metadata">Other uses of metadata</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=36" title="Edit section: Other uses of metadata">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Images on Commons should have free licenses, but many uploads violate the creator's license. Generally, Commons relies on its users to upload only free material.
</p><p>Some of that checking can be done automatically. Consider an image that is published on some website, and the website states a non-free license for that image. Alice likes the image, so she uploads it to Commons claiming it is her own work. Commons does not know.
</p><p>Now consider that the image has metadata that says the creator is Bob and the license is CC-BY-NC. Commons could read the metadata, realize it does not know that Alice is Bob, and recognize the CC-BY-NC license is not compatible with Commons. Thus Commons could refuse the upload automatically.
</p><p>At upload, Commons could also notice that a work is CC-BY-SA with required attribution. Commons could fill in the attribution details.
</p><p>Graphics applications might also warn users about editing files that carry CC-BY-ND licenses.
</p>
<h3><span class="mw-headline" id="Detect_symbol_candidates">Detect symbol candidates</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=37" title="Edit section: Detect symbol candidates">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Artists often copy-paste an image component rather than creating and using a symbol.
</p><p>Also works for text-to-curve images.
</p>
<h3><span class="mw-headline" id="Use_styles">Use styles</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=38" title="Edit section: Use styles">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There is a difference between content and style. The content is the information, and the style is how it is displayed. Content that is in a particular class may be displayed the same way by using CSS to select and style SVG elements in that class.
</p><p>In general, it is better to use CSS to achieve a consistent display rather than individually formatting graphics elements.
</p><p>Consider a map. We may want the rivers and the names of rivers displayed in blue. A <code>river</code> class can set the color for both the rivers and the font fill. Cities with a population under 100,000 may use a small dot and a small font, and cities over that size may use a larger dot and a larger font. CSS can set the font size and even the radius of a circle. Capital cities may use a star instead of a dot.
</p><p>Using CSS and the <code>class</code> attribute can make the display both consistent and easy to change. Fill colors and font families are set in just the CSS rather than on each SVG element. Changing the CSS will apply the change to all elements in the class.
</p><p>Graphics editors should have a way to manage styles, but they may not round-trip them.
</p>
<h2><span class="mw-headline" id="SVG_text">SVG text</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=39" title="Edit section: SVG text">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In general, the text within an SVG file should be in SVG <code>text</code> elements. Avoid converting text to paths/curves. Such path text expands the size of the file, and it is often unnecessary. Artistic text (such as used in logos) may need to be converted to curves.
</p><p>In general, if an SVG file contains text, then users should be able to copy and paste that text from the SVG file. A simple test is to load the SVG file into a browser and then try to select all the text (<kbd>control-A</kbd> in Windows). If no text is selected, then the diagram's text has been converted to curves.
</p><p>The text that is selected should be readable, grouped appropriately, and spaced correctly. Independent phrases should be in their own <code>text</code> element; they should not be combined with other phrases. Independent phrases that need two lines should not use two <code>text</code> elements but rather code the lines in <code>tspan</code> elements. That keeps the phrase together.
</p><p>In addition, the selected text should not be missing spaces or have extra spaces. If the text is displayed on two lines, then it should have a space between those two lines. For example, the better result is "Holy Roman Empire" rather than "Holy RomanEmpire". Unfortunately, SVG does not handle spaces well. Spaces at the beginning or end of a line may not align as expected (the SVG hanging space problem of <code>text-anchor</code>).
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;text&gt;&lt;tspan&gt;</span>Holy Roman<span class="nt">&lt;/tspan&gt;&lt;tspan</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">dy=</span><span class="s">&quot;20&quot;</span><span class="nt">&gt;</span>Empire<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
<span class="nt">&lt;text&gt;&lt;tspan&gt;</span>Holy Roman <span class="nt">&lt;/tspan&gt;&lt;tspan</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">dy=</span><span class="s">&quot;20&quot;</span><span class="nt">&gt;</span>Empire<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
</pre></div></dd></dl>
<p>Sometimes, text is spaced for emphasis. For example, a map of the United States may have text that looks like <span style="letter-spacing:.3em">United States</span>. That text should copy and paste without the additional spaces. Instead of inserting actual spaces to achieve the effect, the graphic artist should set the <code>letter-spacing</code> of the string. Furthermore, do not space text by individually placing the characters. That makes the text difficult to translate, and it may render poorly when fonts are substituted. Use the mechanisms that SVG provides.
</p><p>Similarly, a string that displays as all capital letters should use <code>text-transform: uppercase</code>. For example, <span style="text-transform:uppercase;">United States</span> uses a text transform and will copy-paste as "United States". There are other text transforms, but they are less useful.
</p><p>The perils of hidden text. It can confuse editors. Any hidden elements can cause confusion.
</p>
<h3><span class="mw-headline" id="Fonts">Fonts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=40" title="Edit section: Fonts">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Point to section about fonts and what scaling them means.
</p><p>A good example of the benefits of nonlinear scaling of fonts is a bar code font. The font symbols are scaled to integer pixel widths. The symbols use Manhattan geometry, so the edges are sharp; no anti-aliasing is needed. The strict symbol geometries are maintained.
</p><p>Recommend the CSS generic fonts <code>serif</code> and <code>sans-serif</code>. If possible, do not use exotic fonts.
</p><p>WMF also has problems because <code>librsvg</code>. There are times that we want a text string to be an exact length. SVG supports that with the <code>textLength</code> attribute, but <code>librsvg</code> does not support it.
</p><p>In practice, there is not much support for particular font properties.
</p>
<dl><dd><dl><dt>font-family</dt>
<dd>depends on system. Use CSS fallback.</dd>
<dt>font-size</dt>
<dd>excellent</dd>
<dt>font-style</dt>
<dd>normal, italic. Good support. Oblique....</dd>
<dt>font-weight</dt>
<dd>normal, bold. Other options have little support.</dd>
<dt>font-stretch</dt>
<dd>normal. Other options have little support.</dd>
<dt>font-variant</dt>
<dd>all purpose OTF support depends on font.</dd>
<dt>font-size-adjust</dt>
<dd>mumble.</dd></dl></dd></dl>
<h3><span class="mw-headline" id="Character_encoding">Character encoding</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=41" title="Edit section: Character encoding">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:Symbol_Test.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f3/Symbol_Test.svg/220px-Symbol_Test.svg.png" decoding="async" width="220" height="92" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f3/Symbol_Test.svg/330px-Symbol_Test.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/f3/Symbol_Test.svg/440px-Symbol_Test.svg.png 2x" data-file-width="240" data-file-height="100" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:Symbol_Test.svg" class="internal" title="Enlarge"></a></div>Unicode and Symbol encodings. The two lines should be similar if a Symbol encoding font is available.</div></div></div>
<p>Unicode is common now, so most SVG files will use Unicode or a Unicode-compatible subset. In practice, that means UTF-8, but UTF-16 is also a possibility. UTF-16 wants a byte-order mark (BOM), and some UTF-8 files will also include a BOM. Software should handle those cases.
</p><p>Even though a file may claim to be Unicode, that does not mean the file uses Unicode. There are many special fonts that put exotic glyphs in non-Unicode character positions. The Adobe Symbol font, for example, uses its own character encoding.<sup id="cite_ref-12" class="reference"><a href="#cite_note-12">&#91;12&#93;</a></sup> Zapf Dingbats<sup id="cite_ref-13" class="reference"><a href="#cite_note-13">&#91;13&#93;</a></sup> and Adobe Sonata<sup id="cite_ref-14" class="reference"><a href="#cite_note-14">&#91;14&#93;</a></sup> also use their own encodings.
</p>
<dl><dd><dl><dt>Symbol</dt>
<dd>ABCDEabcde &#8594; <span style="font-family: Symbol">ABCDEabcde</span></dd>
<dt>Zapf Dingbats, Wingdings</dt>
<dd>ABCDEabcde &#8594; <span style="font-family: Zapf Dingbats, Wingdings">ABCDEabcde</span></dd>
<dt>Sonata</dt>
<dd>ABCDEabcde &#8594; <span style="font-family: Sonata">ABCDEabcde</span></dd></dl></dd></dl>
<p>Even common fonts may have non-Unicode character assignments.<sup id="cite_ref-15" class="reference"><a href="#cite_note-15">&#91;15&#93;</a></sup> For example, many Adobe fonts use the Adobe Standard Encoding<sup id="cite_ref-16" class="reference"><a href="#cite_note-16">&#91;16&#93;</a></sup> which puts a dagger at 0xD1 (&#xd1; instead of U+2020: &#x2020;) and the "fi" ligature at 0xAE (&#xae; instead of U+FB01: &#xfb01;).
</p><p>Files that claim to be Unicode but use non-Unicode fonts should be recoded with Unicode fonts. Font substitution may not work when fonts use non-Unicode character encodings.
</p><p>See <a href="https://phabricator.wikimedia.org/T272133" class="extiw" title="phab:T272133">Phab:T272133</a> <cite>Make all Postscript core 35 fonts available to SVG by installing some packages</cite>.
</p><p>Adobe Font list. <a rel="nofollow" class="external free" href="https://adobe-type-tools.github.io/font-tech-notes/pdfs/5090.FontNameList.pdf">https://adobe-type-tools.github.io/font-tech-notes/pdfs/5090.FontNameList.pdf</a>
</p><p>Courier, Helvetica, Times, Symbol, Avant Garde Gothic, Bookman, New Century Schoolbook, Palatino, Zaph Chancery, Zaph Dingbats.
</p><p>Files that use less common character encodings (such as Shift-JIS) do not need to be recoded if they use Unicode fonts. XML files that use such encodings can convert the text to Unicode.
</p><p>Detecting non-Unicode files would be involved. The first step is converting to Unicode. The XML <code>charset</code> attribute should be authoritative, and it offers a clear route to convert an XML file to Unicode. The XML DOM should automatically convert a known <code>charset</code> to a <code>DOMString</code>, which is essentially Unicode. (XML DOM now hides the character encoding.)
</p><p>The second step is searching for fonts within an SVG file. If a font is Unicode, then the text content is OK. If the font uses a non-Unicode charset, then the text content should be searched for non-Unicode characters. If no non-Unicode assignments are used, then the text content is OK. If non-Unicode assignments are used, then select a Unicode font replacement, and edit the text content to change the non-Unicode characters to equivalent Unicode characters.
</p><p>Those steps require a significant database.
</p>
<ol><li>font family</li>
<li>character encoding (points to a (possibly standard) table)</li>
<li>replacement font</li></ol>
<dl><dd><small>see <a href="https://en.wikipedia.org/wiki/Mojibake" class="extiw" title="w:Mojibake">w:Mojibake</a></small></dd></dl>
<h3><span class="mw-headline" id="Character_metrics">Character metrics</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=42" title="Edit section: Character metrics">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Differences in font metrics are expected. The character widths will vary. The cap-height and x-height will vary.
</p><p>But there are technical placement issues that spell trouble.
</p><p>The first music font was Adobe Sonata. The common staff height is set to 1 em. The notehead centers were set on the baseline. So we can get the simple
</p>
<ul><li>Sonata
<dl><dd><dl><dd><dl><dd><dl><dd><dl><dd><dl><dd><dl><dd><span style="font-family: Sonata, Courier New; font-size: 80px;">=qq=</span></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></li></ul>
<p>Unicode brought out a music block, but it apparently did not specify where the glyphs should land. Google's Noto Music font has a different positioning:
</p>
<ul><li>Noto Music
<dl><dd><dl><dd><dl><dd><dl><dd><dl><dd><dl><dd><dl><dd><span style="font-family: Noto Music, Courier New; font-size: 80px;">&#x1d11a;&#x1d15f;&#x1d15f;&#x1d11a;</span></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></li></ul>
<p>The SMuFL Bravura also uses the Unicode block, but it uses Sonata note positions.
</p>
<ul><li>Bravura
<dl><dd><dl><dd><dl><dd><dl><dd><dl><dd><dl><dd><dl><dd><span style="font-family: Bravura, Courier New; font-size: 80px;">&#x1d11a;&#x1d15f;&#x1d15f;&#x1d11a;</span></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></dd></dl></li></ul>
<p>Other music fonts are more divergent. A notehead may not fit between staff lines. The staff height may not be 1 em.
</p>
<h3><span class="mw-headline" id="Path_text">Path text</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=43" title="Edit section: Path text">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Talk about what path text looks like in some contexts.
</p><p>There are files that should have path text removed.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Chromosome.svg" title="File:Chromosome.svg">File:Chromosome.svg</a> This file primarily has path text because flowRoot does not display. <img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Animal_cell_structure_en.svg" title="File:Animal cell structure en.svg">File:Animal cell structure en.svg</a> (227 kB) clean this file up and then use SVG Translate.... Many separate translations exist.</li>
<li><a href="https://commons.wikimedia.org/wiki/File:Tulejki_zaciskowe.svg" title="File:Tulejki zaciskowe.svg">File:Tulejki zaciskowe.svg</a> collet closing schemes</li></ul>
<p>SVG files that have converted text to path are often marked with <a href="https://commons.wikimedia.org/wiki/Template:Path_text_SVG" title="Template:Path text SVG"><span style="font-family:monospace,monospace;">&#123;&#123;Path text SVG&#125;&#125;</span></a>. Another (earlier?) convention was to explicitly categorize files that should use text to <a href="https://commons.wikimedia.org/wiki/Category:Convert_to_TXT" title="Category:Convert to TXT">Category:Convert to TXT</a>. The category has JPEG, PNG, and SVG files in it. Ah! It's from <a href="https://commons.wikimedia.org/wiki/Template:ShouldBeText" title="Template:ShouldBeText"><span style="font-family:monospace,monospace;">&#123;&#123;ShouldBeText&#125;&#125;</span></a>. That template wants the figures to be converted to wikitext rather than using an illustration. It may be better to mark some files with <a href="https://commons.wikimedia.org/wiki/Template:Path_text_SVG" title="Template:Path text SVG"><span style="font-family:monospace,monospace;">&#123;&#123;Path text SVG&#125;&#125;</span></a> or <a href="https://commons.wikimedia.org/wiki/Template:Convert_to_SVG" title="Template:Convert to SVG"><span style="font-family:monospace,monospace;">&#123;&#123;Convert to SVG&#125;&#125;</span></a>.
</p><p>Here is a file in the category:
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Ipv6_header.svg" title="File:Ipv6 header.svg">File:Ipv6 header.svg</a> 30 kB <img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b></li></ul>
<p>The file has not only converted the text to paths, each letter is a <code>symbol</code>, and the text is typeset by placing those symbols.
This file is also interesting in that it describes a technical standard, and the text in the file are candidates for <code>translate="no"</code>.
</p><p>Another file:
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Thermostatic_expansion_valve.svg" title="File:Thermostatic expansion valve.svg">File:Thermostatic expansion valve.svg</a></li></ul>
<p>Files with even more confusion (text as symbols and curves drawn as line segments):
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:6rd.svg" title="File:6rd.svg">File:6rd.svg</a> 312 kB</li>
<li><a href="https://commons.wikimedia.org/wiki/File:Tunnel-ipv6.svg" title="File:Tunnel-ipv6.svg">File:Tunnel-ipv6.svg</a> 270 kB</li></ul>
<h3><span class="mw-headline" id="Glyphs">Glyphs</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=44" title="Edit section: Glyphs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg/220px-Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg.png" decoding="async" width="220" height="329" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg/330px-Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg/440px-Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg.png 2x" data-file-width="188" data-file-height="281" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg" class="internal" title="Enlarge"></a></div>A (non) candidate for glyphs. 115&#160;kB.</div></div></div>
<p>SVG 1.0 and 1.1 have SVG elements that allow a user to embed a font.
</p><p>For those cases where converting text to curves makes sense, using glyphs offers potential benefits.
</p><p>Discussion at <a href="https://commons.wikimedia.org/wiki/Commons:Graphic_Lab/Illustration_workshop/Archive/2021#Vietnamese-style_seal_of_the_Government-General_of_French_Indo-China" title="Commons:Graphic Lab/Illustration workshop/Archive/2021">Commons:Graphic_Lab/Illustration_workshop/Archive/2021#Vietnamese-style_seal_of_the_Government-General_of_French_Indo-China</a> (and several sections immediately following)
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg" title="File:Vietnamese-style seal of the Government-General of French Indochina.svg">File:Vietnamese-style_seal_of_the_Government-General_of_French_Indochina.svg</a></li></ul>
<p>General information about <a href="https://en.wikipedia.org/wiki/en:Seal_script" class="extiw" title="w:en:Seal script">w:en:Seal script</a>.
</p><p>The seal is 115&#160;kB for 15 characters. That is about 7700 bytes per character, which is rather large. Using the <code>path</code> element, one should be able to describe a line segment in less than 100 bytes. Examining the image with magnification shows that the character strokes have a lot of noise.
</p><p>Modern script (not seal script) using <code>writing-mode: vertical-rl</code>:
</p>
<p style="writing-mode: vertical-rl; text-indent: 0px; border-style:solid; border-width:5px; padding:5px;letter-spacing:5px;">
大法國欽命<br />總統東法全<br />權大臣管理
</p>
<p>Some SVG files embedded commercial fonts as glyphs. For example, an Adobe Illustration file might embed a portion of the Arial font in an SVG file. That practice should be discouraged.
</p>
<h4><span class="mw-headline" id="SVG_2.0_drops_glyph">SVG 2.0 drops <code>glyph</code></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=45" title="Edit section: SVG 2.0 drops glyph">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>SVG was developed when web fonts were not available, so SVG included a rudimentary embedded font mechanism.<sup id="cite_ref-17" class="reference"><a href="#cite_note-17">&#91;17&#93;</a></sup> With web fonts, such a facility is not as important, so the mechanism has been deprecrated. As of 2021, support may still be found in the Safari and Android browsers.
</p>
<h4><span class="mw-headline" id="Glyphs_would_not_work_with_some_scripts">Glyphs would not work with some scripts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=46" title="Edit section: Glyphs would not work with some scripts">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The Unicode specification will not add any new composed characters. That simplifies the number of characters needed. For example, Siddham script has thousands of glyphs, but most of those glyphs are composed characters. In Unicode, Siddham has a small number of fundamental characters. Composed characters are still drawn, but they no longer have exposed codepoints.
</p>
<h3><span class="mw-headline" id="WMF_prohibits_web_fonts">WMF prohibits web fonts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=47" title="Edit section: WMF prohibits web fonts">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>SVG 2.0 may have dropped <code>glyph</code> support because web fonts are now available. In the past, web pages depended upon the fonts that a user already had on his local machine. If the local machine did not have the font, then it would substitute some other font. Those substitutions could lead to bizarre results.
</p><p>It gets even more troublesome when the desired font is for uncommon Unicode scripts. Unicode supports many scripts, but most users will not have those scripts. Unicode has assignments for Egyptian hieroglyphics and ancient Sanskrit Siddham.
</p><p>CSS now has a mechanism to load web font.
</p><p>Google offers a lot of fonts, and it also has CSS files to use those fonts as web fonts. (Reference)
</p><p>The downside is the webfonts allow some tracking. The web font files have a long caching time (was it a year?). A browser would download the font and use it without continually querying the Google servers. The CSS files have relatively short cache times, so the browser would be contacting Google servers often. (Reference)
</p>
<h3><span class="mw-headline" id="Alberta_road_signs">Alberta road signs</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=48" title="Edit section: Alberta road signs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Road signs can be thorny. They may contain artistic text, and they may contain ordinary text.
</p><p>Even with artistic text, the file sizes are often not large because the signs are simple (they do not contain much text).
</p><p>Old Alberta road signs could sensibly use a stylized font.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Alberta_Highway_1A_(1970s).svg" title="File:Alberta Highway 1A (1970s).svg">File:Alberta Highway 1A (1970s).svg</a></li></ul>
<p>The modern road signs are too stylized.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Alberta_Highway_2.svg" title="File:Alberta Highway 2.svg">File:Alberta Highway 2.svg</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Alberta_Highway_584.svg" title="File:Alberta Highway 584.svg">File:Alberta Highway 584.svg</a> "This SVG sign uses the path text method."</li></ul>
<p>See <a href="https://commons.wikimedia.org/wiki/Category:Alberta_Highway_shields" title="Category:Alberta Highway shields">Category:Alberta Highway shields</a>
</p><p><a href="https://commons.wikimedia.org/wiki/User:Highway_Route_Marker_Bot" title="User:Highway Route Marker Bot">User:Highway Route Marker Bot</a>
</p><p>Fonts are not that important to signs. See <a href="https://commons.wikimedia.org/wiki/File:AB69ewSigns-TwoFontsYMM_(28172571140).jpg" title="File:AB69ewSigns-TwoFontsYMM (28172571140).jpg">File:AB69ewSigns-TwoFontsYMM (28172571140).jpg</a> which shows two road signs using the old Alberta logo but the highway numbers are in different fonts.
</p><p>Font height may remain fixed, but the font weight (e.g., bold) or font stretch (e.g., condensed) may vary.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Alberta_Highway_2.svg" class="image"><img alt="Alberta Highway 2.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Alberta_Highway_2.svg/90px-Alberta_Highway_2.svg.png" decoding="async" width="90" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Alberta_Highway_2.svg/135px-Alberta_Highway_2.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Alberta_Highway_2.svg/180px-Alberta_Highway_2.svg.png 2x" data-file-width="450" data-file-height="600" /></a></div></div>
			<div class="gallerytext">
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Alberta_Highway_2A.svg" class="image"><img alt="Alberta Highway 2A.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/01/Alberta_Highway_2A.svg/90px-Alberta_Highway_2A.svg.png" decoding="async" width="90" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/0/01/Alberta_Highway_2A.svg/135px-Alberta_Highway_2A.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/0/01/Alberta_Highway_2A.svg/180px-Alberta_Highway_2A.svg.png 2x" data-file-width="450" data-file-height="600" /></a></div></div>
			<div class="gallerytext">
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Alberta_Highway_93.svg" class="image"><img alt="Alberta Highway 93.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/48/Alberta_Highway_93.svg/90px-Alberta_Highway_93.svg.png" decoding="async" width="90" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/48/Alberta_Highway_93.svg/135px-Alberta_Highway_93.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/48/Alberta_Highway_93.svg/180px-Alberta_Highway_93.svg.png 2x" data-file-width="450" data-file-height="600" /></a></div></div>
			<div class="gallerytext">
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Alberta_Highway_93A.svg" class="image"><img alt="Alberta Highway 93A.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d5/Alberta_Highway_93A.svg/90px-Alberta_Highway_93A.svg.png" decoding="async" width="90" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d5/Alberta_Highway_93A.svg/135px-Alberta_Highway_93A.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/d/d5/Alberta_Highway_93A.svg/180px-Alberta_Highway_93A.svg.png 2x" data-file-width="450" data-file-height="600" /></a></div></div>
			<div class="gallerytext">
			</div>
		</div></li>
</ul>
<p><span style="font-family:sans-serif; font-size:30px; font-weight:bold"><span style="font-weight:900; font-stretch:ultra-expanded;">2</span>, 2A, 93, <span style="font-stretch: condensed">93A</span></span>
</p><p><a href="https://en.wikipedia.org/wiki/en:Symbols_of_Alberta" class="extiw" title="w:en:Symbols of Alberta">w:en:Symbols_of_Alberta</a>
</p><p><a href="https://commons.wikimedia.org/wiki/File:Alberta_wordmark_2009.svg" title="File:Alberta wordmark 2009.svg">File:Alberta wordmark 2009.svg</a>
</p><p><a href="https://commons.wikimedia.org/wiki/File:AB-provincial_highway.svg" title="File:AB-provincial highway.svg">File:AB-provincial highway.svg</a>
</p>
<h3><span class="mw-headline" id="Text_anchors">Text anchors</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=49" title="Edit section: Text anchors">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>SVG files should use reasonable anchors. The usual choices are left aligned, center aligned, or right aligned. If I want text aligned on the right edge, I should not insert some left-aligned text and then move the position of the whole string so the right edge ends whene I want it to end.
</p><p>Alignment is important because font metrics vary. Text that seems to align correctly with one font may look ragged with another font.
</p><p>Choosing the correct text anchor is a simple defense against varying font metrics.
</p>
<h3><span id="Text_anchors.2C_direction.2C_and_BIDI"></span><span class="mw-headline" id="Text_anchors,_direction,_and_BIDI">Text anchors, direction, and BIDI</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=50" title="Edit section: Text anchors, direction, and BIDI">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There are subtle problems with SVG text anchors. The SVG semantics do not play well with text direction. If the anchor sets a starting point, then left-to-right text builds to the right, but right-to-left text builds to the left. That can give screwy results.
</p><p>The issue is a bit more complex. There is an interaction between the specified text direction and the Unicode BIDI algorithm. They will give reasonable results in simple cases.
</p><p>Consider start-aligned text: <code>text-anchor="start"</code>.
</p><p>For English, we expect <code>direction="ltr"</code>, so we would expect
</p>
<pre>        |English
</pre>
<p>For Arabic, we expect <code>direction="rtl"</code>, so we would expect
</p>
<pre>  cibarA|
</pre>
<p>But if the Arabic is laid out with <code>direction="ltr"</code>, the layout sort of works due to BIDI:
</p>
<pre>        |cibarA
</pre>
<p>Do nothing, and the layout sort of works. It fails when strings contain both LTR and RTL characters. Consider "English 17 kg". Where we want to keep the "kg" units. The result with <code>direction="ltr"</code> is
</p>
<pre>        |English 17 kg
        |17 cibarA kg
</pre>
<p>BIDI starts out in LTR. It sees the Arabic, so it starts a RTL block for "Arabic". The space is neutral, so it is added RTL. The numbers are weak LTR, so they are added to the RTL block as a subblock. The "kg" is strong LTR, so they terminate the blocks and go back to toplevel.
</p><p>Here are some <code>span</code> elements in HTML:
</p>
<ul><li><span>English 17 kg</span></li>
<li><span>عربي 17 kg</span></li></ul>
<p>To do it correctly, we need to set the direction for the entire phrase and swap the <code>text-anchor</code>.
Here is the text setting the direction for the entire span
</p>
<ul><li><span dir="ltr">English 17 kg</span></li>
<li><span dir="rtl">عربي 17 kg</span></li></ul>
<p>Ideally, the <code>text</code> element should set the text direction that is appropriate for the script. English text should set the text direction as left-to-right. Arabic text should set the text direction as right-to-left. Unicode BIDI will then layout the strings correctly, but now the layout will head in opposite directions. For expected results, one must change both the text anchor and the text direction. That's a headache.
</p><p>In theory, CSS can fix the problem, but SVG agents may have weak CSS implementations.
</p><p><a href="https://phabricator.wikimedia.org/T271663" class="extiw" title="phab:T271663">Phab:T271663</a> <cite>Offer to invert text-anchor for RTL languages</cite>
</p>
<h2><span class="mw-headline" id="SVG_warts">SVG warts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=51" title="Edit section: SVG warts">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="SVG_is_not_HTML">SVG is not HTML</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=52" title="Edit section: SVG is not HTML">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>SVG 1.1 used <code>xlink;</code> namespace. HTML does not have namespaces, so HTML uses just <code>href</code> rather than <code>xlink:href</code>. For some reason (perhaps embedding SVG within HTML), SVG 2.0 has decided to use <code>href</code>.
</p><p>The problem with <code>xml:lang</code> and <code>lang</code>.
</p><p>SVG should be about making marks on a screen or a piece of paper. It should not be about myriad other topics. If the semantics are not about marks on paper, then the semantics do not belong in the SVG specification.
</p><p>For example, there is a notion that some text might be translated to another language, while other text should not be. People who were interested in XML markup developed the Internationalization Tag Set for making such notations. Consequently, one could add rules and attributes to an XML file that translation utilities could use. The attribute <code>its:translate="no"</code> means do not translate the content, and <code>its:translate="yes"</code> means translate the content. The specification also included rules using XPATH patterns to identify what should or should not be translated. Everything in the <code>its</code> namespace is distinct from other namespaces (and the default namespace).
</p><p>HTML does not have namespaces, so the use of ITS is a bit awkward. So HTML added the <code>translate</code> attribute. It is not as powerful as the ITS specification, but it is simple. SVG comes along and copies the HTML <code>translate</code> attribute. There is no reason. SVG can support the <code>its:</code> namespace; it is not crippled like HTML.
</p><p>HTML does not have namespaces. Instead of following XML and adopting namespaces (as XHTML did), HTML invented a poor man's namespace. If attributes start with <code>data-</code> or <code>aria-</code>, then they are in a quasi-namespace. SVG is XML, so it need not stoop to such measures. SVG should have used <code>data:</code> and <code>aria:</code> namespaces.
</p><p>HTML ignores capitalization. Consequently, <code>&lt;Head&gt;</code> is the same as <code>&lt;HEAD&gt;</code>. It is the same for attributes. However, the <code>data-</code> attributes wanted to have database keys that were cases sensitive. So HTML uses a hyphen algorithm. Everything after the <code>data-</code> prefix is in lowercase unless it is immediately preceded by a hyphen. The attribute <code>DATA-NAME="Smith"</code> sets <code>database["name"] = "Smith"</code>. If we wanted the database key to be all capitals, we must say <code>data--N-A-M-E="Smith"</code>. That's due to the case-insensitive nature of HTML. XML and SVG can be much simpler. They could say either <code>data:name="Smith"</code> or <code>data:NAME="Smith"</code>. No need for a pseudo namespace, and no need for a hyphen capitalization rule.
</p>
<h3><span class="mw-headline" id="Zoom_and_pan">Zoom and pan</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=53" title="Edit section: Zoom and pan">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Can SVG images be inserted such that the image can be zoomed and panned without affecting the including page?
</p><p>Does the use of <code>viewBox</code> frustrate that goal?
</p>
<h2><span class="mw-headline" id="MediaWiki_problems">MediaWiki problems</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=54" title="Edit section: MediaWiki problems">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h2><span class="mw-headline" id="librsvg_color_issue"><code>librsvg</code> color issue</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=55" title="Edit section: librsvg color issue">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Where was this?
</p><p>The <code>librsvg</code> renderer produces PNG bitmaps, but those bitmaps may not set the colorspace to sRGB.
</p>
<h3><span class="mw-headline" id="MediaWiki_whitelisted_namespaces">MediaWiki whitelisted namespaces</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=56" title="Edit section: MediaWiki whitelisted namespaces">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>MediaWiki has a select set of namespaces for SVG.
</p><p>The intention of the whitelist is to avoid script injection. For example, the SVG might include an XHTML namespace subtree, and that subtree might allow scripting that is not detected by the ordinary SVG filter.
</p><p>It looks like the test requires elements to be in whitelisted namespaces but does not require attributes to be in whitelisted namespaces. I should check that distinction. Might try
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;svg</span> <span class="na">version=</span><span class="s">&quot;1.1&quot;</span>
     <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span>
     <span class="na">xmlns:xlink=</span><span class="s">&quot;http://www.w3.org/1999/xlink&quot;</span>
     <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
     <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://namespace... http://schemalocation/schema.xsd&quot;</span><span class="nt">&gt;</span>
</pre></div>
<p>See also <a href="https://commons.wikimedia.org/wiki/Help:SVG" title="Help:SVG">Help:SVG</a>.
</p>
<ul><li><a href="https://phabricator.wikimedia.org/T153285" class="extiw" title="phab:T153285">T153285: Unexpected error "This SVG file contains an illegal namespace" for xmlns:rdfs attribute value</a> (closed).</li>
<li><a href="https://phabricator.wikimedia.org/T278044" class="extiw" title="phab:T278044">T278044: This SVG file contains an illegal namespace "http://www.w3.org/2000/02/svg/testsuite/description/".</a>
<dl><dd>code: <a class="external free" href="https://phabricator.wikimedia.org/rMW7d923a6b53f7fbcb0cbc3a19797d741bf6f440eb">https://phabricator.wikimedia.org/rMW7d923a6b53f7fbcb0cbc3a19797d741bf6f440eb</a></dd>
<dd>code: <a class="external free" href="https://phabricator.wikimedia.org/source/mediawiki/browse/master/includes/upload/UploadBase.php">https://phabricator.wikimedia.org/source/mediawiki/browse/master/includes/upload/UploadBase.php</a> line 1581</dd></dl></li>
<li><a href="https://phabricator.wikimedia.org/T283316" class="extiw" title="phab:T283316">T283316: More whitelisted namespaces for SVG files</a></li></ul>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1571"></span>		<span class="k">static</span> <span class="nv">$validNamespaces</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos" data-line="1572"></span>			<span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1573"></span>			<span class="s1">&#39;adobe:ns:meta/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1574"></span>			<span class="s1">&#39;http://creativecommons.org/ns#&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1575"></span>			<span class="s1">&#39;http://inkscape.sourceforge.net/dtd/sodipodi-0.dtd&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1576"></span>			<span class="s1">&#39;http://ns.adobe.com/adobeillustrator/10.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1577"></span>			<span class="s1">&#39;http://ns.adobe.com/adobesvgviewerextensions/3.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1578"></span>			<span class="s1">&#39;http://ns.adobe.com/extensibility/1.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1579"></span>			<span class="s1">&#39;http://ns.adobe.com/flows/1.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1580"></span>			<span class="s1">&#39;http://ns.adobe.com/illustrator/1.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1581"></span>			<span class="s1">&#39;http://ns.adobe.com/imagereplacement/1.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1582"></span>			<span class="s1">&#39;http://ns.adobe.com/pdf/1.3/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1583"></span>			<span class="s1">&#39;http://ns.adobe.com/photoshop/1.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1584"></span>			<span class="s1">&#39;http://ns.adobe.com/saveforweb/1.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1585"></span>			<span class="s1">&#39;http://ns.adobe.com/variables/1.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1586"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1587"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/g/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1588"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/g/img/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1589"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/mm/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1590"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/rights/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1591"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/stype/dimensions#&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1592"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/stype/font#&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1593"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/stype/manifestitem#&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1594"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/stype/resourceevent#&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1595"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/stype/resourceref#&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1596"></span>			<span class="s1">&#39;http://ns.adobe.com/xap/1.0/t/pg/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1597"></span>			<span class="s1">&#39;http://purl.org/dc/elements/1.1/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1598"></span>			<span class="s1">&#39;http://purl.org/dc/elements/1.1&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1599"></span>			<span class="s1">&#39;http://schemas.microsoft.com/visio/2003/svgextensions/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1600"></span>			<span class="s1">&#39;http://sodipodi.sourceforge.net/dtd/sodipodi-0.dtd&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1601"></span>			<span class="s1">&#39;http://taptrix.com/inkpad/svg_extensions&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1602"></span>			<span class="s1">&#39;http://web.resource.org/cc/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1603"></span>			<span class="s1">&#39;http://www.freesoftware.fsf.org/bkchem/cdml&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1604"></span>			<span class="s1">&#39;http://www.inkscape.org/namespaces/inkscape&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1605"></span>			<span class="s1">&#39;http://www.opengis.net/gml&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1606"></span>			<span class="s1">&#39;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1607"></span>			<span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1608"></span>			<span class="s1">&#39;http://www.w3.org/tr/rec-rdf-syntax/&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1609"></span>			<span class="s1">&#39;http://www.w3.org/2000/01/rdf-schema#&#39;</span><span class="p">,</span>
<span class="linenos" data-line="1610"></span>		<span class="p">];</span>
</pre></div>
<p>Namespaces to add:
</p>
<ul><li><code>'<a rel="nofollow" class="external free" href="http://www.w3.org/2000/02/svg/testsuite/description/'">http://www.w3.org/2000/02/svg/testsuite/description/'</a></code> for W3C test suites</li>
<li><code>'<a rel="nofollow" class="external free" href="http://purl.org/dc/terms/'">http://purl.org/dc/terms/'</a></code> more recent Dublin Core</li>
<li><code>'<a rel="nofollow" class="external free" href="http://www.w3.org/1998/Math/MathML'">http://www.w3.org/1998/Math/MathML'</a></code> MathML</li>
<li><code>'<a rel="nofollow" class="external free" href="http://www.opengis.net/gml/3.2'">http://www.opengis.net/gml/3.2'</a></code> new version of GML</li>
<li><code>'<a rel="nofollow" class="external free" href="http://www.w3.org/2005/11/its'">http://www.w3.org/2005/11/its'</a></code> <a href="https://en.wikipedia.org/wiki/Internationalization_Tag_Set" class="extiw" title="w:Internationalization Tag Set">w:Internationalization Tag Set</a></li>
<li>Library of Congress vocabulary
<ul><li><code>xmlns:marcrel="<a rel="nofollow" class="external free" href="http://www.loc.gov/loc.terms/relators/">http://www.loc.gov/loc.terms/relators/</a>"</code></li>
<li><a rel="nofollow" class="external free" href="https://www.dublincore.org/specifications/dublin-core/relators/">https://www.dublincore.org/specifications/dublin-core/relators/</a></li></ul></li>
<li>LOC MADS
<ul><li><code>'<a rel="nofollow" class="external free" href="http://www.loc.gov/mads/rdf/v1#&#39;">http://www.loc.gov/mads/rdf/v1#'</a></code> MADS</li>
<li><code>'<a rel="nofollow" class="external free" href="http://www.w3.org/2002/07/owl#&#39;">http://www.w3.org/2002/07/owl#'</a></code> OWL</li>
<li><code>'<a rel="nofollow" class="external free" href="http://www.w3.org/2004/02/skos/core#&#39;">http://www.w3.org/2004/02/skos/core#'</a></code> SKOS</li>
<li><code>'<a rel="nofollow" class="external free" href="http://xmlns.com/foaf/0.1/'">http://xmlns.com/foaf/0.1/'</a></code> FOAF</li></ul></li>
<li>LOC MODS
<ul><li><code><a rel="nofollow" class="external free" href="http://www.loc.gov/mods/rdf/v1#&#39;">http://www.loc.gov/mods/rdf/v1#'</a></code> MODS</li></ul></li>
<li><code>'<a rel="nofollow" class="external free" href="http://www.ogc.org/crs'">http://www.ogc.org/crs'</a></code> maybe...</li></ul>
<p>One of the whitelisted namespaces is suspect:
</p>
<ul><li><code>'<a rel="nofollow" class="external free" href="http://purl.org/dc/elements/1.1'">http://purl.org/dc/elements/1.1'</a></code></li></ul>
<p>Might check if there are any SVG files that use this namespace.
</p><p>Some absent namespaces are significant. When <a href="https://en.wikipedia.org/wiki/Dublin_Core" class="extiw" title="w:Dublin Core">Dublin Core</a> came out in 2000, it provided a succinct set of terms in the <code>dc/elements/1.1/</code> namespace. The next year, it came out with an expanded <code>dc/terms/</code> namespace and vocabulary. In 2008, it encouraged dropping the first namespace in favor of the <code>dc/terms/</code> namespace. WMF accepts the former but not the latter namespace.
</p>
<h4><span class="mw-headline" id="MathML_namespace">MathML namespace</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=57" title="Edit section: MathML namespace">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The MathML namespace is also not whitelisted. MathML allows sophisticated mathematical typesetting, but WMF blocks its upload. Users cannot upload this file:
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;svg</span> <span class="na">viewBox=</span><span class="s">&quot;0 0 300 200&quot;</span>
     <span class="na">version=</span><span class="s">&quot;1.1&quot;</span>
     <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span>
     <span class="na">xmlns:xlink=</span><span class="s">&quot;http://www.w3.org/1999/xlink&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title&gt;</span>SVG MathML test<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;desc&gt;</span>Test if MathML is available in SVG. Will not upload to Commons due to MathML namespace.<span class="nt">&lt;/desc&gt;</span>

  <span class="nt">&lt;metadata&gt;</span>
    <span class="nt">&lt;rdf:RDF</span> <span class="na">xmlns:rdf=</span><span class="s">&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
             <span class="na">xmlns:dc=</span><span class="s">&quot;http://purl.org/dc/terms/&quot;</span>
             <span class="na">xmlns:cc=</span><span class="s">&quot;http://creativecommons.org/ns#&quot;</span> <span class="nt">&gt;</span>
      <span class="nt">&lt;cc:Work</span> <span class="na">rdf:about=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;dc:publisher&gt;</span>Wikimedia Commons<span class="nt">&lt;/dc:publisher&gt;</span>
        <span class="nt">&lt;cc:license</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://creativecommons.org/publicdomain/zero/1.0/&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;cc:attributionName</span> <span class="na">rdf:resouce=</span><span class="s">&quot;http://commons.wikimedia.org/wiki/User:Glrx&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;cc:attributionURL</span> <span class="na">rdf:resource=</span><span class="s">&quot;http://commons.wikimedia.org/wiki/File:SVG_MathML_test.svg&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/cc:Work&gt;</span>
    <span class="nt">&lt;/rdf:RDF&gt;</span>
  <span class="nt">&lt;/metadata&gt;</span>

  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;150&quot;</span> <span class="na">y=</span><span class="s">&quot;40&quot;</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span><span class="nt">&gt;</span>SVG MathML test<span class="nt">&lt;/text&gt;</span>

  <span class="nt">&lt;switch</span> <span class="na">transform=</span><span class="s">&quot;translate(50,100)&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;foreignObject</span> <span class="na">width=</span><span class="s">&quot;200&quot;</span> <span class="na">height=</span><span class="s">&quot;50&quot;</span>
                   <span class="na">requiredExtensions=</span><span class="s">&quot;http://www.w3.org/1998/Math/MathML&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;math</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1998/Math/MathML&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;msqrt&gt;</span>
            <span class="nt">&lt;msup&gt;&lt;mi&gt;</span>x<span class="nt">&lt;/mi&gt;&lt;mn&gt;</span>2<span class="nt">&lt;/mn&gt;&lt;/msup&gt;</span>
            <span class="nt">&lt;mo&gt;</span>+<span class="nt">&lt;/mo&gt;</span>
            <span class="nt">&lt;msup&gt;&lt;mi&gt;</span>y<span class="nt">&lt;/mi&gt;&lt;mn&gt;</span>2<span class="nt">&lt;/mn&gt;&lt;/msup&gt;</span>
          <span class="nt">&lt;/msqrt&gt;</span>
        <span class="nt">&lt;/math&gt;</span>
    <span class="nt">&lt;/foreignObject&gt;</span>
    <span class="nt">&lt;text&gt;</span>\sqrt{x^2 + y^2}<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;/switch&gt;</span>

  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;10&quot;</span> <span class="na">y=</span><span class="s">&quot;175&quot;</span> <span class="na">font-size=</span><span class="s">&quot;8&quot;</span><span class="nt">&gt;</span>should display a formula in either MathML or TeX<span class="nt">&lt;/text&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></div></dd></dl>
<h2><span class="mw-headline" id="Future">Future</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=58" title="Edit section: Future">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:TDR_SMA_open.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/TDR_SMA_open.svg/220px-TDR_SMA_open.svg.png" decoding="async" width="220" height="178" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/TDR_SMA_open.svg/330px-TDR_SMA_open.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/TDR_SMA_open.svg/440px-TDR_SMA_open.svg.png 2x" data-file-width="1040" data-file-height="840" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:TDR_SMA_open.svg" class="internal" title="Enlarge"></a></div>Color picture that should be drawn differently in black and white.</div></div></div>
<p>SVG allows images to adapt. Printing a color image in black and white may not produce a satisfactory result. A red fill may look similar to a dark gray fill. SVG can use CSS media queries and adjust the presentation.
</p><p>Consider the image on the right. If the media supports color, then the picture can have a blue background with white text and lines. If the media is black and white, then the background can be white, and the text and lines can be black. Mechanical drawings can be more complex. For color media, solid color fills may distinguish different components; for black and white media, crosshatches may distinguish the components.
</p><p>An SVG <code>style</code> element has a <code>media</code> attribute. CSS syntax allows <code>@media</code> queries.
</p><p>SVG 1.1 / CSS 2 media queries are very limited. SVG 2.0 is much richer.
</p><p>There is some support, but it may not work well. In tests tried around 2019, one browser could distinguish color and monochrome requests, but it would not follow changes in the printer properties.
</p>
<h2><span class="mw-headline" id="General_issues">General issues</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=59" title="Edit section: General issues">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:SVG_test_symbol.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/SVG_test_symbol.svg/220px-SVG_test_symbol.svg.png" decoding="async" width="220" height="110" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/SVG_test_symbol.svg/330px-SVG_test_symbol.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/SVG_test_symbol.svg/440px-SVG_test_symbol.svg.png 2x" data-file-width="512" data-file-height="256" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:SVG_test_symbol.svg" class="internal" title="Enlarge"></a></div>librsvg does not turn off its clip region.</div></div></div>
<ul><li><a class="external free" href="https://commons.wikimedia.org/w/index.php?title=User_talk%3ASarang&amp;type=revision&amp;diff=611702254&amp;oldid=611488584">https://commons.wikimedia.org/w/index.php?title=User_talk%3ASarang&amp;type=revision&amp;diff=611702254&amp;oldid=611488584</a> at &#167; Calvin-cycle4.svg
<dl><dd>about <a href="https://commons.wikimedia.org/wiki/File:Calvin-cycle4.svg" title="File:Calvin-cycle4.svg">File:Calvin-cycle4.svg</a> and other topics.</dd></dl></li>
<li>WMF <code>librsvg</code> does not support <code>style="overflow:visible"</code>. Symbols always have a clipping region.</li></ul>
<div style="clear:both;"></div>
<h2><span class="mw-headline" id="Converting_bitmaps_to_SVG">Converting bitmaps to SVG</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=60" title="Edit section: Converting bitmaps to SVG">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:Silversmith.jpg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Silversmith.jpg/220px-Silversmith.jpg" decoding="async" width="220" height="295" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Silversmith.jpg/330px-Silversmith.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Silversmith.jpg/440px-Silversmith.jpg 2x" data-file-width="610" data-file-height="818" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:Silversmith.jpg" class="internal" title="Enlarge"></a></div>Photographs are usually poor choices for vectorization. (25&#160;kB)</div></div></div>
<p>Many files on Commons are bitmaps, but some would be more useful as SVG files. Bitmap files are great with large, orthogonal, features, but they can struggle with thin features and curves. Zooming in on a feature will show more anti-aliasing fuzz or jagged edges. More details require more bits. Bitmap files can be difficult to edit. Changing lines or text involves not only adding the new content, but also erasing the old. Erasures can be difficult because the background must be reconstructed. It is difficult to copy text that is in a bitmap: the text is just a picture that must be converted to characters. It takes a lot of work to translate a bitmap to another language. Bitmap files that are good candidates for vectorization can be marked with <a href="https://commons.wikimedia.org/wiki/Template:Convert_to_SVG" title="Template:Convert to SVG"><span style="font-family:monospace,monospace;">&#123;&#123;Convert to SVG&#125;&#125;</span></a>.
</p><p>Expensive parser tests:
</p>
<ul><li>{{PAGESIZE:{{FULLPAGENAME}} &#8594; 217,503</li>
<li>{{PAGESIZE:File:Silversmith.jpg}} &#8594; 2,601 (size of description page)</li></ul>
<p>Unfortunately, converting a bitmap file to a vector file may not be an easy task. It also may not be desired.
</p><p>Technical bitmaps such as a QR code should remain bitmaps. (Do not convert QR code PNG files to JPEG bitmaps.) 
</p><p>Converting a photograph or other continuous-tone image to SVG is usually inappropriate. See <a href="https://en.wikipedia.org/wiki/Image_tracing" class="extiw" title="w:Image tracing">w:Image tracing</a>. Good candidates for conversion need to have significant structure. Some continuous-tone images have structured color gradients, so they can be vectorized.
</p><p>Images with a lot of random details may be inappropriate. it does not take much information to describe a long straight line, but it does take a lot of information to describe 10,000 individual objects. There are times that randomness can be described by a pseudorandom process. (For example, MPEG replaces fricative sounds with a noise generator.)
</p><p>Here is a progression of changes to a subject image. The details and appearance of an image can be improved and still be an efficient representation of the object. The last image has the detail of the gun powder grains without individually drawing each grain.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Bullet.svg" class="image" title="(SVG) March 2006 179 × 437 (9 KB). Powder suggested with precisely placed dots."><img alt="(SVG) March 2006 179 × 437 (9 KB). Powder suggested with precisely placed dots." src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/Bullet.svg/120px-Bullet.svg.png" decoding="async" width="120" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/Bullet.svg/180px-Bullet.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/Bullet.svg/240px-Bullet.svg.png 2x" data-file-width="456" data-file-height="456" /></a></div></div>
			<div class="gallerytext">
<p>(SVG) March 2006<br />179 × 437 (9 KB).<br />Powder suggested with precisely placed dots.
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Bulletfixed.PNG" class="image" title="(PNG) July 2010 332 × 462 (13 KB). Primer pocket added."><img alt="(PNG) July 2010 332 × 462 (13 KB). Primer pocket added." src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Bulletfixed.PNG/86px-Bulletfixed.PNG" decoding="async" width="86" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Bulletfixed.PNG/129px-Bulletfixed.PNG 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Bulletfixed.PNG/172px-Bulletfixed.PNG 2x" data-file-width="332" data-file-height="462" /></a></div></div>
			<div class="gallerytext">
<p>(PNG) July 2010<br />332 × 462 (13 KB).<br />Primer pocket added.
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:26px auto;"><a href="https://commons.wikimedia.org/wiki/File:Cartouche_Boxer.jpg" class="image" title="(JPEG) July 2012 792 × 648 (64 KB). Bitmap file showing the case not completely filled, cross section errors fixed, and powder represented with image."><img alt="(JPEG) July 2012 792 × 648 (64 KB). Bitmap file showing the case not completely filled, cross section errors fixed, and powder represented with image." src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Cartouche_Boxer.jpg/120px-Cartouche_Boxer.jpg" decoding="async" width="120" height="98" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Cartouche_Boxer.jpg/180px-Cartouche_Boxer.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Cartouche_Boxer.jpg/240px-Cartouche_Boxer.jpg 2x" data-file-width="792" data-file-height="648" /></a></div></div>
			<div class="gallerytext">
<p>(JPEG) July 2012<br />792 × 648 (64 KB).<br />Bitmap file showing the case not completely filled, cross section errors fixed, and powder represented with image.
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Cartridge_cross_section.svg" class="image" title="(SVG) May 2021 512 × 512 (9 KB). Coloring with gradients, case not completely filled, and powder represented with a random process."><img alt="(SVG) May 2021 512 × 512 (9 KB). Coloring with gradients, case not completely filled, and powder represented with a random process." src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Cartridge_cross_section.svg/120px-Cartridge_cross_section.svg.png" decoding="async" width="120" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Cartridge_cross_section.svg/180px-Cartridge_cross_section.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Cartridge_cross_section.svg/240px-Cartridge_cross_section.svg.png 2x" data-file-width="512" data-file-height="512" /></a></div></div>
			<div class="gallerytext">
<p>(SVG) May 2021<br />512 × 512 (9 KB).<br />Coloring with gradients, case not completely filled, and powder represented with a random process.
</p>
			</div>
		</div></li>
</ul>
<p>Many technical images can be good candidates for conversion to SVG. See, for example, <a href="https://commons.wikimedia.org/wiki/Category:Cross_sections_of_valves" title="Category:Cross sections of valves">Category:Cross sections of valves</a>.
</p>
<h3><span class="mw-headline" id="Issues">Issues</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=61" title="Edit section: Issues">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section is confused. It should start with straightforward conversions such as diagrams that are easy to redraw.
</p><p>Next, it can address stepped conversions. A stepped conversion is where a bitmap is still present in the SVG, but parts of the bitmap are replaced with SVG elements. Eventually, the SVG elements may eliminate the bitmap. A "stepped conversion" may include SVG files that will always contain a bitmap image. For example, the bitmap may be a photograph, but SVG may use text elements to label the photograph.
</p><p>From there, it can address the random process methods. The section should not lead with the most difficult conversions. It can also serve as a counterpoint to not converting the Mona Lisa to SVG.
</p>
<h4><span class="mw-headline" id="Straightforward_conversions">Straightforward conversions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=62" title="Edit section: Straightforward conversions">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:FiringGeometry.png" class="image" title="50&#160;kB"><img alt="50&#160;kB" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/FiringGeometry.png/346px-FiringGeometry.png" decoding="async" width="346" height="220" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/FiringGeometry.png/519px-FiringGeometry.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/FiringGeometry.png/692px-FiringGeometry.png 2x" data-file-width="792" data-file-height="504" /></a></div></div>
			<div class="gallerytext">
<p>50&#160;kB
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Cn3nucleus.png" class="image" title="12&#160;kB"><img alt="12&#160;kB" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/Cn3nucleus.png/310px-Cn3nucleus.png" decoding="async" width="310" height="220" srcset="https://upload.wikimedia.org/wikipedia/commons/d/da/Cn3nucleus.png 1.5x" data-file-width="359" data-file-height="255" /></a></div></div>
			<div class="gallerytext">
<p>12&#160;kB
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Alveoli_diagram.png" class="image" title="23&#160;kB"><img alt="23&#160;kB" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Alveoli_diagram.png/263px-Alveoli_diagram.png" decoding="async" width="263" height="220" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Alveoli_diagram.png/394px-Alveoli_diagram.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Alveoli_diagram.png/525px-Alveoli_diagram.png 2x" data-file-width="569" data-file-height="477" /></a></div></div>
			<div class="gallerytext">
<p>23&#160;kB
</p>
			</div>
		</div></li>
</ul>
<p>Here is an example of a PNG file that has been converted to SVG.
</p><p>The files are not widely used, but the SVG format makes it easier to fix some minor issues with the original file. For example, the variable such as V<sub>Torpedo</sub> can be edited to use the more common italic-variable convention of <span style="font-style:italic;">V</span><sub>Torpedo</sub>. The arrows for the torpedo and target velocities look like velocity vectors, but they do not make sense as velocity vectors. The diagram suggests that by the time the torpedo reaches the target's track, the target has already gone by that point.
</p><p>The SVG also brings up an issue with SVG <code>marker</code> elements. In the past, I have created a new marker for each fill. There is a technical issue about inheritance of attributes such as <code>stroke</code> and <code>fill</code>. A <code>use</code> instance will not inherit from its environment because it is not part of the DOM tree. In some cases, an instance will use attributes that are set on the <code>use</code> element because they are part of the (inaccessible) tree.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Intercept.png" class="image" title="57&#160;kB PNG 2006-07-20 en:User:Ziggle"><img alt="57&#160;kB PNG 2006-07-20 en:User:Ziggle" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Intercept.png/284px-Intercept.png" decoding="async" width="284" height="320" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Intercept.png/426px-Intercept.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Intercept.png/568px-Intercept.png 2x" data-file-width="600" data-file-height="676" /></a></div></div>
			<div class="gallerytext">
<p>57&#160;kB PNG 2006-07-20 <a href="https://en.wikipedia.org/wiki/User:Ziggle" class="extiw" title="en:User:Ziggle">en:User:Ziggle</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Intercept.svg" class="image" title="29&#160;kB SVG 2010-09-04 Snubcube"><img alt="29&#160;kB SVG 2010-09-04 Snubcube" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f8/Intercept.svg/283px-Intercept.svg.png" decoding="async" width="283" height="320" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f8/Intercept.svg/425px-Intercept.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/f8/Intercept.svg/566px-Intercept.svg.png 2x" data-file-width="599" data-file-height="677" /></a></div></div>
			<div class="gallerytext">
<p>29&#160;kB SVG 2010-09-04 <a href="https://commons.wikimedia.org/w/index.php?title=User:Snubcube&amp;action=edit&amp;redlink=1" class="new" title="User:Snubcube (page does not exist)">Snubcube</a>
</p>
			</div>
		</div></li>
</ul>
<h4><span class="mw-headline" id="Less_simple_conversions">Less simple conversions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=63" title="Edit section: Less simple conversions">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:28.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Littoral_Zones.jpg" class="image" title="35 kB JPEG. US Navy."><img alt="35 kB JPEG. US Navy." src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/Littoral_Zones.jpg/440px-Littoral_Zones.jpg" decoding="async" width="440" height="193" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/Littoral_Zones.jpg/660px-Littoral_Zones.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/2/28/Littoral_Zones.jpg 2x" data-file-width="666" data-file-height="292" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Littoral_Zones.jpg" class="galleryfilename galleryfilename-truncate" title="File:Littoral Zones.jpg">Littoral Zones.jpg</a>
35 kB JPEG. US Navy.
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Map_of_battle_St._Mihiel.JPG" class="image" title="37 kB JPEG. en:User:Redmarkviolinist"><img alt="37 kB JPEG. en:User:Redmarkviolinist" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/af/Map_of_battle_St._Mihiel.JPG/367px-Map_of_battle_St._Mihiel.JPG" decoding="async" width="367" height="220" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/a/af/Map_of_battle_St._Mihiel.JPG/550px-Map_of_battle_St._Mihiel.JPG 1.5x, https://upload.wikimedia.org/wikipedia/commons/a/af/Map_of_battle_St._Mihiel.JPG 2x" data-file-width="586" data-file-height="352" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Map_of_battle_St._Mihiel.JPG" class="galleryfilename galleryfilename-truncate" title="File:Map of battle St. Mihiel.JPG">Map of battle St. Mihiel.JPG</a>
37 kB JPEG. <a href="https://en.wikipedia.org/wiki/User:Redmarkviolinist" class="extiw" title="en:User:Redmarkviolinist">en:User:Redmarkviolinist</a>
</p>
			</div>
		</div></li>
</ul>
<p><a href="https://commons.wikimedia.org/wiki/File:Littoral_Zones.jpg" title="File:Littoral Zones.jpg">File:Littoral Zones.jpg</a> needs a lot of cleaning up.
</p><p><a href="https://commons.wikimedia.org/wiki/File:Map_of_battle_St._Mihiel.JPG" title="File:Map of battle St. Mihiel.JPG">File:Map of battle St. Mihiel.JPG</a> needs cleaning up. Dashed lines are not good candidates for automatic vectorization. Adding color.
</p><p>Map locations with given scale: St. Mihiel <a href="https://www.wikidata.org/wiki/Q194932" class="extiw" title="d:Q194932"><span title="commune in Meuse, France">Saint-Mihiel <small>(Q194932)</small></span></a>, Frenes <a href="https://www.wikidata.org/wiki/Q538768" class="extiw" title="d:Q538768"><span title="former commune in Orne, France">Frênes <small>(Q538768)</small></span></a>, Hattonchatel <a href="https://www.wikidata.org/wiki/Q30127896" class="extiw" title="d:Q30127896"><span title="town in France">Hattonchâtel <small>(Q30127896)</small></span></a>, Vigneulles , Thiacourt <a href="https://www.wikidata.org/wiki/Q497719" class="extiw" title="d:Q497719"><span title="commune in Meurthe-et-Moselle, France">Thiaucourt-Regniéville <small>(Q497719)</small></span></a>, Pont-a-Mousson <a href="https://www.wikidata.org/wiki/Q461413" class="extiw" title="d:Q461413"><span title="commune in Meurthe-et-Moselle, France">Pont-à-Mousson <small>(Q461413)</small></span></a>, Plain of the Woevre <a href="https://www.wikidata.org/wiki/Q1476825" class="extiw" title="d:Q1476825"><span title="natural region of Lorraine, France">Woëvre <small>(Q1476825)</small></span></a>, River Meuse <a href="https://www.wikidata.org/wiki/Q41986" class="extiw" title="d:Q41986"><span title="river in western Europe">Meuse <small>(Q41986)</small></span></a>.
</p>
<h4><span class="mw-headline" id="Conversions_with_gradients">Conversions with gradients</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=64" title="Edit section: Conversions with gradients">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>An image may look complex, but it may just need the appropriate construct.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Anther-schematic.png" class="image" title="82&#160;kB PNG. CC-SA 2.5 by Ben Stefanowitsch"><img alt="82&#160;kB PNG. CC-SA 2.5 by Ben Stefanowitsch" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Anther-schematic.png/244px-Anther-schematic.png" decoding="async" width="244" height="220" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Anther-schematic.png/367px-Anther-schematic.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Anther-schematic.png/489px-Anther-schematic.png 2x" data-file-width="941" data-file-height="847" /></a></div></div>
			<div class="gallerytext">
<p>82&#160;kB PNG. CC-SA 2.5 by Ben Stefanowitsch
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Anther-schematic.svg" class="image" title="3&#160;kB SVG conversion by TilmannR"><img alt="3&#160;kB SVG conversion by TilmannR" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/Anther-schematic.svg/244px-Anther-schematic.svg.png" decoding="async" width="244" height="220" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/Anther-schematic.svg/367px-Anther-schematic.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/Anther-schematic.svg/489px-Anther-schematic.svg.png 2x" data-file-width="941" data-file-height="847" /></a></div></div>
			<div class="gallerytext">
<p>3&#160;kB SVG conversion by <a href="https://commons.wikimedia.org/w/index.php?title=User:TilmannR&amp;action=edit&amp;redlink=1" class="new" title="User:TilmannR (page does not exist)">TilmannR</a>
</p>
			</div>
		</div></li>
</ul>
<h4><span class="mw-headline" id="Conversions_should_be_good">Conversions should be good</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=65" title="Edit section: Conversions should be good">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Suggested replacements should only be used if they are superior. Replacements may not be supperior.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:33px auto;"><a href="https://commons.wikimedia.org/wiki/File:Aufbau_Southern-Blot.jpg" class="image" title="JPEG image (Southern blot)"><img alt="JPEG image (Southern blot)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Aufbau_Southern-Blot.jpg/440px-Aufbau_Southern-Blot.jpg" decoding="async" width="440" height="184" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Aufbau_Southern-Blot.jpg/660px-Aufbau_Southern-Blot.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Aufbau_Southern-Blot.jpg/880px-Aufbau_Southern-Blot.jpg 2x" data-file-width="994" data-file-height="416" /></a></div></div>
			<div class="gallerytext">
<p>JPEG image (Southern blot)
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:29px auto;"><a href="https://commons.wikimedia.org/wiki/File:Kapillarblot.svg" class="image" title="a replacement SVG vector (northern blot)"><img alt="a replacement SVG vector (northern blot)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Kapillarblot.svg/440px-Kapillarblot.svg.png" decoding="async" width="440" height="192" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Kapillarblot.svg/660px-Kapillarblot.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Kapillarblot.svg/880px-Kapillarblot.svg.png 2x" data-file-width="282" data-file-height="123" /></a></div></div>
			<div class="gallerytext">
<p>a replacement SVG vector (northern blot)
</p>
			</div>
		</div></li>
</ul>
<p>The original JPEG is simple and clean. The vector replacement has problems. The JPEG uses a single font. The SVG uses several font sizes and uses colors. A yellow font can be lost in a white background, so the yellow font is stroked. The paper towels are flat in the JPEG, but they are wavy in SVG. One purpose of the paper towels is to evenly distribute the weight; wavy towels (especially when the waves line up) do not convey that purpose. The solution is divided in the JPEG but connected in the SVG. What is the distinction between Southern blot and northern blot?
</p><p>Despite the image having simple vector shapes, the majority of the image is a bitmap.
</p><p>The SVG vector was derived from <a href="https://commons.wikimedia.org/wiki/File:Capillary_blot_setup.svg" title="File:Capillary blot setup.svg">File:Capillary blot setup.svg</a>.
</p><p>The file descriptions are slightly different: the first is about a Southern blot while the second is about a northern blot. The first is for DNA and the second is for RNA, but both procedures use <a href="https://en.wikipedia.org/wiki/Agarose_Gel_Electrophoresis" class="extiw" title="w:Agarose Gel Electrophoresis">agarose gel electrophoresis</a>.<sup id="cite_ref-18" class="reference"><a href="#cite_note-18">&#91;18&#93;</a></sup>
</p><p><a href="https://en.wikipedia.org/wiki/Electroblotting" class="extiw" title="w:Electroblotting">Electroblotting</a> makes more sense as a blot, but the electro-transfer is vertical. That has issues with applying voltage in the given images.
</p><p><a href="https://en.wikipedia.org/wiki/File:Electroblot.gif" class="extiw" title="w:File:Electroblot.gif">w:File:Electroblot.gif</a> is public domain, but not yet transferred to Commons. It shows the vertical electrodes. <a href="https://en.wikipedia.org/wiki/Northern_blot" class="extiw" title="w:Northern blot">w:Northern blot</a> states, "Strictly speaking, the term 'northern blot' refers specifically to the capillary transfer of RNA from the electrophoresis gel to the blotting membrane."
</p><p><a href="https://commons.wikimedia.org/wiki/File:Northern_blot_diagram.png" class="image" title="investigate ..."><img alt="investigate ..." src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Northern_blot_diagram.png/320px-Northern_blot_diagram.png" decoding="async" width="320" height="267" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Northern_blot_diagram.png/480px-Northern_blot_diagram.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Northern_blot_diagram.png/640px-Northern_blot_diagram.png 2x" data-file-width="1196" data-file-height="998" /></a>
</p>
<h4><span class="mw-headline" id="Multiline_text_causes_trouble">Multiline text causes trouble</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=66" title="Edit section: Multiline text causes trouble">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>For translations, try to keep the text on one line. Text that is broken into many lines is troublesome.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Electric_glow_discharge_schematic.png" class="image" title="PNG of glow discharge."><img alt="PNG of glow discharge." src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2b/Electric_glow_discharge_schematic.png/289px-Electric_glow_discharge_schematic.png" decoding="async" width="289" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2b/Electric_glow_discharge_schematic.png/434px-Electric_glow_discharge_schematic.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/2b/Electric_glow_discharge_schematic.png/578px-Electric_glow_discharge_schematic.png 2x" data-file-width="922" data-file-height="383" /></a></div></div>
			<div class="gallerytext">
<p>PNG of glow discharge.
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Electric_glow_discharge_schematic.svg" class="image" title="SVG of glow discharge."><img alt="SVG of glow discharge." src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Electric_glow_discharge_schematic.svg/302px-Electric_glow_discharge_schematic.svg.png" decoding="async" width="302" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Electric_glow_discharge_schematic.svg/453px-Electric_glow_discharge_schematic.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Electric_glow_discharge_schematic.svg/604px-Electric_glow_discharge_schematic.svg.png 2x" data-file-width="1321" data-file-height="525" /></a></div></div>
			<div class="gallerytext">
<p>SVG of glow discharge.
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Hair_follicle-en.svg" class="image" title="SVG (but Path text SVG problem now)"><img alt="SVG (but Path text SVG problem now)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Hair_follicle-en.svg/129px-Hair_follicle-en.svg.png" decoding="async" width="129" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Hair_follicle-en.svg/194px-Hair_follicle-en.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Hair_follicle-en.svg/259px-Hair_follicle-en.svg.png 2x" data-file-width="404" data-file-height="375" /></a></div></div>
			<div class="gallerytext">
<p>SVG (but Path text SVG problem now)
</p>
			</div>
		</div></li>
</ul>
<ul><li>Cathode</li>
<li>Aston Dark Space</li>
<li>Cathode Glow</li>
<li>Cathode Dark Space</li>
<li>Negative Glow</li>
<li>Faraday Space</li>
<li>Positive Column</li>
<li>Anode Glow</li>
<li>Anode Dark Space</li>
<li>Anode</li></ul>
<p>The diagram has unconventional leader lines.
The diagram has negative shading: the dark spaces are white; some glows are dark.
</p>
<h4><span class="mw-headline" id="Stepped_conversions">Stepped conversions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=67" title="Edit section: Stepped conversions">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Here are files that can be converted in steps. The first step would use an underlying bitmap file with overlaid SVG text elements. Later, the bitmap image could be converted to SVG.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:37px auto;"><a href="https://commons.wikimedia.org/wiki/File:Illu_epithelium.jpg" class="image" title="57&#160;kB"><img alt="57&#160;kB" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Illu_epithelium.jpg/440px-Illu_epithelium.jpg" decoding="async" width="440" height="176" srcset="https://upload.wikimedia.org/wikipedia/commons/8/8f/Illu_epithelium.jpg 1.5x" data-file-width="520" data-file-height="208" /></a></div></div>
			<div class="gallerytext">
<p>57&#160;kB
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Stem_cells_diagram.png" class="image" title="170&#160;kB"><img alt="170&#160;kB" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Stem_cells_diagram.png/241px-Stem_cells_diagram.png" decoding="async" width="241" height="220" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Stem_cells_diagram.png/361px-Stem_cells_diagram.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Stem_cells_diagram.png/482px-Stem_cells_diagram.png 2x" data-file-width="1015" data-file-height="927" /></a></div></div>
			<div class="gallerytext">
<p>170&#160;kB
</p>
			</div>
		</div></li>
</ul>
<h4><span class="mw-headline" id="A_stepped_conversion_with_difficult_image">A stepped conversion with difficult image</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=68" title="Edit section: A stepped conversion with difficult image">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Here's a file that has conversion problems and can be converted in steps.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Blausen_0316_DigestiveSystem.png" class="image" title="PNG with text"><img alt="PNG with text" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/14/Blausen_0316_DigestiveSystem.png/440px-Blausen_0316_DigestiveSystem.png" decoding="async" width="440" height="440" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/14/Blausen_0316_DigestiveSystem.png/660px-Blausen_0316_DigestiveSystem.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/14/Blausen_0316_DigestiveSystem.png/880px-Blausen_0316_DigestiveSystem.png 2x" data-file-width="1600" data-file-height="1600" /></a></div></div>
			<div class="gallerytext">
<p>PNG with text
</p>
			</div>
		</div></li>
</ul>
<p>For the first step, the PNG can be edited to remove the text and leader lines. That PNG can be inserted into an SVG file, and the text and leader lines can be redrawn using SVG primitives. Removing the text is usually simple, but removing the leader lines can be tricky. In some cases, the leader lines can be retained. In either case, the leader lines pose a problem with text alignment. The current layout requires the text to fit the space between the margin and the start of the leader line. That strategy works for PNG files, but it has problems with SVG because font metrics may change slightly. A substituted font with slightly different metrics may not fit between the margins and the leader lines. One fix would be to add a background filter to the text; it would overwrite the leader line with white (see <code>filter</code> below). Alternatively (and probably better) would be to right align the lefthand text and left align the righthand text. Another text fitting problem is the title: it runs from the left margin to the right margin. A slightly wider font would go outside both margins.
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;textflood&quot;</span> <span class="na">filterUnits=</span><span class="s">&quot;objectBoundingBox&quot;</span> <span class="na">primitiveUnits=</span><span class="s">&quot;objectBoundingBox&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;feFlood</span> <span class="na">flood-color=</span><span class="s">&quot;white&quot;</span> <span class="na">flood-opacity=</span><span class="s">&quot;1.0&quot;</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">height=</span><span class="s">&quot;1.0&quot;</span> <span class="na">result=</span><span class="s">&quot;back&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;feMerge&gt;</span>
        <span class="nt">&lt;feMergeNode</span> <span class="na">in=</span><span class="s">&quot;back&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;feMergeNode</span> <span class="na">in=</span><span class="s">&quot;SourceGraphic&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/feMerge&gt;</span>
<span class="nt">&lt;/filter&gt;</span>
</pre></div></dd></dl>
<p>For the second step, the body image could be redone as SVG. Completely converting the image to SVG is hard because the image has gradient fills; a raster-to-vector conversion application will probably not have a good result. Rendering the intestines looks difficult, too. There are many twists and turns, so shading is difficult. Perhaps a good place for <code>filter</code> primitives.
</p><p><br />
A simpler target is the following image.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:29.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Anatomy_Abdomen_Tiesworks.jpg" class="image" title="simpler target"><img alt="simpler target" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/Anatomy_Abdomen_Tiesworks.jpg/440px-Anatomy_Abdomen_Tiesworks.jpg" decoding="async" width="440" height="411" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/Anatomy_Abdomen_Tiesworks.jpg/660px-Anatomy_Abdomen_Tiesworks.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/1/15/Anatomy_Abdomen_Tiesworks.jpg 2x" data-file-width="823" data-file-height="768" /></a></div></div>
			<div class="gallerytext">
<p>simpler target
</p>
			</div>
		</div></li>
</ul>
<h4><span class="mw-headline" id="Significant_detail">Significant detail</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=69" title="Edit section: Significant detail">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:81.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Wilson1900Fig2.jpg" class="image" title="2.04 MB JPEG"><img alt="2.04 MB JPEG" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/Wilson1900Fig2.jpg/440px-Wilson1900Fig2.jpg" decoding="async" width="440" height="307" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/Wilson1900Fig2.jpg/660px-Wilson1900Fig2.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/Wilson1900Fig2.jpg/880px-Wilson1900Fig2.jpg 2x" data-file-width="2211" data-file-height="1545" /></a></div></div>
			<div class="gallerytext">
<p>2.04 MB JPEG
</p>
			</div>
		</div></li>
</ul>
<h4><span class="mw-headline" id="Trees_have_significant_detail">Trees have significant detail</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=70" title="Edit section: Trees have significant detail">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Here, the JPEG image is much higher quality than the SVG. Both files are about the same size.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Arms_of_the_House_of_Fisichella_(2016).jpg" class="image" title="JPEG 1,279 × 1,605; 489 KB"><img alt="JPEG 1,279 × 1,605; 489 KB" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Arms_of_the_House_of_Fisichella_(2016).jpg/351px-Arms_of_the_House_of_Fisichella_(2016).jpg" decoding="async" width="351" height="440" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Arms_of_the_House_of_Fisichella_%282016%29.jpg/526px-Arms_of_the_House_of_Fisichella_%282016%29.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Arms_of_the_House_of_Fisichella_%282016%29.jpg/701px-Arms_of_the_House_of_Fisichella_%282016%29.jpg 2x" data-file-width="1279" data-file-height="1605" /></a></div></div>
			<div class="gallerytext">
<p>JPEG 1,279 × 1,605; 489 KB
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Arms_of_the_House_of_Fisichella.svg" class="image" title="SVG 512 × 685; 552 KB"><img alt="SVG 512 × 685; 552 KB" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e3/Arms_of_the_House_of_Fisichella.svg/329px-Arms_of_the_House_of_Fisichella.svg.png" decoding="async" width="329" height="440" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e3/Arms_of_the_House_of_Fisichella.svg/493px-Arms_of_the_House_of_Fisichella.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/e/e3/Arms_of_the_House_of_Fisichella.svg/658px-Arms_of_the_House_of_Fisichella.svg.png 2x" data-file-width="512" data-file-height="685" /></a></div></div>
			<div class="gallerytext">
<p>SVG 512 × 685; 552 KB
</p>
			</div>
		</div></li>
</ul>
<h4><span class="mw-headline" id="Even_synthetic_images_can_have_significant_detail">Even synthetic images can have significant detail</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=71" title="Edit section: Even synthetic images can have significant detail">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The JPEG image has more character than the SVG. The files have similar size.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Coral_polyp.jpg" class="image" title="JPEG 123&#160;kB"><img alt="JPEG 123&#160;kB" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Coral_polyp.jpg/303px-Coral_polyp.jpg" decoding="async" width="303" height="440" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Coral_polyp.jpg/455px-Coral_polyp.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/4/49/Coral_polyp.jpg 2x" data-file-width="462" data-file-height="670" /></a></div></div>
			<div class="gallerytext">
<p>JPEG 123&#160;kB
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 475px"><div style="width: 475px">
			<div class="thumb" style="width: 470px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Coral_polyp_en.svg" class="image" title="SVG 95&#160;kB"><img alt="SVG 95&#160;kB" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Coral_polyp_en.svg/311px-Coral_polyp_en.svg.png" decoding="async" width="311" height="440" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Coral_polyp_en.svg/467px-Coral_polyp_en.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Coral_polyp_en.svg/622px-Coral_polyp_en.svg.png 2x" data-file-width="2480" data-file-height="3507" /></a></div></div>
			<div class="gallerytext">
<p>SVG 95&#160;kB
</p>
			</div>
		</div></li>
</ul>
<h3><span class="mw-headline" id="Stamps">Stamps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=72" title="Edit section: Stamps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Originally, I thought some files were bitmaps, but now it looks like something much stranger happened. The original artist made an SVG with Inkscape and used an appropriate filter, but somehow the SVG file bloated out of control. Why?
</p><p>See <a href="https://commons.wikimedia.org/wiki/Category:Powered_by_Wikidata" title="Category:Powered by Wikidata">Category:Powered by Wikidata</a>.
</p>
<h4><span class="mw-headline" id="Rectangular_stamp">Rectangular stamp</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=73" title="Edit section: Rectangular stamp">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Font family is "Sans", but the SVG text was converted to curves. There are many instances of filters, and those instances include "Rubber Stamp" and "Chalk and Sponge". The <code>defs</code> section is huge, and it has several huge clipping paths. However, only one clipping path is used. The wiki barcode does not use a clipping path, so it is drawn without special effects.
</p><p>The SVG files have neutered <code>flowRoot</code> elements.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 355px"><div style="width: 355px">
			<div class="thumb" style="width: 350px;"><div style="margin:51.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Wikidata_Stamp_Rec_Light.svg" class="image" title="SVG 2 May 2016 (5.1&#160;MB)"><img alt="SVG 2 May 2016 (5.1&#160;MB)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Wikidata_Stamp_Rec_Light.svg/320px-Wikidata_Stamp_Rec_Light.svg.png" decoding="async" width="320" height="87" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Wikidata_Stamp_Rec_Light.svg/480px-Wikidata_Stamp_Rec_Light.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Wikidata_Stamp_Rec_Light.svg/640px-Wikidata_Stamp_Rec_Light.svg.png 2x" data-file-width="842" data-file-height="230" /></a></div></div>
			<div class="gallerytext">
<p>SVG 2 May 2016 (5.1&#160;MB)
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 355px"><div style="width: 355px">
			<div class="thumb" style="width: 350px;"><div style="margin:51.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Wikidata_stamp_rec_light.png" class="image" title="PNG 2 May 2016 (25&#160;kB)"><img alt="PNG 2 May 2016 (25&#160;kB)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/Wikidata_stamp_rec_light.png/320px-Wikidata_stamp_rec_light.png" decoding="async" width="320" height="87" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/Wikidata_stamp_rec_light.png/480px-Wikidata_stamp_rec_light.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/Wikidata_stamp_rec_light.png/640px-Wikidata_stamp_rec_light.png 2x" data-file-width="842" data-file-height="230" /></a></div></div>
			<div class="gallerytext">
<p>PNG 2 May 2016 (25&#160;kB)
</p>
			</div>
		</div></li>
</ul>
<p>This SVG file uses the "Gill Sans" font.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 355px"><div style="width: 355px">
			<div class="thumb" style="width: 350px;"><div style="margin:51.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Wikidata_Stamp_Rec_Dark.svg" class="image" title="SVG 2 May 2016 (5.4&#160;MB)"><img alt="SVG 2 May 2016 (5.4&#160;MB)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Wikidata_Stamp_Rec_Dark.svg/320px-Wikidata_Stamp_Rec_Dark.svg.png" decoding="async" width="320" height="87" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Wikidata_Stamp_Rec_Dark.svg/480px-Wikidata_Stamp_Rec_Dark.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Wikidata_Stamp_Rec_Dark.svg/640px-Wikidata_Stamp_Rec_Dark.svg.png 2x" data-file-width="842" data-file-height="230" /></a></div></div>
			<div class="gallerytext">
<p>SVG 2 May 2016 (5.4&#160;MB)
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 355px"><div style="width: 355px">
			<div class="thumb" style="width: 350px;"><div style="margin:51.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Wikidata_stamp_rec.png" class="image" title="PNG 2 May 2016 (46&#160;kB)"><img alt="PNG 2 May 2016 (46&#160;kB)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Wikidata_stamp_rec.png/320px-Wikidata_stamp_rec.png" decoding="async" width="320" height="87" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Wikidata_stamp_rec.png/480px-Wikidata_stamp_rec.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Wikidata_stamp_rec.png/640px-Wikidata_stamp_rec.png 2x" data-file-width="842" data-file-height="230" /></a></div></div>
			<div class="gallerytext">
<p>PNG 2 May 2016 (46&#160;kB)
</p>
			</div>
		</div></li>
</ul>
<h4><span class="mw-headline" id="Round_stamp">Round stamp</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=74" title="Edit section: Round stamp">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 355px"><div style="width: 355px">
			<div class="thumb" style="width: 350px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Wikidata_Stamp_Round_Light.svg" class="image" title="Wikidata stamp SVG (2.2&#160;MB)"><img alt="Wikidata stamp SVG (2.2&#160;MB)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f1/Wikidata_Stamp_Round_Light.svg/320px-Wikidata_Stamp_Round_Light.svg.png" decoding="async" width="320" height="320" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f1/Wikidata_Stamp_Round_Light.svg/480px-Wikidata_Stamp_Round_Light.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/f1/Wikidata_Stamp_Round_Light.svg/640px-Wikidata_Stamp_Round_Light.svg.png 2x" data-file-width="1445" data-file-height="1445" /></a></div></div>
			<div class="gallerytext">
<p>Wikidata stamp SVG (2.2&#160;MB)
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 355px"><div style="width: 355px">
			<div class="thumb" style="width: 350px;"><div style="margin:41.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Wikidata_stamp.png" class="image" title="Wikidata stamp PNG (78&#160;kB)"><img alt="Wikidata stamp PNG (78&#160;kB)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Wikidata_stamp.png/320px-Wikidata_stamp.png" decoding="async" width="320" height="267" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Wikidata_stamp.png/480px-Wikidata_stamp.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Wikidata_stamp.png/640px-Wikidata_stamp.png 2x" data-file-width="1061" data-file-height="886" /></a></div></div>
			<div class="gallerytext">
<p>Wikidata stamp PNG (78&#160;kB)
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 355px"><div style="width: 355px">
			<div class="thumb" style="width: 350px;"><div style="margin:42.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Wikidata_stamp.svg" class="image" title="Using random process, but has librsvg bugs. (3&#160;kB)"><img alt="Using random process, but has librsvg bugs. (3&#160;kB)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/Wikidata_stamp.svg/320px-Wikidata_stamp.svg.png" decoding="async" width="320" height="265" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/Wikidata_stamp.svg/480px-Wikidata_stamp.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/Wikidata_stamp.svg/640px-Wikidata_stamp.svg.png 2x" data-file-width="512" data-file-height="424" /></a></div></div>
			<div class="gallerytext">
<p>Using random process, but has <code>librsvg</code> bugs. (3&#160;kB)
</p>
			</div>
		</div></li>
</ul>
<p>The stamp runs into <code>librsvg</code> inability to do <code>textPath</code>.
It is a lot of bytes for a simple image; individual debris has a lot of information.
There is debris even in the unstamped areas.
Some of the debris is black.
Most of the debris is polygonal.
The WIKIDATA rectangle is filled, so not all of the apparent background is transparent; clipping would be appropriate.
</p><p>Redid as an SVG with a random process <code>filter</code>.
</p>
<h3><span class="mw-headline" id="Vectorization">Vectorization</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=75" title="Edit section: Vectorization">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:Xilografia_canto_4.png" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Xilografia_canto_4.png/220px-Xilografia_canto_4.png" decoding="async" width="220" height="39" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Xilografia_canto_4.png/330px-Xilografia_canto_4.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Xilografia_canto_4.png/440px-Xilografia_canto_4.png 2x" data-file-width="2561" data-file-height="450" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:Xilografia_canto_4.png" class="internal" title="Enlarge"></a></div>Find mirrored or rotated components of an image</div></div></div>
<p>How good can automatic vectorization be?
</p>
<h3><span class="mw-headline" id="Recovering_text">Recovering text</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=76" title="Edit section: Recovering text">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Files on Commons can be OCR'd (produces JSON with a <code>text</code> key with lines of OCR/d text):
</p>
<dl><dt>English</dt>
<dd><a class="external text" href="https://tools.wmflabs.org/ws-google-ocr/api.php?image=https://upload.wikimedia.org/wikipedia/commons/3/3b/Arm_Bones.png&amp;lang=en">Arm Bones.png</a></dd>
<dt>Polish</dt>
<dd><a class="external text" href="https://tools.wmflabs.org/ws-google-ocr/api.php?image=https://upload.wikimedia.org/wikipedia/commons/a/a5/Tulejki_zaciskowe.svg&amp;lang=pl">Tulejki zaciskowe.svg</a></dd>
<dt>Chinese</dt>
<dd><a class="external text" href="https://tools.wmflabs.org/ws-google-ocr/api.php?image=https://upload.wikimedia.org/wikipedia/commons/8/87/%28zh%29Illu_epithelium.jpg&amp;lang=zh">(zh)Illu epithelium.jpg</a></dd></dl>
<p>SVG extensions do not work with the above pattern. Need to use PNG rather than SVG. That can be achieved by supplying a thumbnail_size argument
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Tulejki_zaciskowe.svg" title="File:Tulejki zaciskowe.svg">File:Tulejki zaciskowe.svg</a></li>
<li><code>{{filepath:Tulejki zaciskowe.svg}}</code> &#8594;
<dl><dd><a class="external free" href="https://upload.wikimedia.org/wikipedia/commons/a/a5/Tulejki_zaciskowe.svg">https://upload.wikimedia.org/wikipedia/commons/a/a5/Tulejki_zaciskowe.svg</a></dd></dl></li>
<li><code>{{filepath:Tulejki zaciskowe.svg|887}}</code> &#8594;
<dl><dd><a class="external free" href="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Tulejki_zaciskowe.svg/887px-Tulejki_zaciskowe.svg.png">https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Tulejki_zaciskowe.svg/887px-Tulejki_zaciskowe.svg.png</a></dd></dl></li></ul>
<dl><dt>Polish</dt>
<dd><a class="external text" href="https://tools.wmflabs.org/ws-google-ocr/api.php?image=https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Tulejki_zaciskowe.svg/887px-Tulejki_zaciskowe.svg.png&amp;lang=pl">Tulejki zaciskowe.svg</a> &#8594;</dd></dl>
<ul><li><a rel="nofollow" class="external free" href="https://ocr.wmcloud.org/api.php?engine=google&amp;image=https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Tulejki_zaciskowe.svg/887px-Tulejki_zaciskowe.svg.png&amp;lang=pl">https://ocr.wmcloud.org/api.php?engine=google&amp;image=https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Tulejki_zaciskowe.svg/887px-Tulejki_zaciskowe.svg.png&amp;lang=pl</a> &#8594;</li></ul>
<div class="mw-highlight mw-highlight-lang-json mw-content-ltr" dir="ltr"><pre><span></span><span class="p">{</span><span class="nt">&quot;engine&quot;</span><span class="p">:</span><span class="s2">&quot;google&quot;</span><span class="p">,</span><span class="nt">&quot;langs&quot;</span><span class="p">:[</span><span class="s2">&quot;pl&quot;</span><span class="p">],</span><span class="nt">&quot;psm&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="nt">&quot;crop&quot;</span><span class="p">:[],</span><span class="nt">&quot;image_hosts&quot;</span><span class="p">:[</span><span class="s2">&quot;upload.wikimedia.org&quot;</span><span class="p">,</span><span class="s2">&quot;upload.wikimedia.beta.wmflabs.org&quot;</span><span class="p">],</span><span class="nt">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;Typ \u015bci\u0105gaj\u0105cy\nTyp naciskaj\u0105cy\nTyp obustronny&quot;</span><span class="p">}</span>
</pre></div>
<p>So the Polish text is
</p>
<ul><li>Typ &#x15b;ci&#x105;gaj&#x105;cy &#8594; pull-back type; pull-to-close</li>
<li>Typ naciskaj&#x105;cy &#8594; push type; push-to-close</li>
<li>Typ obustronny &#8594; dead-length type</li></ul>
<p>Can I just go to <a rel="nofollow" class="external free" href="https://ocr.wmcloud.org/api.php">https://ocr.wmcloud.org/api.php</a> directly?
</p><p>Would some JavaScript run into CORS? Will <code>origin=*</code> work? The simple return has
</p>
<ul><li><code>access-control-allow-origin: *</code></li></ul>
<p>so it should work without problems.
</p><p>See <a rel="nofollow" class="external free" href="https://ocr.wmcloud.org/">https://ocr.wmcloud.org/</a> for direct interface and api documentation.
</p><p>There are tools for identifying fonts.
</p>
<ul><li><a rel="nofollow" class="external text" href="https://www.motocms.com/blog/en/online-font-recognition/">Online Font Recognition Tools</a>. Allison Reed. 20 March 2021.</li></ul>
<h2><span class="mw-headline" id="Translations:_internationalization_and_localization">Translations: internationalization and localization</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=77" title="Edit section: Translations: internationalization and localization">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Commons supports wikis in many different languages. Ideally, an image would be available in any language, but the reality is many images on Commons are just available in English. Images in a bitmap format such as PNG have painted in the text, so the text is not easy to change.
</p><p>SVG can support translations.
</p><p>Sadly, SVG has made some unusual choices. The <code>class</code> attribute is a space-separated list of tokens, but the <code>systemLanguage</code> attribute is a comma-separated list of tokens. The commas added confusion (some implementations used space-separated IETF language tags) and complicate pattern matching. Compare CSS <code>[systemLanguage~="en"]</code> (which wants a space-separated list) and <code>[systemLanguage|="en"]]</code> (which does not want a list).
</p>
<h3><span id="Translations_are_welcome.2C_but_they_have_costs"></span><span class="mw-headline" id="Translations_are_welcome,_but_they_have_costs">Translations are welcome, but they have costs</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=78" title="Edit section: Translations are welcome, but they have costs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There are important diagrams that have many translations.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Bicycle_diagram-en.svg" title="File:Bicycle diagram-en.svg">File:Bicycle diagram-en.svg</a> This SVG file was a significant example of a file having multiple translated copies. In January 2022, <a href="https://commons.wikimedia.org/wiki/User:Mrmw" title="User:Mrmw">Mrmw</a> made this file multilingual. Two additional translations were added the next day.</li>
<li><a href="https://commons.wikimedia.org/wiki/File:Diagram_of_the_human_heart_(cropped).svg" title="File:Diagram of the human heart (cropped).svg">File:Diagram of the human heart (cropped).svg</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Standard_Model_of_Elementary_Particles.svg" title="File:Standard Model of Elementary Particles.svg">File:Standard Model of Elementary Particles.svg</a></li></ul>
<h3><span class="mw-headline" id="The_translations_do_not_fit">The translations do not fit</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=79" title="Edit section: The translations do not fit">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>(Should follow multiline text.)
</p>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:SVG_Test_dim_filter_mask.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b4/SVG_Test_dim_filter_mask.svg/220px-SVG_Test_dim_filter_mask.svg.png" decoding="async" width="220" height="151" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b4/SVG_Test_dim_filter_mask.svg/330px-SVG_Test_dim_filter_mask.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/b/b4/SVG_Test_dim_filter_mask.svg/440px-SVG_Test_dim_filter_mask.svg.png 2x" data-file-width="512" data-file-height="352" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:SVG_Test_dim_filter_mask.svg" class="internal" title="Enlarge"></a></div>Methods for variable-width dimension lines.</div></div></div>
<p>Some languages do not need much space, but other languages do. As a guess, I would say Spanish needs 30% more space than English. Chinese is very dense, but the characters are more detailed and should be larger. Diagrams meant for translation need to leave a lot of space.
</p><p>I've seen some users add translations to similar languages. Instead of adding Catalan to an English SVG, add the language to the Spanish SVG.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Oceanic_divisions_es.svg" title="File:Oceanic divisions es.svg">File:Oceanic divisions es.svg</a> Spanish + Catalan</li></ul>
<p>Dimension lines cause problems. They set a particular width for the text. Putting the text above the dimension lines is a simple approach. Another way around the problem is to paint a text background that overlays the dimension line. In many cases the background merges with the background of the diagram, but sometimes it will cover nearby details in the diagram. Painting a background is difficult when the background has a color gradient; it requires a good match. Use a mask. Use a Gaussian blur filter on the background?
</p><p>Methods ran into <a href="https://phabricator.wikimedia.org/T316962" class="extiw" title="phab:T316962">Phab:T316962</a>. Sadly, <code>FillPaint</code> does not work for gradient fills on Commons or Chromium.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Oceanic_divisions.svg" title="File:Oceanic divisions.svg">File:Oceanic divisions.svg</a>
<dl><dd>fix dimension line issue.</dd>
<dd>better align some labels. <img alt="Yellow check.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Yellow_check.svg/15px-Yellow_check.svg.png" decoding="async" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Yellow_check.svg/23px-Yellow_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Yellow_check.svg/30px-Yellow_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Half done</bdi></b></dd>
<dd>also fix fonts and marker arrows. <img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b></dd>
<dd>reposition some text for better translation. <img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b></dd></dl></li></ul>
<h3><span class="mw-headline" id="MediaWiki_problems_2">MediaWiki problems</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=80" title="Edit section: MediaWiki problems">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="tracked plainlinks mw-trackedTemplate"><style data-mw-deduplicate="TemplateStyles:r649510686">.mw-parser-output .tracked{float:right;clear:right;border:1px solid #999;border-radius:2px;background-color:#eee;font-size:85%;text-align:center;padding:0.5em;margin-left:1em;margin-bottom:1em;width:12em;color:black}.mw-parser-output .tracked p{margin:0}.mw-parser-output .tracked-url{font-weight:bold}.mw-parser-output .tracked .status,.mw-parser-output .tracked-status{font-weight:bold;text-transform:uppercase}.mw-parser-output .tracked .status.resolved,.mw-parser-output .tracked-resolved{color:green}.mw-parser-output .tracked .status.critical,.mw-parser-output .tracked-critical{color:red;font-size:1.5em}</style>Tracked in <a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Phabricator" class="extiw" title="mw:Special:MyLanguage/Phabricator">Phabricator</a><br /><b><a href="https://phabricator.wikimedia.org/T309426" class="extiw" title="phabricator:T309426"><span class="tracked-url trakfab-T309426">Task T309426</span></a></b><br /><span class="status resolved">Resolved</span></div>
<p>I'm seeing some multilingual files that MediaWiki does not offer to show in various languages ("Render this image in ..."). I've come across a couple in the last month, and they are not the 256&#160;kB case. Possibly newer page builder? Also may be one explicit langtag and a default.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Celltypes.svg" title="File:Celltypes.svg">File:Celltypes.svg</a> (99 kB) this has many languages... (later note: no <code>systemLanguage="en"</code>)</li>
<li><a href="https://commons.wikimedia.org/wiki/File:1263_Mediterranean_Sea-es.svg" title="File:1263 Mediterranean Sea-es.svg">File:1263 Mediterranean Sea-es.svg</a> should have <code>es</code> and <code>eu</code> translations. (later note: no <code>systemLanguage="en"</code>)</li>
<li><a href="https://commons.wikimedia.org/wiki/File:Minsk_Protocol.svg" title="File:Minsk Protocol.svg">File:Minsk Protocol.svg</a> (later note: only has <code>systemLanguage="eu"</code>)</li>
<li><a href="https://commons.wikimedia.org/wiki/File:Eukaryotic_DNA_replication.svg" title="File:Eukaryotic DNA replication.svg">File:Eukaryotic DNA replication.svg</a> (later note: only has <code>systemLanguag="fr"</code>)</li></ul>
<p>Maybe this is a clue. Go to
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:2022_Russian_invasion_of_Ukraine.svg" title="File:2022 Russian invasion of Ukraine.svg">File:2022 Russian invasion of Ukraine.svg</a> or</li>
<li><a class="external free" href="https://commons.wikimedia.org/w/index.php?lang=en&amp;title=File%3A2022_Russian_invasion_of_Ukraine.svg">https://commons.wikimedia.org/w/index.php?lang=en&amp;title=File%3A2022_Russian_invasion_of_Ukraine.svg</a></li></ul>
<p>and it will display the language drop down box. Now click on the "(default language)" option and GO. The language dropdown box disappears.
</p><p>That is the same as going to
</p>
<ul><li><a class="external free" href="https://commons.wikimedia.org/w/index.php?lang=und&amp;title=File%3A2022_Russian_invasion_of_Ukraine.svg">https://commons.wikimedia.org/w/index.php?lang=und&amp;title=File%3A2022_Russian_invasion_of_Ukraine.svg</a></li></ul>
<p>Alternatively, go to the Klingon version, which does not have a render this image in (language) selector:
</p>
<ul><li><a class="external free" href="https://commons.wikimedia.org/w/index.php?lang=tlh&amp;title=File%3A2022_Russian_invasion_of_Ukraine.svg">https://commons.wikimedia.org/w/index.php?lang=tlh&amp;title=File%3A2022_Russian_invasion_of_Ukraine.svg</a></li></ul>
<p>So somebody creates a diagram in English on Commons. Somebody then applies SVG Translate to add a language such as French. SVG translate does not do the triple clause thing; instead it just adds "fr" clauses and keeps the default. The Commons file page will not display the potential languages. SVG Translate should ask for the default language (or use the <code>lang=</code> or <code>xml:lang=</code> attributes if available.
</p>
<h3><span class="mw-headline" id="MediaWiki_language_matching">MediaWiki language matching</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=81" title="Edit section: MediaWiki language matching">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="tracked plainlinks mw-trackedTemplate"><link rel="mw-deduplicated-inline-style" href="https://commons.wikimedia.org/wiki/mw-data:TemplateStyles:r649510686"/>Tracked in <a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Phabricator" class="extiw" title="mw:Special:MyLanguage/Phabricator">Phabricator</a><br /><b><a href="https://phabricator.wikimedia.org/T311965" class="extiw" title="phabricator:T311965"><span class="tracked-url trakfab-T311965">Task T311965</span></a></b><br /><span class="status"></span></div>
<p><a href="https://phabricator.wikimedia.org/T311965" class="extiw" title="phab:T311965">Phab:T311965</a> <cite>MediaWiki mishandles hyphenated language tags in SVG files.</cite>
</p>
<h3><span class="mw-headline" id="MediaWiki_language_default">MediaWiki language default</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=82" title="Edit section: MediaWiki language default">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>MediaWiki defaults the language to <code>en</code>. It should remove that English bias. If a German editor creates an image that is used on several wikis, then the default display should be the German text.
</p><p>So default the display to <code>und</code>.
</p><p>That is a breaking change. We should scan existing SVG to discover those that have <code>switch</code> elements without default clauses.
</p>
<h3><span class="mw-headline" id="MediaWiki_language_advertisements">MediaWiki language advertisements</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=83" title="Edit section: MediaWiki language advertisements">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Say a file is used on langtag.Wiki but does not have a langtag translation. In that case, the SVG file might have a link to SVG Translate. Alternatively, MW might notice that a file is <code>switch</code> translated but the file does not have the desired language. Then it could insert not only the <code>img</code> tag but also a link to translate the file. It could use the wiki symbol for translate: <a href="https://commons.wikimedia.org/wiki/File:Translate_(CoreUI_Icons_v1.0.0).svg" title="File:Translate (CoreUI Icons v1.0.0).svg">File:Translate (CoreUI Icons v1.0.0).svg</a> &#8212; except it has a CC-BY 4.0 requirement so putting it in the SVG file would be cumbersome.
</p><p>The information section of a file page often lists other versions of a file. A file may, for example, have PNG and SVG versions. There may also be different language versions.
</p><p>A template is often used to keep the other-versions information up-to-date on the different file pages. For example, <a href="https://commons.wikimedia.org/wiki/Template:Other_versions/War_in_Ukraine_(2022)" title="Template:Other versions/War in Ukraine (2022)"><span style="font-family:monospace,monospace;">&#123;&#123;Other versions/War in Ukraine (2022)&#125;&#125;</span></a> is transcluded on many file pages. The template usually consists of an image gallery that lists each file with a comment. 
</p><p>For translations, the comment often identifies the language. That raises the question of how to identify the language.
</p>
<ol><li>Using English words such as French, Russian, or Japanese. This approach only works for English readers and does little for other languages.</li>
<li>Using langtag such as fr, ru, or ja. This approach is too cryptic for most users; they would not know what the strings mean.</li>
<li>Using MW <code>{{#language: fr}}</code> to obtain the language in its representation. Anyone visiting the file page would see français, русский, 日本語. That makes it easy for native users to recognize their language, but the most users would have trouble recognizing all the languages. A user seeing lietuvių may not know that means Lithuanian.</li>
<li>Using <code>{{language|fr}}</code> to obtain the language in the MW page's language. The English version of the file page would show French, Russian, Japanese. The German version of the file page would show Französisch, Russisch, Japanisch. The translations depend upon the file page's <code>uselang</code> URL parameter.</li></ol>
<p>Methods 3 and 4 are the better approaches. I previously used method 3, but now I think method 4 is better.
</p><p>The advent of multilingual SVG files raised an issue of how they should be represented in gallery. Should there be one file that lists all the languages that it supports, or should the file be repeated for each language?
</p><p>I prefer the former. The gallery is usually so small that the translations do not show up. Painting essentially the same file 15 times on the file page seems wasteful. It is very repetitive for files such as <a href="https://commons.wikimedia.org/wiki/File:Map_of_USA_with_state_names.svg" title="File:Map of USA with state names.svg">File:Map of USA with state names.svg</a>, a multilingual map with 150 languages.
</p><p>Clicking on the image or a link. Should it select the render this image in language?
</p><p>The language gallery templates.
More to say. <a href="https://commons.wikimedia.org/wiki/Template:Svg_lang" title="Template:Svg lang"><span style="font-family:monospace,monospace;">&#123;&#123;Svg lang&#125;&#125;</span></a>, <a href="https://commons.wikimedia.org/wiki/Template:Lang_gallery" title="Template:Lang gallery"><span style="font-family:monospace,monospace;">&#123;&#123;Lang gallery&#125;&#125;</span></a>, and <a href="https://commons.wikimedia.org/wiki/Template:Lgallery" title="Template:Lgallery"><span style="font-family:monospace,monospace;">&#123;&#123;Lgallery&#125;&#125;</span></a>.
</p><p><a href="https://commons.wikimedia.org/wiki/Template:Lgallery" title="Template:Lgallery"><span style="font-family:monospace,monospace;">&#123;&#123;Lgallery&#125;&#125;</span></a> supports <a href="https://commons.wikimedia.org/wiki/Category:Switch-controlled_SVG" title="Category:Switch-controlled SVG">Category:Switch-controlled SVG</a> which exploits <code>systemLanguage</code> that browsers will not understand.
</p><p>Switch translated files already have a general request to add translations. How about attracting translators for a specific language? Say XYZ.svg is an image used on the abc.Wiki but does not have an abc translation. How can we seek translators for the image?
</p>
<ul><li>Embed a translation request in the SVG image. That would pollute the image.</li>
<li>Add the image to a (possibly hidden) category of SVG images needing translation to language abc.</li></ul>
<p>For the latter, make a <a href="https://commons.wikimedia.org/w/index.php?title=Template:Translation_request&amp;action=edit&amp;redlink=1" class="new" title="Template:Translation request (page does not exist)"><span style="font-family:monospace,monospace;">&#123;&#123;Translation request&#125;&#125;</span></a> template. Add the template to the File: page with the langtag <code>abc</code>. The template can link to <code>https:svgtranslate.toolforge.org/<i>BASEPAGE</i></code>. The template can also add the File: page to the <code>Category:Translation requests abc</code>.
</p>
<dl><dd><small>Does SVG Translate have URL parameters to specify the source and target languages?</small></dd>
<dd><a rel="nofollow" class="external text" href="https://github.com/wikimedia/svgtranslate">github repo</a></dd></dl>
<p>A wiki could encourage its users to go to the appropriate category page. Or there could be a translate a random page.
</p><p><a href="https://commons.wikimedia.org/wiki/User:Incnis_Mrsi" title="User:Incnis Mrsi">Incnis Mrsi</a> wrote <a href="https://commons.wikimedia.org/wiki/Template:Translate_SVG" title="Template:Translate SVG"><span style="font-family:monospace,monospace;">&#123;&#123;Translate SVG&#125;&#125;</span></a> to mark an SVG file for translation to a particular language. It is not specific to <code>switch</code> translations. It adds files to Category:SVG images to be translated to XXX.
</p>
<dl><dd>includeonly Category: SVG images to be translated to language(langcode) /includeonly</dd></dl>
<p><a href="https://commons.wikimedia.org/wiki/Template:Language" title="Template:Language"><span style="font-family:monospace,monospace;">&#123;&#123;Language&#125;&#125;</span></a> has a second argument of <link rel="mw-deduplicated-inline-style" href="https://commons.wikimedia.org/wiki/mw-data:TemplateStyles:r588530194"/><code class="nowrap">&#124;2&#61;en</code> to canonize the language in English.
</p><p>Category:X does not display immediate text, so simply add the category to the template.
</p>
<h3><span class="mw-headline" id="How_MediaWiki_handles_images">How MediaWiki handles images</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=84" title="Edit section: How MediaWiki handles images">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>When MediaWiki builds a page, it makes HTML <code>img</code> elements that will display image.
</p><p>For a JPEG image:
</p>
<ul><li><code>src="<a class="external free" href="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/220px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg">https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/220px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg</a>"</code></li></ul>
<p>For an SVG image
</p>
<ul><li><code>src="<a class="external free" href="https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Gibraltar_map-en.svg/220px-Gibraltar_map-en.svg.png">https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Gibraltar_map-en.svg/220px-Gibraltar_map-en.svg.png</a>"</code></li></ul>
<p>The image URL pattern is [URL prefix]/H/HH/[filename]/[size]px-[filename][suffix]
</p><p>When my browser displays the page, it processes the <code>img</code> elements. The browser will use the <code>src</code> attribute to make an HTTP request for the image. First, the browser will look in the cache to see if it has a local copy. If that local copy exists and is current, then it will use the local copy. If the local copy exists but is stale, then it will make a network request asking the remote server whether the local copy is still current. If the local copy is still current, then the browser will use the local copy. If there is no local copy or that copy is no longer current, then the image will be transferred over the network.
</p><p>When the server gets an HTTP image request, it will look in its cache to see if it has that image ready to go. If it does, then it can answer the request from its cache. Otherwise, the server will pick apart the URL, process the request, store the result in its cache, and transfer the result over the network. (Processing the request might say the image is still current, or processing may involve scaling the image.)
</p><p>Real life is a bit more complicated. WMF's wikis are high-traffic websites, so just one server cannot do all the work. A connection to a wiki will go to one of many servers. That server may ask other WMF computers to do the work. The <code>/H/HH/</code> pattern in the image URL is from an MD5 hash code. It offers an easy method of load leveling work among up to 256 computers.
</p>
<h3><span class="mw-headline" id="MediaWiki_source_code">MediaWiki source code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=85" title="Edit section: MediaWiki source code">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li><a class="external free" href="https://doc.wikimedia.org/">https://doc.wikimedia.org/</a>
<ul><li><a class="external free" href="https://doc.wikimedia.org/mediawiki-core/master/php/group__Media.html">https://doc.wikimedia.org/mediawiki-core/master/php/group__Media.html</a>
<ul><li><a class="external free" href="https://doc.wikimedia.org/mediawiki-core/master/php/SvgHandler_8php.html">https://doc.wikimedia.org/mediawiki-core/master/php/SvgHandler_8php.html</a></li>
<li><a class="external free" href="https://doc.wikimedia.org/mediawiki-core/master/php/classSVGReader.html">https://doc.wikimedia.org/mediawiki-core/master/php/classSVGReader.html</a></li></ul></li></ul></li></ul>
<p>SvgReader has many uglies including the exponential language list. SvgHandler trims the list.
</p><p>SvgHander::normaliseParamsInternal() is where the lang param must be in the lang list.
</p><p>MediaWiki file page.
</p>
<ul><li><a class="external free" href="https://doc.wikimedia.org/mediawiki-core/master/php/classImagePage.html">https://doc.wikimedia.org/mediawiki-core/master/php/classImagePage.html</a></li></ul>
<p>MediaWiki compiling a page.
</p>
<ul><li><a class="external free" href="https://doc.wikimedia.org/mediawiki-core/master/php/classThumbnailImage.html">https://doc.wikimedia.org/mediawiki-core/master/php/classThumbnailImage.html</a></li></ul>
<p>MediaWiki serving an image. MediaHandler/ImageHandler/SvgHandler
</p>
<ul><li>SvgHandler::rasterize()</li></ul>
<p>Thumbor serving a page.
</p>
<ul><li><a href="https://phabricator.wikimedia.org/T40010" class="extiw" title="phab:T40010">Phab:T40010</a> RFC: Re-evaluate librsvg as SVG renderer on Wikimedia wikis</li>
<li><a href="https://phabricator.wikimedia.org/T261192" class="extiw" title="phab:T261192">Phab:T261192</a> Rendering multilingual (systemLanguage) SVG files fails locally after upgrading librsvg from 2.40.21 to 2.44.10
<ul><li><a class="external free" href="https://gerrit.wikimedia.org/r/plugins/gitiles/operations/software/thumbor-plugins/+/refs/heads/master/wikimedia_thumbor/engine/svg/svg.py">https://gerrit.wikimedia.org/r/plugins/gitiles/operations/software/thumbor-plugins/+/refs/heads/master/wikimedia_thumbor/engine/svg/svg.py</a></li></ul></li></ul>
<p>Thumbor 7 changed to Python 3, a breaking change:<sup id="cite_ref-19" class="reference"><a href="#cite_note-19">&#91;19&#93;</a></sup>
</p>
<blockquote><p>Release 7.0.0 introduces a major breaking change due to the migration to python 3 and the modernization of our codebase. Please read the release notes for details on how to upgrade.</p></blockquote>
<p>Gilles retires from WMF... <a rel="nofollow" class="external free" href="https://mobile.twitter.com/monsieurperf/status/1409444342352187400">https://mobile.twitter.com/monsieurperf/status/1409444342352187400</a>
</p>
<h3><span class="mw-headline" id="Language_variants">Language variants</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=86" title="Edit section: Language variants">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/w/index.php?title=File:First_Ionization_Energy.svg&amp;lang=tlh" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/First_Ionization_Energy.svg/langtlh-220px-First_Ionization_Energy.svg.png" decoding="async" width="220" height="88" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/First_Ionization_Energy.svg/langtlh-330px-First_Ionization_Energy.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/First_Ionization_Energy.svg/langtlh-440px-First_Ionization_Energy.svg.png 2x" data-file-width="512" data-file-height="205" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:First_Ionization_Energy.svg" class="internal" title="Enlarge"></a></div>Asking Klingon (tlh) &#8212; URL has <code>.../langtlh-220px-</code></div></div></div>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/w/index.php?title=File:First_Ionization_Energy.svg&amp;lang=en" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/First_Ionization_Energy.svg/220px-First_Ionization_Energy.svg.png" decoding="async" width="220" height="88" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/First_Ionization_Energy.svg/330px-First_Ionization_Energy.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/First_Ionization_Energy.svg/440px-First_Ionization_Energy.svg.png 2x" data-file-width="512" data-file-height="205" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:First_Ionization_Energy.svg" class="internal" title="Enlarge"></a></div>Asking English (en) &#8212; URL does not have <code>.../langen-220px-</code></div></div></div>
<p>It's been a long time, and I need to check these claims. I want to point to the code.
</p><p>Building a wiki page that contains an SVG file is a little more involved. There are circumstances where MediaWiki will include a language specifier in the image URL:
</p>
<ul><li>...[filename]/lang[language]-[size]px-[filename].png</li></ul>
<p>The language specifier is included if the wiki text has an explicit <link rel="mw-deduplicated-inline-style" href="https://commons.wikimedia.org/wiki/mw-data:TemplateStyles:r588530194"/><code class="nowrap">&#124;lang&#61;</code> parameter. That is the user making an explicit request, and that request is honored even if the SVG file does not have that language.
</p><p>On the English wikipedia, if there is no <link rel="mw-deduplicated-inline-style" href="https://commons.wikimedia.org/wiki/mw-data:TemplateStyles:r588530194"/><code class="nowrap">&#124;lang&#61;</code> parameter, then no language specifier is emitted. This practice is due to WMF servers defaulting the SVG language to generic English. That practice makes it difficult to ask for the SVG file's default language. To get the default clause, one must ask for a langtag that does not exist in the file (e.g., <code>tlh</code> Klingon). (Make a table showing the issue.)
</p><p>On other wikipedias, if there is no <link rel="mw-deduplicated-inline-style" href="https://commons.wikimedia.org/wiki/mw-data:TemplateStyles:r588530194"/><code class="nowrap">&#124;lang&#61;</code> parameter, there is an attempt to use that wikipedia's default language.
</p><p>MediaWiki checks the SVG file to see if it has any language dependencies. The check is simple, and the check can be fooled. Currently, it reads the first 256&#160;kB of the file looking for <code>systemLanguage</code> attributes. As it finds those attributes, it builds a list of languages the SVG file supports.
</p><p>If the wikipedia's default language is in that list, then MediaWiki emits a URL that requests that language.
</p><p>There is logic behind these choices. Most SVG files are not multilingual, and even if they are multilingual, they often do not support many languages. The goal is to avoid building language-specific URLs that do not affect the image. If an SVG file does not support Russian, then it does not make sense to scale and cache a Russian version of the SVG that looks exactly the same as the English version.
</p>
<h3><span class="mw-headline" id="Languages_and_fonts">Languages and fonts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=87" title="Edit section: Languages and fonts">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Unicode does not specify variants. (Well, it does sometimes. Normal "r" and rounded "ꝛ". Normal "d" and insular "ꝺ".<sup id="cite_ref-20" class="reference"><a href="#cite_note-20">&#91;20&#93;</a></sup>) For example, the Latin small letter a has two major variants: double-story <span style="font-family:serif">a</span> or single-story <span style="font-family:TW Cen MT, GillSans, Futura">a</span>. Chinese ideographs have similar variations, and some languages use specific variants. Chinese, Japanese, and Korean may draw the same ideograph differently. Unicode does not distinguish the character, so the font selection must make the change.
</p><p>CSS can select an appropriate font.
</p>
<div class="mw-highlight mw-highlight-lang-css mw-content-ltr" dir="ltr"><pre><span></span><span class="p">:</span><span class="nd">lang</span><span class="o">(</span><span class="nt">zh</span><span class="o">)</span> <span class="p">{</span><span class="k">font-family</span><span class="p">:</span> <span class="o">...</span><span class="p">;</span> <span class="p">}</span>
<span class="p">:</span><span class="nd">lang</span><span class="o">(</span><span class="nt">ja</span><span class="o">)</span> <span class="p">{</span><span class="k">font-family</span><span class="p">:</span> <span class="o">...</span><span class="p">;</span> <span class="p">}</span>
<span class="p">:</span><span class="nd">lang</span><span class="o">(</span><span class="nt">ko</span><span class="o">)</span> <span class="p">{</span><span class="k">font-family</span><span class="p">:</span> <span class="o">...</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
<p>The problem is the <code>:lang</code> selector is not supported by <code>librsvg</code>. Also, we would want to distinguish between <code>zh-Hans</code> and <code>zh-Hant</code>. Unfortunately, old versions of <code>librsvg</code> only distinguish up to the first hyphen.
</p><p>There is not a good solution for the <code>systemLanguage</code> attribute. CSS can do case-insensitive, partial, matches to an IETF langtag:
</p>
<div class="mw-highlight mw-highlight-lang-css mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span><span class="nt">systemLanguage</span><span class="o">|=</span><span class="s2">&quot;zh&quot;</span> <span class="nt">i</span><span class="o">]</span> <span class="p">{</span><span class="k">font-family</span><span class="p">:</span> <span class="o">...</span><span class="p">;</span> <span class="p">}</span>
<span class="o">[</span><span class="nt">systemLanguage</span><span class="o">|=</span><span class="s2">&quot;ja&quot;</span> <span class="nt">i</span><span class="o">]</span> <span class="p">{</span><span class="k">font-family</span><span class="p">:</span> <span class="o">...</span><span class="p">;</span> <span class="p">}</span>
<span class="o">[</span><span class="nt">systemLanguage</span><span class="o">|=</span><span class="s2">&quot;ko&quot;</span> <span class="nt">i</span><span class="o">]</span> <span class="p">{</span><span class="k">font-family</span><span class="p">:</span> <span class="o">...</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
<p>But CSS is not designed to parse comma-separated lists (SVG should have made the <code>systemLanguage</code> attribute a space separated list just like the <code>class</code> attribute). Even then, CSS does not have prefix matching (<code>=|</code>) on space-separated token lists (<code>~=</code> matching). One can use several selectors to cover the cases, but it is cumbersome.
</p>
<h3><span class="mw-headline" id="Languages_and_layout">Languages and layout</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=88" title="Edit section: Languages and layout">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:SVG_test_vertical.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/SVG_test_vertical.svg/220px-SVG_test_vertical.svg.png" decoding="async" width="220" height="110" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/SVG_test_vertical.svg/330px-SVG_test_vertical.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/SVG_test_vertical.svg/440px-SVG_test_vertical.svg.png 2x" data-file-width="512" data-file-height="256" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:SVG_test_vertical.svg" class="internal" title="Enlarge"></a></div>Vertical layout tests for English and Chinese. The green text would work for a plot's y-axis, but the <code>librsvg</code> used by WMF does not handle the CSS.</div></div></div>
<p>Consider an x-y plot. The x-axis label will be horizontal and handled normally. The y-axis label is often written rotated by 90&#176; with a text anchor of start or middle. That works for Western European languages, but Chinese should not rotate the characters but rather write them top to bottom.
</p><p>The normal method of producing the y-axis label for a Western European language would be to rotate the text by -90&#176;. The rotation point would be logically on the font baseline. For Chinese, the normal method would not be a rotation but to set the <code>writing-mode</code> to top-to-bottom. The logical baseline is no longer the bottom of the text but rather the center of the text. If the Western text used a start anchor point, then the Chinese text would use an end anchor point.
</p><p>CSS can do the transform or set the writing mode, but there are subtle issues. Using the CSS <code>transform</code> property will trump any <code>transform</code> attribute on the element (CSS priority). Similarly, CSS would not trump a <code>transform</code> in a <code>style</code> attribute. Also, such transforms are applied before a <code>text</code> element's <code>x</code> and <code>y</code> attributes. Coordinates on <code>tspan</code> elements may be problematic.
</p><p>The green text in the "Vertical Layout tests" to the right uses CSS to adjust a possible y-axis label. It could use a better Western European language default. The CSS is
</p>
<div class="mw-highlight mw-highlight-lang-css mw-content-ltr" dir="ltr"><pre><span></span><span class="p">:</span><span class="nd">lang</span><span class="o">(</span><span class="nt">zh-Hans</span><span class="o">)</span> <span class="p">{</span> <span class="k">font-family</span><span class="p">:</span> <span class="n">NSimSun</span><span class="p">,</span> <span class="kc">sans-serif</span><span class="p">;</span> <span class="p">}</span>
<span class="p">:</span><span class="nd">lang</span><span class="o">(</span><span class="nt">zh-Hant</span><span class="o">)</span> <span class="p">{</span> <span class="k">font-family</span><span class="p">:</span> <span class="n">PMingLiU-ExtB</span><span class="p">,</span> <span class="n">MingLiU_HKSCS-ExtB</span><span class="p">,</span> <span class="n">Microsoft</span> <span class="n">JhengHei</span><span class="p">,</span> <span class="kc">sans-serif</span><span class="p">;</span> <span class="p">}</span>
<span class="p">.</span><span class="nc">vert</span> <span class="p">{</span> <span class="n">fill</span><span class="p">:</span> <span class="kc">green</span><span class="p">;</span> <span class="p">}</span>
<span class="p">.</span><span class="nc">vert</span><span class="p">:</span><span class="nd">lang</span><span class="o">(</span><span class="nt">en</span><span class="o">)</span> <span class="p">{</span> <span class="k">transform</span><span class="p">:</span> <span class="nb">rotate</span><span class="p">(</span><span class="nv">-90deg</span><span class="p">);</span> <span class="k">transform-origin</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span> <span class="p">}</span>
<span class="p">.</span><span class="nc">vert</span><span class="p">:</span><span class="nd">lang</span><span class="o">(</span><span class="nt">zh</span><span class="o">)</span> <span class="p">{</span> <span class="k">writing-mode</span><span class="p">:</span> <span class="n">tb</span><span class="p">;</span> <span class="n">text-anchor</span><span class="p">:</span> <span class="kc">end</span><span class="p">;</span> <span class="k">transform</span><span class="p">:</span> <span class="nb">translate</span><span class="p">(</span><span class="nv">-0</span><span class="mf">.5</span><span class="kt">em</span><span class="p">,</span> <span class="mi">0</span><span class="kt">em</span><span class="p">);</span> <span class="p">}</span>
</pre></div>
<p>For English, the text is rotated. For Chinese, the <code>writing-mode</code> is changed; the text is offset to the left to compensate for the different baselines.
</p><p>Currently, the WMF rasterizer does not handle the example.
</p>
<h3><span id="Internationalization_.28i18n.29_and_localization_.28i10n.29"></span><span class="mw-headline" id="Internationalization_(i18n)_and_localization_(i10n)">Internationalization (i18n) and localization (i10n)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=89" title="Edit section: Internationalization (i18n) and localization (i10n)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Many SVG files are in just one language.
</p><p>SVG files that use the <code>switch</code> element and the <code>systemLanguage</code> attribute are internationalized. One SVG file supports many languages. Such SVG files are also known as multilingual. There are not separate SVG files for each language.
</p><p>There are systems that support many languages but produce output files that are monolingual. The output of these systems localized (specialized to a specific locale).
</p><p>MediaWiki uses internationalized/multilingual SVG files to produce localized PNG files. The PNG files that <code>librsvg</code> produces are not multilingual.
</p><p>That leads to semantic differences. When MediaWiki displays a multilingual SVG file, it displays the language desired by the wiki, but when I display an SVG file in my browser, my browser displays it in my preferred language.
</p><p>XSLT localizer. Transform multilingual SVG to monolingual. It can also strip unneeded namespaces such as <code>inkscape:</code> (that will not remove properties in <code>style</code> elements or attributes.
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.informit.com/articles/article.aspx?p=24032&amp;seqNum=8">https://www.informit.com/articles/article.aspx?p=24032&amp;seqNum=8</a></li>
<li><a rel="nofollow" class="external free" href="http://xmlsoft.org/XSLT/xsltproc.html">http://xmlsoft.org/XSLT/xsltproc.html</a></li>
<li><a rel="nofollow" class="external free" href="https://gitlab.gnome.org/GNOME/libxslt">https://gitlab.gnome.org/GNOME/libxslt</a></li>
<li><a rel="nofollow" class="external free" href="https://packages.debian.org/stretch/xsltproc">https://packages.debian.org/stretch/xsltproc</a>
<dl><dd><code>-stringparam PARAMNAME PARAMVALUE</code><sup id="cite_ref-21" class="reference"><a href="#cite_note-21">&#91;21&#93;</a></sup></dd></dl></li></ul>
<p>Explain the <code>lang=</code> URL parameter on Commons. Does that demand the <code>/lang</code> in the URL? There are multiple levels here, too. If I'm on a wiki and click an SVG image, it takes me to a File: page on that wiki that displays the wiki's language version. From there, I can click on the Commons link. That takes me to Commons and will display the default language version.
</p>
<ul><li><a href="https://phabricator.wikimedia.org/T134408" class="extiw" title="phab:T134408">Phab:T134408</a> Thumbnail-like rendering of localized SVGs for client-side rendering, 4 May 2016. Early recognition of localizing SVG.</li>
<li><a href="https://phabricator.wikimedia.org/T134455" class="extiw" title="phab:T134455">Phab:T134455</a> Add experimental option for direct SVG output via srcset, 4 May 2016. Needs a localizer.</li>
<li><a href="https://phabricator.wikimedia.org/T134407" class="extiw" title="phab:T134407">Phab:T134407</a> Provide a way to reference fonts for client-side SVG rendering, 4 May 2016. CSS would win here.</li>
<li><a href="https://phabricator.wikimedia.org/T134482" class="extiw" title="phab:T134482">Phab:T134482</a> Beta feature for opt-in client side SVG rendering, 5 May 2016. This seems problematic. Each wiki page would need either some JavaScript to select the SVG or PNG, or there would be an HTTP vary on the user's option that would double the cache requirements.</li></ul>
<h3><span class="mw-headline" id="List_of_languages">List of languages</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=90" title="Edit section: List of languages">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>See <a href="https://phabricator.wikimedia.org/T259018" class="extiw" title="phab:T259018">Phab:T259018</a>.
</p><p>MediaWiki API will report the available languages:
</p>
<ul><li><a class="external free" href="https://commons.wikimedia.org/w/api.php?action=query&amp;titles=File:First%20Ionization%20Energy.svg&amp;prop=imageinfo&amp;iiprop=metadata&amp;formatversion=2&amp;iimetadataversion=latest">https://commons.wikimedia.org/w/api.php?action=query&amp;titles=File:First%20Ionization%20Energy.svg&amp;prop=imageinfo&amp;iiprop=metadata&amp;formatversion=2&amp;iimetadataversion=latest</a></li>
<li><a class="external free" href="https://commons.wikimedia.org/w/api.php?action=query&amp;titles=File:2022%20Russian%20invasion%20of%20Ukraine.svg&amp;prop=imageinfo&amp;iiprop=metadata&amp;formatversion=2&amp;iimetadataversion=latest">https://commons.wikimedia.org/w/api.php?action=query&amp;titles=File:2022%20Russian%20invasion%20of%20Ukraine.svg&amp;prop=imageinfo&amp;iiprop=metadata&amp;formatversion=2&amp;iimetadataversion=latest</a></li></ul>
<p>See the <code>metadata: [ {"name": "translations", "value": [] } ]</code>. It is clearly from the <code>switch</code> information. It will have entries such as <code>{ "name": "en", "value": 2 }</code>. IIRC, the 1 and 2 values are whether it is a substring match or an exact match. Find the code to be sure.
</p><p>I'm presuming this metadata is stored in the database rather than triggering a reparsing of the file. Check that out.
</p>
<ul><li><a href="https://www.mediawiki.org/wiki/API:Imageinfo" class="extiw" title="mw:API:Imageinfo">MW:API:Imageinfo</a></li>
<li><a href="https://www.mediawiki.org/wiki/API:Data_formats" class="extiw" title="mw:API:Data formats">MW:API:Data formats</a></li>
<li><a href="https://www.mediawiki.org/wiki/API:JSON_version_2" class="extiw" title="mw:API:JSON version 2">MW:API:JSON version 2</a></li></ul>
<h3><span class="mw-headline" id="Problem_file">Problem file</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=91" title="Edit section: Problem file">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:2022_Russian_invasion_of_Ukraine.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/2022_Russian_invasion_of_Ukraine.svg/220px-2022_Russian_invasion_of_Ukraine.svg.png" decoding="async" width="220" height="148" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/2022_Russian_invasion_of_Ukraine.svg/330px-2022_Russian_invasion_of_Ukraine.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/2022_Russian_invasion_of_Ukraine.svg/440px-2022_Russian_invasion_of_Ukraine.svg.png 2x" data-file-width="2199" data-file-height="1478" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:2022_Russian_invasion_of_Ukraine.svg" class="internal" title="Enlarge"></a></div>2022 Russian invasion of Ukraine</div></div></div>
<p><a href="https://commons.wikimedia.org/wiki/File:2022_Russian_invasion_of_Ukraine.svg" title="File:2022 Russian invasion of Ukraine.svg">File:2022 Russian invasion of Ukraine.svg</a> is an important map on Commons, but it is a mess. The map is needed in many languages, and how those translations are handled is a difficult issue. There are many localized versions of the map, but they may not get continuing updates to the original file. The conflict is active, so updates are desired.
</p><p>The file can be improved in several ways, but some improvements may make the file difficult to edit. There are tradeoffs, and this file shows some of the problems.
</p>
<h4><span class="mw-headline" id="Planar_translations">Planar translations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=92" title="Edit section: Planar translations">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The original map now has some multilingual additions, but they are essentially planar translations that SVG Translate and other translation tools cannot handle.
</p><p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> Unwinding planar translations is tough. One needs to match the text elements by their position, but the positions may have moved slightly.
</p><p>Now that the file uses the translation units that SVG Translate wants, several languages have been added. Some additional translations have been so close in time that I feared they would overwrite each other, but it does not appear that happened. SVG Translate may have a significant update model that allows concurrent translations.
</p>
<h4><span class="mw-headline" id="Inkscape">Inkscape</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=93" title="Edit section: Inkscape">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The author of this SVG file uses Inkscape, so SVG Translate and hand edits to the file should not prevent the author from making changes. If the author has trouble, then it is important to list those troubles. It is possible the author with have trouble with <code>class</code> attributes.
</p><p>A significant problem is users do not know how to add new date labels and text. Copying some text and then editing often produces confused translations or untranslateable text. If an entire <code>switch</code> is copied, then the English text is changed but the default text and all the other languages stay the same. The translations are confused. If just the <code>text</code> element is copied, then it also carries the <code>systemLanguage</code> attribute. That attribute prevents SVG Translate from translating the text. The best approach is to just insert new text; do not copy it from elsewhere in the image.
</p><p>There are also strange edits that appear.
</p><p>A <code>switch</code> element may contain several unrelated (and ultimately undisplayable) <code>text</code> elements. This may come about from copying the text elements. The copy somehow ends up within the <code>switch</code>. It should not display on the screen, so it would confuse the user.
</p><p>Geometry elements are being inserted into <code>switch</code> elements that should contain only <code>text</code> elements. What determines where Inkscape will insert a new element? It should be treating a <code>switch</code> atomically. I have deleted several spurious geometry elements already, and now there are more:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch</span> <span class="na">fill=</span><span class="s">&quot;#ffffff&quot;</span> <span class="na">transform=</span><span class="s">&quot;translate(1827.3,587.38)&quot;</span> <span class="na">id=</span><span class="s">&quot;switch4938&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;rect</span> <span class="na">style=</span><span class="s">&quot;display:inline;opacity:0.948718;fill:#dc0000;fill-opacity:1;stroke:#000000;stroke-width:0.245063;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:1.92453;stroke-opacity:1&quot;</span>
        <span class="na">id=</span><span class="s">&quot;rect352325-8-9-2-1-4-3-9-29-8-3&quot;</span>
        <span class="na">width=</span><span class="s">&quot;25.413&quot;</span> <span class="na">height=</span><span class="s">&quot;5.2650332&quot;</span> 
        <span class="na">x=</span><span class="s">&quot;-12.691059&quot;</span> <span class="na">y=</span><span class="s">&quot;-3.4384575&quot;</span> <span class="na">ry=</span><span class="s">&quot;1.2425818&quot;</span> 
        <span class="na">transform=</span><span class="s">&quot;rotate(0.33424498)&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg995&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;fr&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg798&quot;</span><span class="nt">&gt;</span>1er avril<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg996-tr&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;tr&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg799-tr&quot;</span><span class="nt">&gt;</span>1 Nisan<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg996-it&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;it&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg799-it&quot;</span><span class="nt">&gt;</span>1º aprile<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg996-ru&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;ru&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg799-ru&quot;</span><span class="nt">&gt;</span>1 апреля<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg996-pt&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;pt&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg799-pt&quot;</span><span class="nt">&gt;</span>1 de Abril<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg996-el&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;el&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg799-el&quot;</span><span class="nt">&gt;</span>1 Απριλίου<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg996-ca&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;ca&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg799-ca&quot;</span><span class="nt">&gt;</span>1 d&#39;abril<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg996-vi&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;vi&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg799-vi&quot;</span><span class="nt">&gt;</span>1 tháng 4<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg996&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg799&quot;</span><span class="nt">&gt;</span>1 April<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/switch&gt;</span>
</pre></div>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The <code>rect</code> element will prevent any display of text. Also notice that the <code>systemLanguage="en"</code> clause was removed; it was probably replaced with the <code>rect</code> element. There is also the sneaky rotate by less than 1 degree transform. Inkscape is also inserting copious style information.
</p><p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> Also, instead of editing a symbol definition, the <code>use</code> was exploded and the result edited in place.
</p>
<h4><span class="mw-headline" id="Colors">Colors</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=94" title="Edit section: Colors">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Many people want the map colors changed. One concern was using web safe/colorblind-friendly colors. Consistent (and easily changed) colors can be done with styles.
</p>
<h4><span class="mw-headline" id="Place_names">Place names</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=95" title="Edit section: Place names">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The map is already large. There are hundreds of community names on the map. That presents the same translation bloat problem that a 100-language version of a US map presents. The map should use a skeleton file that is localized with a database of translations. WMF does not have that capability for SVG files. SVG also does not have an easy line-breaking method.
</p><p>Need to work with what we have today. To keep the file size down, the <code>switch</code> elements are given or inherit styling from <code>class="place"</code>. That allows the fill color, font family, and text-anchor to specified in one place rather than repeated on each element. The font size is also given or inherited. The font size is a function of the city's population. The text position is also specified on the <code>switch</code> element so it need not be repeated for each translation.
</p>
<h4><span class="mw-headline" id="Finding_place_names">Finding place names</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=96" title="Edit section: Finding place names">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Using WikiData to translate place names is complicated by difficult-to-resolve Ukrainian place names. For example, "Pershotravneve" maps to more than 30 WikiData items.<sup id="cite_ref-22" class="reference"><a href="#cite_note-22">&#91;22&#93;</a></sup> To automate the search, the name should be attached to a map point; that practice is not common on SVG maps. The projection parameters can be found by following sources back to <a href="https://commons.wikimedia.org/wiki/File:Ukraine_adm_location_map.svg" title="File:Ukraine adm location map.svg">File:Ukraine adm location map.svg</a>; the base map claims to be an equirectangular projection that includes administrative regions. The SVG size is 1,546 × 1,038. Then invert that point with the map projection to get a latitude and longitude of the community. Then do the WikiData query that coincides with that position.
</p>
<div style="background: lightblue;">
<table class="wikitable" style="text-align:center"><tbody><tr><th colspan="3">
<p><a href="https://en.wikipedia.org/wiki/Equirectangular_projection" class="extiw" title="en:Equirectangular projection">Equirectangular projection</a>, vertical stretching 150&#160;%<br />Border coordinates
</p>
</th></tr><tr><td colspan="3">52.7</td></tr><tr><td style="width:7em;">21.5</td><td>←↕→</td><td style="width:7em;">40.7</td></tr>
<tr><td colspan="3">44.1</td></tr></tbody></table>
<p><bdi><img alt="Pictogram voting info.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Pictogram_voting_info.svg/15px-Pictogram_voting_info.svg.png" decoding="async" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Pictogram_voting_info.svg/23px-Pictogram_voting_info.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Pictogram_voting_info.svg/30px-Pictogram_voting_info.svg.png 2x" data-file-width="250" data-file-height="250" />&#160;<b>Info</b></bdi> This map is part of a series of location maps with unified standards: SVG as file format, standardised colours and name scheme. The boundaries on these maps always show the <a href="https://en.wikipedia.org/wiki/De_facto" class="extiw" title="en:De facto">de facto</a> situation and do not imply any endorsement or acceptance. In case of changes of the shown area the file is updated. The old version will be uploaded as a new file and thus is still available.
</p>
</div>
<p>The file is 2,199 × 1,478 px.
Radekhiv is at (350.01 px, 413.3 px) &#8594;
50.3&#176; N,
24.56&#176; E.
Google Maps says 50.28&#176; N, 24.60&#176; E.<sup id="cite_ref-23" class="reference"><a href="#cite_note-23">&#91;23&#93;</a></sup>.
The WikiData item is <a href="https://www.wikidata.org/wiki/Q904046" class="extiw" title="d:Q904046"><span title="city in Ukraine">Radekhiv <small>(Q904046)</small></span></a>.
</p><p>The vertical stretching comment of 150% is the same as shrinking the horizontal by 2/3. That gives the standard parallels as <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \arccos(2/3)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>arccos</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">(</mo>
        <mn>2</mn>
        <mrow class="MJX-TeXAtom-ORD">
          <mo>/</mo>
        </mrow>
        <mn>3</mn>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \arccos(2/3)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4d18f12a11062ef18b9ab19d4c674e9272d267c4" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:11.514ex; height:2.843ex;" alt="{\displaystyle \arccos(2/3)}"/></span> = ±48.1897.
</p><p>Locations use circles; it might be better to use symbols.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span> <span class="nt">&lt;g</span> <span class="na">fill=</span><span class="s">&quot;#ff4&quot;</span> <span class="na">stroke=</span><span class="s">&quot;#777&quot;</span> <span class="na">stroke-width=</span><span class="s">&quot;.71&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;950.74&quot;</span> <span class="na">cy=</span><span class="s">&quot;379.56&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;246.42&quot;</span> <span class="na">cy=</span><span class="s">&quot;424.61&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;350.01&quot;</span> <span class="na">cy=</span><span class="s">&quot;413.3&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;340.11&quot;</span> <span class="na">cy=</span><span class="s">&quot;175.71&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1252.6&quot;</span> <span class="na">cy=</span><span class="s">&quot;439.46&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1283.4&quot;</span> <span class="na">cy=</span><span class="s">&quot;500.98&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;288.49&quot;</span> <span class="na">cy=</span><span class="s">&quot;210.71&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;297.69&quot;</span> <span class="na">cy=</span><span class="s">&quot;259.51&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;307.23&quot;</span> <span class="na">cy=</span><span class="s">&quot;319.26&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;372.29&quot;</span> <span class="na">cy=</span><span class="s">&quot;378.3&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;463.15&quot;</span> <span class="na">cy=</span><span class="s">&quot;243.6&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;527.85&quot;</span> <span class="na">cy=</span><span class="s">&quot;150.26&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1596.7&quot;</span> <span class="na">cy=</span><span class="s">&quot;465.5&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1671.8&quot;</span> <span class="na">cy=</span><span class="s">&quot;477.12&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;/g&gt;</span>
 <span class="nt">&lt;g</span> <span class="na">fill=</span><span class="s">&quot;#ff4&quot;</span> <span class="na">stroke-width=</span><span class="s">&quot;.71&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;g</span> <span class="na">stroke=</span><span class="s">&quot;#777&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1598.5&quot;</span> <span class="na">cy=</span><span class="s">&quot;574.58&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1648.1&quot;</span> <span class="na">cy=</span><span class="s">&quot;611.47&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1687.9&quot;</span> <span class="na">cy=</span><span class="s">&quot;570.18&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1782.4&quot;</span> <span class="na">cy=</span><span class="s">&quot;651.77&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1722.5&quot;</span> <span class="na">cy=</span><span class="s">&quot;661.25&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1722.1&quot;</span> <span class="na">cy=</span><span class="s">&quot;533.15&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1700.9&quot;</span> <span class="na">cy=</span><span class="s">&quot;655.44&quot;</span> <span class="na">r=</span><span class="s">&quot;3.2&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1540.9&quot;</span> <span class="na">cy=</span><span class="s">&quot;377.32&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/g&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1577.5&quot;</span> <span class="na">cy=</span><span class="s">&quot;330.57&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span> <span class="na">stroke=</span><span class="s">&quot;#787877&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;g</span> <span class="na">stroke=</span><span class="s">&quot;#777&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1374.1&quot;</span> <span class="na">cy=</span><span class="s">&quot;333.64&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1330.1&quot;</span> <span class="na">cy=</span><span class="s">&quot;312.07&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1464.5&quot;</span> <span class="na">cy=</span><span class="s">&quot;261.7&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/g&gt;</span>
 <span class="nt">&lt;/g&gt;</span>
</pre></div>
<p>Sensible grouping may be done by finding a location circle and then finding nearby text. Alternatively, locate all circles near some text. The grouping also allows translation issues to be detected. For example, the anchor point of some text may need to be moved if a translation is significantly longer or shorter than the original.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;g&gt;</span>
  <span class="nt">&lt;circle</span> <span class="na">class=</span><span class="s">&quot;city&quot;</span> <span class="na">r=</span><span class="s">&quot;3&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">class=</span><span class="s">&quot;city&quot;</span> <span class="na">x=</span><span class="s">&quot;10&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>City Name<span class="nt">&lt;/text&gt;</span>
<span class="nt">&lt;/g&gt;</span>
</pre></div>
<p>The map may use a more sensible grouping of communities within districts.
</p><p>Would like to detect content that is a date.
</p><p>The text should use <code>class</code> attributes and CSS for the formatting. Map (font, font size, color) &#8594; class.
</p><p>Several <code>g</code> elements are used to default the font size (or other formatting characteristics) of their contained <code>text</code> elements. Unwinding those groups is a difficult problem. Perhaps detect a group that has presentation attributes and only <code>text</code> children.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;g</span> <span class="na">font-family=</span><span class="s">&quot;Calibri&quot;</span> <span class="na">font-size=</span><span class="s">&quot;3.27&quot;</span> <span class="na">font-weight=</span><span class="s">&quot;bold&quot;</span> <span class="na">stroke-width=</span><span class="s">&quot;.61&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;923.1&quot;</span> <span class="na">y=</span><span class="s">&quot;241.1&quot;</span><span class="nt">&gt;</span>1 April<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;1180.34&quot;</span> <span class="na">y=</span><span class="s">&quot;253.12&quot;</span><span class="nt">&gt;</span>1 April<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;1133.34&quot;</span> <span class="na">y=</span><span class="s">&quot;158.79&quot;</span><span class="nt">&gt;</span>2 April<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;1372.74&quot;</span> <span class="na">y=</span><span class="s">&quot;238.32&quot;</span><span class="nt">&gt;</span>2 April<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;1446.72&quot;</span> <span class="na">y=</span><span class="s">&quot;159.12&quot;</span><span class="nt">&gt;</span>4 April<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;936.76&quot;</span> <span class="na">y=</span><span class="s">&quot;345.97&quot;</span><span class="nt">&gt;</span>30 March<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;983.05&quot;</span> <span class="na">y=</span><span class="s">&quot;390.31&quot;</span><span class="nt">&gt;</span>31 March<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;1047.81&quot;</span> <span class="na">y=</span><span class="s">&quot;215.22&quot;</span><span class="nt">&gt;</span>31 March<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;1180.34&quot;</span> <span class="na">y=</span><span class="s">&quot;204.35&quot;</span><span class="nt">&gt;</span>1 April<span class="nt">&lt;/text&gt;</span>
<span class="nt">&lt;/g&gt;</span>
</pre></div>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> There are several screwy <code>transform</code> attributes. For example, <code>transform="scale(1.000,1)"</code>. Some other transforms have rotations of a fraction of a degree. The effective rotations are small enough that they can be ignored (except for the additional translation they introduce). Some matrices have a similar small rotation. There is even the bizarre:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;circle</span> <span class="na">transform=</span><span class="s">&quot;scale(1 -1)&quot;</span> <span class="na">cx=</span><span class="s">&quot;1291.2&quot;</span> <span class="na">cy=</span><span class="s">&quot;-261.91&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1128.4&quot;</span> <span class="na">cy=</span><span class="s">&quot;255.56&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span> <span class="na">fill-rule=</span><span class="s">&quot;evenodd&quot;</span> <span class="na">stroke-linecap=</span><span class="s">&quot;round&quot;</span> <span class="na">stroke-linejoin=</span><span class="s">&quot;round&quot;</span><span class="nt">/&gt;</span>
</pre></div>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> There are <code>text</code> elements that are not stroked but have stroking attributes.
</p><p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> There are <code>switch</code> elements that have a single default clause. Other editors have used SVG Translate on the file, so the problem has disappeared.
</p><p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> Bombing locations should be symbols, but they may not even be grouped. These use relative coordinates, so the path matching may be easier than expected. The DOM dropped path primitives.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span> <span class="nt">&lt;path</span> <span class="na">d=</span><span class="s">&quot;m791.33 600.27 5.164 3.958 1.051-3.741 1.484 3.803 4.113-3.556-2.226 4.607 3.525-.124-2.288 2.876 3.061 1.979-3.649.062 3.216 3.865-4.607-2.134-.495 4.143-2.257-3.34-3.154 4.298.309-5.38-4.298.866 2.69-3.525-2.196-3.587 3.061.588z&quot;</span> <span class="na">fill=</span><span class="s">&quot;red&quot;</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;path</span> <span class="na">d=</span><span class="s">&quot;m792.98 602.35 3.877 2.972.789-2.809 1.114 2.856 3.088-2.67-1.672 3.459 2.647-.093-1.718 2.159 2.299 1.486-2.74.047 2.415 2.902-3.459-1.602-.372 3.111-1.695-2.507-2.368 3.227.232-4.04-3.227.65 2.02-2.647-1.648-2.693 2.299.441z&quot;</span> <span class="na">fill=</span><span class="s">&quot;#ff8000&quot;</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;path</span> <span class="na">d=</span><span class="s">&quot;m794.64 604.5 2.49 1.908.507-1.804.716 1.834 1.983-1.715-1.074 2.221 1.7-.06-1.103 1.387 1.476.954-1.759.03 1.551 1.864-2.222-1.029-.239 1.998-1.088-1.61-1.521 2.072.149-2.594-2.073.418 1.297-1.7-1.059-1.729 1.476.283z&quot;</span> <span class="na">fill=</span><span class="s">&quot;#ff0&quot;</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;path</span> <span class="na">d=</span><span class="s">&quot;M798.43 608.4a.777.777 0 1 1-1.553 0 .777.777 0 1 1 1.553 0z&quot;</span><span class="nt">/&gt;</span>
</pre></div>
<p>The last path uses two arcs to make a circle of radius 0.777 and diameter 1.553. It would give the center of the bombing location and the presumptive symbol origin.
</p><p>It may be better to localize the file with XSLT, fix some issues, and then restart the translations.
</p>
<h4><span class="mw-headline" id="Source_data">Source data</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=97" title="Edit section: Source data">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>See <a href="https://en.wikipedia.org/wiki/Template:Russo-Ukrainian_War_detailed_map" class="extiw" title="w:Template:Russo-Ukrainian War detailed map">w:Template:Russo-Ukrainian War detailed map</a> and <a href="https://en.wikipedia.org/wiki/Module:Russo-Ukrainian_War_detailed_map" class="extiw" title="w:Module:Russo-Ukrainian War detailed map">w:Module:Russo-Ukrainian War detailed map</a>. These maps are made with technology on the English Wikipedia. The air bases and nuclear installations have names. Cities with latitude and longitude by Oblast. Labels are wikilinks such as <a href="https://en.wikipedia.org/wiki/Zelenodolsk,_Ukraine" class="extiw" title="w:Zelenodolsk, Ukraine">Zelenodolsk</a>, and following that link produces the WikiData item <a href="https://www.wikidata.org/wiki/Q640713" class="extiw" title="d:Q640713"><span title="town in Dnipropetrovsk Oblast, Ukraine">Zelenodolsk <small>(Q640713)</small></span></a>. The diagram has lost of lot of information.
</p><p>The module has some data in an apparent Lua object. I do not know if the data is available as JSON.
</p>
<ul><li><a href="https://www.wikidata.org/wiki/Property:P131" class="extiw" title="d:Property:P131"><span title="the item is located on the territory of the following administrative entity. Use P276 for specifying locations that are non-administrative places and for items about events. Use P1382 if the item falls only partially into the administrative entity.">located in the administrative territorial entity <small>(P131)</small></span></a> (allows sorting by Oblast?)</li>
<li><a href="https://www.wikidata.org/wiki/Property:P625" class="extiw" title="d:Property:P625"><span title="geocoordinates of the subject. For Earth, please note that only WGS84 coordinating system is supported at the moment">coordinate location <small>(P625)</small></span></a> (allows checking location)</li>
<li><a href="https://www.wikidata.org/wiki/Property:P1082" class="extiw" title="d:Property:P1082"><span title="number of people inhabiting the place; number of people of subject">population <small>(P1082)</small></span></a> (allows checking dot size)</li></ul>
<p>How do I find which items have links to a Wikipedia article?
</p><p>What is the best query approach?
</p>
<h5><span class="mw-headline" id="Wikidata_API_queries">Wikidata API queries</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=98" title="Edit section: Wikidata API queries">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>From a wiki article, find the Q-item? See <a class="external free" href="https://www.mediawiki.org/w/api.php?action=help&amp;modules=query%2Bwbentityusage">https://www.mediawiki.org/w/api.php?action=help&amp;modules=query%2Bwbentityusage</a>
</p>
<ul><li><a class="external free" href="https://en.wikipedia.org/w/api.php?action=query&amp;prop=wbentityusage&amp;titles=Zelenodolsk,%20Ukraine">https://en.wikipedia.org/w/api.php?action=query&amp;prop=wbentityusage&amp;titles=Zelenodolsk,%20Ukraine</a></li></ul>
<p>returns
</p>
<pre>{
    "batchcomplete": "",
    "query": {
        "pages": {
            "33276544": {
                "pageid": 33276544,
                "ns": 0,
                "title": "Zelenodolsk, Ukraine",
                "wbentityusage": {
                    "Q10172305": {
                        "aspects": [
                            "S"
                        ]
                    },
                    "Q640713": {
                        "aspects": [
                            "C",
                            "D.en",
                            "O",
                            "S",
                            "T"
                        ]
                    }
                }
            }
        }
    }
}
</pre>
<p>Can a SPARQL query find which item has a link to the article?
</p>
<h5><span class="mw-headline" id="Position-based_SPARQL_query">Position-based SPARQL query</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=99" title="Edit section: Position-based SPARQL query">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Find a settlement using its latitude and longitude.
</p><p>For example, Zelenodolsk is at <code>Point(33.652359815 47.563096347)</code>. Find the settlements near that point:
</p>
<div><div class="mw-highlight mw-highlight-lang-sparql mw-content-ltr" dir="ltr"><pre><span></span><span class="c">#title: places in Ukraine near a coordinate</span>
<span class="c"># SELECT ?place ?placeLabel ?location WHERE {</span>
<span class="c">#  wd:Q640713 wdt:P625 ?coord.                         # coordinates of the location</span>
<span class="c">#  ?place wdt:P17 wd:Q212;                               # country: Ukraine</span>
<span class="c">#         wdt:P625 ?location.</span>
<span class="c">#  FILTER(geof:distance(?location, ?coord) &lt; 10). # less than 10 km away</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="nv">?place</span> <span class="nv">?placeLabel</span> <span class="nv">?oblastLabel</span> <span class="nv">?location</span> <span class="nv">?distance</span> <span class="k">WHERE</span> <span class="p">{</span>
  <span class="k">Bind</span><span class="p">(</span><span class="s">&quot;Point(33.652359815 47.563096347)&quot;</span><span class="o">^^</span><span class="nn">geo</span><span class="p">:</span><span class="nt">wktLiteral</span> <span class="k">as</span> <span class="nv">?coord</span><span class="p">).</span>
  <span class="nv">?place</span> <span class="nn">wdt</span><span class="p">:</span><span class="nt">P31</span><span class="o">/</span><span class="nn">wdt</span><span class="p">:</span><span class="nt">P279</span><span class="o">*</span> <span class="nn">wd</span><span class="p">:</span><span class="nt">Q12051488</span> <span class="p">.</span> <span class="c"># populated place in Ukraine</span>
  <span class="c"># ?place wdt:P131* ?oblast.</span>
  <span class="c"># ?oblast wdt:P31 wd:Q3348196. # located in Ukrainian oblast</span>
  
  <span class="c"># Search by Nearest</span>
  <span class="k">SERVICE</span> <span class="nn">wikibase</span><span class="p">:</span><span class="nt">around</span> <span class="p">{</span> 
    <span class="nv">?place</span> <span class="nn">wdt</span><span class="p">:</span><span class="nt">P625</span> <span class="nv">?location</span> <span class="p">.</span> 
    <span class="nn">bd</span><span class="p">:</span><span class="nt">serviceParam</span> <span class="nn">wikibase</span><span class="p">:</span><span class="nt">center</span> <span class="nv">?coord</span> <span class="p">.</span>
    <span class="nn">bd</span><span class="p">:</span><span class="nt">serviceParam</span> <span class="nn">wikibase</span><span class="p">:</span><span class="nt">radius</span> <span class="s">&quot;10&quot;</span> <span class="p">.</span> 
    <span class="nn">bd</span><span class="p">:</span><span class="nt">serviceParam</span> <span class="nn">wikibase</span><span class="p">:</span><span class="nt">distance</span> <span class="nv">?distance</span> <span class="p">.</span>
  <span class="p">}</span>
  <span class="k">SERVICE</span> <span class="nn">wikibase</span><span class="p">:</span><span class="nt">label</span> <span class="p">{</span> <span class="nn">bd</span><span class="p">:</span><span class="nt">serviceParam</span> <span class="nn">wikibase</span><span class="p">:</span><span class="nt">language</span> <span class="s">&quot;en&quot;</span> <span class="p">}</span>
<span class="p">}</span> 
<span class="k">Order by</span> <span class="nv">?distance</span>
</pre></div></div><p><a class="external text" href="https://query.wikidata.org/#%23title%3A%20places%20in%20Ukraine%20near%20a%20coordinate%0A%23%20SELECT%20%3Fplace%20%3FplaceLabel%20%3Flocation%20WHERE%20%7B%0A%23%20%20wd%3AQ640713%20wdt%3AP625%20%3Fcoord.%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20coordinates%20of%20the%20location%0A%23%20%20%3Fplace%20wdt%3AP17%20wd%3AQ212%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20country%3A%20Ukraine%0A%23%20%20%20%20%20%20%20%20%20wdt%3AP625%20%3Flocation.%0A%23%20%20FILTER%28geof%3Adistance%28%3Flocation%2C%20%3Fcoord%29%20%3C%2010%29.%20%23%20less%20than%2010%20km%20away%0ASELECT%20DISTINCT%20%3Fplace%20%3FplaceLabel%20%3FoblastLabel%20%3Flocation%20%3Fdistance%20WHERE%20%7B%0A%20%20Bind%28%22Point%2833.652359815%2047.563096347%29%22%5E%5Egeo%3AwktLiteral%20as%20%3Fcoord%29.%0A%20%20%3Fplace%20wdt%3AP31%2Fwdt%3AP279%2A%20wd%3AQ12051488%20.%20%23%20populated%20place%20in%20Ukraine%0A%20%20%23%20%3Fplace%20wdt%3AP131%2A%20%3Foblast.%0A%20%20%23%20%3Foblast%20wdt%3AP31%20wd%3AQ3348196.%20%23%20located%20in%20Ukrainian%20oblast%0A%20%20%0A%20%20%23%20Search%20by%20Nearest%0A%20%20SERVICE%20wikibase%3Aaround%20%7B%20%0A%20%20%20%20%3Fplace%20wdt%3AP625%20%3Flocation%20.%20%0A%20%20%20%20bd%3AserviceParam%20wikibase%3Acenter%20%3Fcoord%20.%0A%20%20%20%20bd%3AserviceParam%20wikibase%3Aradius%20%2210%22%20.%20%0A%20%20%20%20bd%3AserviceParam%20wikibase%3Adistance%20%3Fdistance%20.%0A%20%20%7D%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22%20%7D%0A%7D%20%0AOrder%20by%20%3Fdistance">Try it!</a>
</p><h5><span class="mw-headline" id="Inverted_SPARQL_query">Inverted SPARQL query</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=100" title="Edit section: Inverted SPARQL query">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Alternatively, invert the problem. Get a list of human settlements in Ukraine and use that list to match the names. This query takes less than 4 seconds. It does not find Kyiv. Kyiv is not located in an Oblast &#8212; probably like Washington D.C. is not located within a state. So the Oblast could be optional. Furthermore, not all settlements have a population. If I do not acquire population, then the query takes 30 seconds.
</p>
<div><div class="mw-highlight mw-highlight-lang-sparql mw-content-ltr" dir="ltr"><pre><span></span><span class="c">#title: populated places in Ukraine</span>
<span class="c"># -&gt; 30,000 results w/o population, 6000 w population, 1700 w pop &gt;= 1000</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="nv">?place</span> <span class="nv">?placeLabel</span> <span class="nv">?oblastLabel</span> <span class="nv">?location</span> <span class="nv">?population</span> <span class="nv">?native</span> <span class="k">WHERE</span> <span class="p">{</span>
  <span class="nv">?place</span> <span class="nn">wdt</span><span class="p">:</span><span class="nt">P31</span><span class="o">/</span><span class="nn">wdt</span><span class="p">:</span><span class="nt">P279</span><span class="o">*</span> <span class="nn">wd</span><span class="p">:</span><span class="nt">Q12051488</span> <span class="p">.</span> <span class="c"># populated place in Ukraine</span>
  <span class="nv">?place</span> <span class="nn">wdt</span><span class="p">:</span><span class="nt">P625</span> <span class="nv">?location</span> <span class="p">.</span> <span class="c"># coordinates of the location</span>
  <span class="k">optional</span> <span class="p">{</span>
    <span class="nv">?place</span> <span class="nn">wdt</span><span class="p">:</span><span class="nt">P1082</span> <span class="nv">?population</span> <span class="p">.</span> <span class="c"># population</span>
    <span class="c"># filter (?population &gt;= 200000) .</span>
  <span class="p">}</span>
  <span class="k">optional</span> <span class="p">{</span>
    <span class="nv">?place</span> <span class="nn">wdt</span><span class="p">:</span><span class="nt">P131</span><span class="o">*</span> <span class="nv">?oblast</span> <span class="p">.</span> <span class="c"># located in an administrative region</span>
    <span class="nv">?oblast</span> <span class="nn">wdt</span><span class="p">:</span><span class="nt">P31</span> <span class="nn">wd</span><span class="p">:</span><span class="nt">Q3348196</span><span class="p">.</span> <span class="c"># that is a Ukrainian oblast</span>
  <span class="p">}</span> <span class="c"># located in an admin region</span>
  <span class="k">optional</span> <span class="p">{</span><span class="nv">?place</span> <span class="nn">wdt</span><span class="p">:</span><span class="nt">P1705</span> <span class="nv">?native</span> <span class="p">.}</span>
  <span class="k">SERVICE</span> <span class="nn">wikibase</span><span class="p">:</span><span class="nt">label</span> <span class="p">{</span> <span class="nn">bd</span><span class="p">:</span><span class="nt">serviceParam</span> <span class="nn">wikibase</span><span class="p">:</span><span class="nt">language</span> <span class="s">&quot;en&quot;</span> <span class="p">}</span>
<span class="p">}</span> 
<span class="k">Order by</span> <span class="nv">?placeLabel</span>
</pre></div></div><p><a class="external text" href="https://query.wikidata.org/#%23title%3A%20populated%20places%20in%20Ukraine%0A%23%20-%3E%2030%2C000%20results%20w%2Fo%20population%2C%206000%20w%20population%2C%201700%20w%20pop%20%3E%3D%201000%0ASELECT%20DISTINCT%20%3Fplace%20%3FplaceLabel%20%3FoblastLabel%20%3Flocation%20%3Fpopulation%20%3Fnative%20WHERE%20%7B%0A%20%20%3Fplace%20wdt%3AP31%2Fwdt%3AP279%2A%20wd%3AQ12051488%20.%20%23%20populated%20place%20in%20Ukraine%0A%20%20%3Fplace%20wdt%3AP625%20%3Flocation%20.%20%23%20coordinates%20of%20the%20location%0A%20%20optional%20%7B%0A%20%20%20%20%3Fplace%20wdt%3AP1082%20%3Fpopulation%20.%20%23%20population%0A%20%20%20%20%23%20filter%20%28%3Fpopulation%20%3E%3D%20200000%29%20.%0A%20%20%7D%0A%20%20optional%20%7B%0A%20%20%20%20%3Fplace%20wdt%3AP131%2A%20%3Foblast%20.%20%23%20located%20in%20an%20administrative%20region%0A%20%20%20%20%3Foblast%20wdt%3AP31%20wd%3AQ3348196.%20%23%20that%20is%20a%20Ukrainian%20oblast%0A%20%20%7D%20%23%20located%20in%20an%20admin%20region%0A%20%20optional%20%7B%3Fplace%20wdt%3AP1705%20%3Fnative%20.%7D%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22%20%7D%0A%7D%20%0AOrder%20by%20%3FplaceLabel">Try it!</a>
</p><p>There are more issues for oblasts. Several settlements are repeated because their oblast changed over time. Consequently, start times and end times for administrative regions are important. Is there an easy way to screen for outdated oblasts?
</p><p>The name matching does not work well. The map has about 600 place names, but only 249 matches are found. Many settlements do not have a native label (they may have a Ukrainian label). In addition, the English spelling used on the map does not always match the WikiData label. Approximate string matching may help.
</p>
<h4><span class="mw-headline" id="Fixes">Fixes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=101" title="Edit section: Fixes">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>I made some fixes to the file, and there were surprises. Several graphic elements had been merged or shuffled, and it takes a lot of work to find even simple cases. It is tedious work by hand. Another problem with working on a frequently updated file: new revisions. A recent revision caught me half-way through doing some housekeeping edits. Now I need to figure out how to merge them. That is further complicated by Inkscape's verbose output: one attribute per line (with the addition of an <code>id</code> attribute to every element). It is tougher to edit the file by hand. Time to run it through an XML pretty printer. I cannot really complain. Inkscape maintained the file structure and even the XML comments of my most recent upload. More importantly, the recent edit added content.
</p><p>Another realization is another SVG Translate issue. Most of the file is a planar translation. It has a high-level <code>switch</code> with the separate planes as <code>g</code> elements. SVG translate leaves the complicated groups with <code>systemLanguage</code> attributes alone, but it apparently processes the default clause. That processing includes adding <code>switch</code> translations to every <code>text</code> element.
</p><p>I got caught again. This time, the file was changed with SVG Translate (the legend is now a good target for SVG Translate, but not the rest of the file) while I was working on some changes.
</p><p>Planning other fixes....
</p>
<h5><span class="mw-headline" id="Locations">Locations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=102" title="Edit section: Locations">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The circles used to display cities are inconsistent. There are several radii to represent the size of the city, but the Ukrainian cities have a gray stroke while the Russian-held cities do not have a stroked border:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1597.2&quot;</span> <span class="na">cy=</span><span class="s">&quot;395.17&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span> <span class="na">fill=</span><span class="s">&quot;#ff4&quot;</span> <span class="na">stroke=</span><span class="s">&quot;#777&quot;</span> <span class="na">stroke-width=</span><span class="s">&quot;.71&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1680.7&quot;</span> <span class="na">cy=</span><span class="s">&quot;408.34&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span> <span class="na">fill=</span><span class="s">&quot;red&quot;</span><span class="nt">/&gt;</span>
</pre></div>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The stroke width is almost exclusively 0.71, but there are some cases with 1.09, 0.5, and 0.41. Some CSS would be neater and allow quickly adding a border:
</p>
<div class="mw-highlight mw-highlight-lang-css mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">circle</span><span class="p">.</span><span class="nc">uk</span> <span class="p">{</span><span class="n">fill</span><span class="p">:</span> <span class="mh">#ff4</span><span class="p">;</span> <span class="n">stroke</span><span class="p">:</span> <span class="mh">#777</span><span class="p">;</span> <span class="n">stroke-width</span><span class="p">:</span> <span class="mf">.71</span><span class="kt">px</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">circle</span><span class="p">.</span><span class="nc">ru</span> <span class="p">{</span><span class="n">fill</span><span class="p">:</span> <span class="kc">red</span><span class="p">;</span> <span class="n">stroke</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span> <span class="n">stroke-width</span><span class="p">:</span> <span class="mf">.71</span><span class="kt">px</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1597.2&quot;</span> <span class="na">cy=</span><span class="s">&quot;395.17&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span> <span class="na">class=</span><span class="s">&quot;uk&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">&quot;1680.7&quot;</span> <span class="na">cy=</span><span class="s">&quot;408.34&quot;</span> <span class="na">r=</span><span class="s">&quot;2.49&quot;</span> <span class="na">class=</span><span class="s">&quot;ru&quot;</span><span class="nt">/&gt;</span>
</pre></div>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The Russian fill is usually red <span style="background:red;color:red;font-weight:400;" title="red"><span style="visibility:hidden; color:transparent;">00</span></span>, but sometimes it is #fa2c29 <span style="background:#fa2c29;color:red;font-weight:400;" title="#fa2c29"><span style="visibility:hidden; color:transparent;">00</span></span>.
</p>
<ul><li><span style="font-family: monospace"><span style="background:#fa2c29;color:#FFF;font-weight:400;" title="#fa2c29"><span style="visibility:hidden; color:transparent;">0</span>#fa2c29<span style="visibility:hidden; color:transparent;">0</span></span></span></li>
<li><span style="font-family: monospace"><span style="background:#ff0000;color:#FFF;font-weight:400;" title="#ff0000"><span style="visibility:hidden; color:transparent;">0</span>#ff0000<span style="visibility:hidden; color:transparent;">0</span></span></span></li></ul>
<p>Just using red seems reasonable.
</p><p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> Date label fills use yellow and a darker red:
</p>
<ul><li><span style="font-family: monospace"><span style="background:#ff0;color:#000;font-weight:400;" title="#ff0"><span style="visibility:hidden; color:transparent;">0</span>#ff0<span style="visibility:hidden; color:transparent;">0</span></span></span></li>
<li><span style="font-family: monospace"><span style="background:#dc0000;color:#FFF;font-weight:400;" title="#dc0000"><span style="visibility:hidden; color:transparent;">0</span>#dc0000<span style="visibility:hidden; color:transparent;">0</span></span></span></li></ul>
<p>Much of the placename text is a blue #04a <span style="background:#04a;color:red;font-weight:400;" title="#04a"><span style="visibility:hidden; color:transparent;">00</span></span>.
</p><p>The placename text usually is the same as the placenames used in the English version. Just use the English placenames and then add back the few changes (e.g., French uses Kiev).
</p><p>The biggest problem with placenames is the dot size and the font size. Those sizes reflect the population, but consistent handling of those items is tough. In addition, some placename text may need different text anchors. Putting a size value in the <code>class</code> would work to set the font size, but it may not work for SVG 1.1 <code>circle</code> elements. The <code>r</code> radius is a geometry property that can be set with CSS in SVG 2.0, but it is just an attribute in SVG 1.1.<sup id="cite_ref-24" class="reference"><a href="#cite_note-24">&#91;24&#93;</a></sup>
</p><p>The issue of dot size.
</p>
<table class="wikitable">
<caption>Towns and Villages
</caption>
<tbody><tr>
<th>Population</th>
<th>Dot Size</th>
<th>Possible r</th>
<th>Label Size</th>
<th>Possible font-size</th>
<th>Contested city size
</th></tr>
<tr>
<td>Capital</td>
<td>Size: 35</td>
<td>8.71</td>
<td>label size: 140</td>
<td>17.79</td>
<td>
</td></tr>
<tr>
<td>Population 1M +</td>
<td>Size: 28</td>
<td></td>
<td>label size: 130</td>
<td></td>
<td>
</td></tr>
<tr>
<td>Population 500K +</td>
<td>Size: 24</td>
<td></td>
<td>label size: 120</td>
<td></td>
<td>
</td></tr>
<tr>
<td>Population 200K +</td>
<td>Size: 20</td>
<td></td>
<td>label size: 110</td>
<td></td>
<td>
</td></tr>
<tr>
<td>Population 100K +</td>
<td>Size: 16</td>
<td></td>
<td>label size: 100</td>
<td></td>
<td>
</td></tr>
<tr>
<td>Population 50K +</td>
<td>Size: 14</td>
<td></td>
<td>label size: 90</td>
<td></td>
<td>
</td></tr>
<tr>
<td>Population 20K +</td>
<td>Size: 12</td>
<td></td>
<td>label size: 80</td>
<td></td>
<td>
</td></tr>
<tr>
<td>Population 10K +</td>
<td>Size: 10</td>
<td></td>
<td>label size: 70</td>
<td></td>
<td>
</td></tr>
<tr>
<td>Population 5K +</td>
<td>Size: 8</td>
<td></td>
<td>label size: 60</td>
<td></td>
<td>
</td></tr>
<tr>
<td>Population &lt; 5K</td>
<td>Size: 6</td>
<td></td>
<td>label size: 0 or 50</td>
<td></td>
<td>
</td></tr></tbody></table>
<pre>	--Towns &amp; Villages
			-- Dotsize vs. Population
	--Arranged by Oblasts, then cities, alphabetical order
</pre>
<p>Locations
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Location_dot_blue.svg" title="File:Location dot blue.svg">File:Location dot blue.svg</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Location_dot_red.svg" title="File:Location dot red.svg">File:Location dot red.svg</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:80x80-red-blue-anim.gif" title="File:80x80-red-blue-anim.gif">File:80x80-red-blue-anim.gif</a></li></ul>
<h5><span class="mw-headline" id="Styling_with_class">Styling with class</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=103" title="Edit section: Styling with class">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>I would like to use <code>class</code> attribute and CSS to set styling. I did that in the map legend, but some web searches suggest that it is difficult to use class/CSS formatting in Inkscape. I need to find out more to avoid making the file difficult for others to edit.
</p><p>Some comments suggested that <code>class</code> must be set in the XML editor (which might be daunting for many editors and have substantial peril). In addition, changing the <code>class</code> may not cause Inkscape's visual display to be updated. How does Inkscape handle styling? There were also comments about using Inkscape styling extensions, but extensions are not a good route.
</p>
<h5><span class="mw-headline" id="Dates">Dates</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=104" title="Edit section: Dates">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The date text does vary among versions, but the translations are direct. A wholesale use of the <code>systemLanguage="en"</code> group followed by editing the dates should work.
</p><p>Dates are done in Calibri bold. The date text depends on the background. Russian dates are white, Ukrainian dates are black. Unfortunately, <code>librsvg</code> does not handle class conjunctions:<sup id="cite_ref-25" class="reference"><a href="#cite_note-25">&#91;25&#93;</a></sup>
</p>
<div class="mw-highlight mw-highlight-lang-css mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">text</span><span class="p">.</span><span class="nc">date</span> <span class="p">{</span> <span class="k">font-family</span><span class="p">:</span> <span class="n">Calibri</span><span class="p">;</span> <span class="k">font-weight</span><span class="p">:</span> <span class="kc">bold</span><span class="p">;</span> <span class="k">font-size</span><span class="p">:</span> <span class="mf">3.27</span><span class="kt">px</span><span class="p">;</span> <span class="n">text-anchor</span><span class="p">:</span> <span class="kc">middle</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">text</span><span class="p">.</span><span class="nc">date</span><span class="p">.</span><span class="nc">ru</span> <span class="p">{</span> <span class="n">fill</span><span class="p">:</span> <span class="mh">#FFF</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">text</span><span class="p">.</span><span class="nc">date</span><span class="p">.</span><span class="nc">uk</span> <span class="p">{</span> <span class="n">fill</span><span class="p">:</span> <span class="mh">#000</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> A date label was made with a <code>rect</code> element for the background and a <code>text</code> element for the date. I changed the <code>rect</code> elements to use the <code>#labelru</code> and <code>#labeluk</code> symbols. I also paired the symbols with their corresponding text, so the SVG now looks like:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#labelru&quot;</span> <span class="na">x=</span><span class="s">&quot;961.3&quot;</span> <span class="na">y=</span><span class="s">&quot;378.84&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;switch</span> <span class="na">fill=</span><span class="s">&quot;#fff&quot;</span> <span class="na">transform=</span><span class="s">&quot;translate(965.88, 382.3)&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>25 February<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;fr&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>25 février<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;tr&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>25 Şubat<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text&gt;&lt;tspan&gt;</span>25 February<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/switch&gt;</span>
</pre></div>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The text does not use <code>text-anchor="middle"</code>, so the "25 Subat" will skew to the left.
</p><p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The text <i>x</i>-coordinate should be shifted to the midpoint of the <code>use</code> element. That would be <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle x'=x+{25.41 \over 2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>x</mi>
          <mo>&#x2032;</mo>
        </msup>
        <mo>=</mo>
        <mi>x</mi>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>25.41</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle x'=x+{25.41 \over 2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/05ccc92b1bc45b2139081028b50f4498017d8078" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; width:15.416ex; height:5.176ex;" alt="{\displaystyle x&#039;=x+{25.41 \over 2}}"/></span>.
</p><p>Ideally, the origin of the symbol and the midpoint of the text would coincide. The <code>#labelru</code> and <code>#labeluk</code> symbols can be shifted to use the same origin as the text.
</p><p>Placing both elements in a group would allow positioning both. Such a grouping may be confusing to others.
</p><p>Several labels have the same date and consequently redundant translations. A simplification would be to put each date into a symbol where it would be translated once. It could even be used in both symbols:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#labelru&quot;</span> <span class="err">...</span><span class="nt">&gt;</span>
<span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#april_15&quot;</span> <span class="na">fill=</span><span class="s">&quot;#fff&quot;</span><span class="nt">/&gt;</span>

<span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#labeluk&quot;</span> <span class="err">...</span><span class="nt">&gt;</span>
<span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#april_15&quot;</span> <span class="na">fill=</span><span class="s">&quot;#000&quot;</span><span class="nt">/&gt;</span>
</pre></div>
<p>That change may also be confusing to others.
</p><p>The Intl package can format international dates.<sup id="cite_ref-26" class="reference"><a href="#cite_note-26">&#91;26&#93;</a></sup>
</p>
<div class="mw-highlight mw-highlight-lang-js mw-content-ltr" dir="ltr"><pre><span></span><span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mf">2022</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">15</span><span class="p">);</span>
<span class="ow">new</span> <span class="nb">Intl</span><span class="p">.</span><span class="nx">DateTimeFormat</span><span class="p">(</span><span class="s2">&quot;de&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">day</span><span class="o">:</span> <span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="nx">month</span><span class="o">:</span> <span class="s2">&quot;long&quot;</span><span class="p">}).</span><span class="nx">format</span><span class="p">(</span><span class="nx">date</span><span class="p">);</span>
</pre></div>
<p>There are some issues: <code>"en"</code> &#8594; "March 15", <code>"en-GB"</code> &#8594; "15 March". For German, a period is added after the day. Hand translation for French gives "<span lang="fr">1er avril</span>".<sup id="cite_ref-27" class="reference"><a href="#cite_note-27">&#91;27&#93;</a></sup> For Italian, "<span lang="it">1º aprile</span>".<sup id="cite_ref-28" class="reference"><a href="#cite_note-28">&#91;28&#93;</a></sup> The flourishes are only for the first day of the month.
</p><p>It would be better if the dates were generated automatically rather than manually translated.
</p><p>I use the Date object to parse the default date (<code>Date.parse(el.textContent + " 2022")</code>). Then I use the Intl package to compare the dates in the <code>switch</code> element clauses.
</p><p>From a data standpoint, a more sensible default clause would use an ISO date format.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>15 March<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text&gt;</span>2022-03-15<span class="nt">&lt;/text&gt;</span>
<span class="nt">&lt;/switch&gt;</span>
</pre></div>
<p>Unfortunately, that would confuse SVG Translate. Going from English to another language would present "15 March", but going from default would present "2022-03-15".
</p><p>I'm seeing strange changes to the SVG. Notice the <code>y="31.370001</code>. That suggests the number 31.37 was bumped by a single-float epsilon. Furthermore, <code>transform="rotate(9.267) translate(1485.7, Y)"</code> was rewritten as <code>transform="rotate(9.267,-957.72641,9148.3009)"</code>. It is rotating the origin to a desired location!<br />
Gross check (needs work):<br />
1460.7007169041, 
273.62571979975<br />
1460.7006854713, 
273.62571624018
<br />
Is the rewrite done by Inkscape or by SVG Translate?
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#labelru&quot;</span> <span class="na">transform=</span><span class="s">&quot;rotate(9.267)&quot;</span> <span class="na">x=</span><span class="s">&quot;1473&quot;</span> <span class="na">y=</span><span class="s">&quot;31.370001&quot;</span> <span class="na">id=</span><span class="s">&quot;use4827&quot;</span> <span class="na">width=</span><span class="s">&quot;100%&quot;</span> <span class="na">height=</span><span class="s">&quot;100%&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;switch</span> <span class="na">fill=</span><span class="s">&quot;#ffffff&quot;</span> <span class="na">transform=</span><span class="s">&quot;rotate(9.267,-957.72641,9148.3009)&quot;</span> <span class="na">id=</span><span class="s">&quot;switch4839&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span> <span class="na">id=</span><span class="s">&quot;trsvg973&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg776&quot;</span><span class="nt">&gt;</span>25 February<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;fr&quot;</span> <span class="na">id=</span><span class="s">&quot;trsvg974&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg777&quot;</span><span class="nt">&gt;</span>25 février<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg975-tr&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;tr&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg778-tr&quot;</span><span class="nt">&gt;</span>25 Şubat<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg975-it&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;it&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg778-it&quot;</span><span class="nt">&gt;</span>25 febbraio<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg975-ru&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;ru&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg778-ru&quot;</span><span class="nt">&gt;</span>25 февраля<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg975-pt&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;pt&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg778-pt&quot;</span><span class="nt">&gt;</span>25 de Fevereiro<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg975-el&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;el&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg778-el&quot;</span><span class="nt">&gt;</span>25 Φεβρουαρίου<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg975&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg778&quot;</span><span class="nt">&gt;</span>25 February<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/switch&gt;</span>
</pre></div>
<p>Somebody is going nuts duplicating rotated <code>use</code> elements.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#labelru&quot;</span> <span class="na">x=</span><span class="s">&quot;1937.40&quot;</span> <span class="na">y=</span><span class="s">&quot;544.58002&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#labelru&quot;</span> <span class="na">x=</span><span class="s">&quot;1937.40&quot;</span> <span class="na">y=</span><span class="s">&quot;544.58002&quot;</span> <span class="na">transform=</span><span class="s">&quot;rotate(0.334,-4875.8035,-16138.871)&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#labelru&quot;</span> <span class="na">x=</span><span class="s">&quot;1937.40&quot;</span> <span class="na">y=</span><span class="s">&quot;544.58002&quot;</span> <span class="na">transform=</span><span class="s">&quot;rotate(0.668,-5215.2903,-325.84574)&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;switch</span> <span class="na">fill=</span><span class="s">&quot;#ffffff&quot;</span> <span class="na">transform=</span><span class="s">&quot;translate(1924.7,548.29)&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>6 March<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;fr&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>6 mars<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;tr&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>6 Mart<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;it&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>6 marzo<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;ru&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>6 марта<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;pt&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>6 de Março<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;el&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>6 Μαρτίου<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;ca&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>6 de març<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text&gt;&lt;tspan&gt;</span>6 March<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/switch&gt;</span>
</pre></div>
<p>See <a rel="nofollow" class="external text" href="https://www.w3.org/TR/2011/REC-SVG11-20110816/coords.html#InterfaceSVGAnimatedTransformList">SVGAnimatedTransformList</a>. The API has a wonderful <code>.consolidate()</code> method. The API is incomplete. There is not a method to copy a transform or a list of transforms. Instead of using the API to concatenate two transform lists, it was easier to concatenate text strings:
</p>
<div class="mw-highlight mw-highlight-lang-javascript mw-content-ltr" dir="ltr"><pre><span></span><span class="nx">el2</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="nx">el1</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">el2</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">));</span>
</pre></div>
<h5><span class="mw-headline" id="Symbols">Symbols</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=105" title="Edit section: Symbols">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>There are more symbols to extract: air bases, harbors, and power plants.
</p><p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> Contested city
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:80x80-red-blue-anim.gif" title="File:80x80-red-blue-anim.gif">File:80x80-red-blue-anim.gif</a></li></ul>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The air base icon
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Fighter-jet-blue-icon.svg" title="File:Fighter-jet-blue-icon.svg">File:Fighter-jet-blue-icon.svg</a></li></ul>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The harbor icon
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Anchor_pictogram_blue.svg" title="File:Anchor pictogram blue.svg">File:Anchor pictogram blue.svg</a></li></ul>
<p><img alt="✓" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/15px-Yes_check.svg.png" decoding="async" title="✓" width="15" height="15" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/23px-Yes_check.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Yes_check.svg/30px-Yes_check.svg.png 2x" data-file-width="600" data-file-height="600" />&#160;<b><bdi>Done</bdi></b> The power plant icons have changed from their original form. The Ukrainian version is a solid fill rather than a gradient. The Russian version still has a gradient, but it is not prominent. If I use a solid fill, then they can be a single symbol and the fill can be determined with <code>class="uk"</code> or <code>class="ru"</code>.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Icon_NuclearPowerPlant-yellow.svg" title="File:Icon NuclearPowerPlant-yellow.svg">File:Icon NuclearPowerPlant-yellow.svg</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Icon_NuclearPowerPlant-red.svg" title="File:Icon NuclearPowerPlant-red.svg">File:Icon NuclearPowerPlant-red.svg</a></li></ul>
<p>Hydroelectric plant (not used?)
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:BSicon_STRl_blue.svg" title="File:BSicon STRl blue.svg">File:BSicon STRl blue.svg</a> check out Kaniv hydroelectric</li></ul>
<h5><span class="mw-headline" id="SVG_Translate_bogus_langtags">SVG Translate bogus langtags</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=106" title="Edit section: SVG Translate bogus langtags">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Change bogus <code>systemLanguage="zh_HANT"</code> to <code>systemLanguage="zh-HANT"</code>. Quick and dirty would select all the <code>systemLanguage</code> attributes and change underscores to hyphens. Killing bad langtags is good practice, but it will give horrible user interactions in SVG Translate. Users may continually try to translate a phrase that already has a translation. That would mean keeping both the bad langtag (to satisfy SVG Trnaslate) and the good langtag (to satisfy SVG). Then updates to the bad langtag would have to be copied to the good langtag. What a mess.
</p><p>SVG Translate seems to be duplicating clauses on subsequent invocations.
</p>
<h5><span class="mw-headline" id="Text_element_within_switches_with_coordinates">Text element within switches with coordinates</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=107" title="Edit section: Text element within switches with coordinates">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>I fixed a few <code>switch</code> element bodies that have translated text. Ideally, the <code>switch</code> element's <code>transform</code> property
sets the starting text position. The <code>text</code> element and its first <code>tspan</code> element should not have <code>x</code>, <code>y</code>, or
<code>transform</code> attributes.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch</span> <span class="na">id=</span><span class="s">&quot;switch4565-3-6-9&quot;</span> <span class="na">transform=</span><span class="s">&quot;translate(1354.865,893.27667)&quot;</span> <span class="na">class=</span><span class="s">&quot;place&quot;</span> <span class="na">font-size=</span><span class="s">&quot;5.34px&quot;</span>
      <span class="na">style=</span><span class="s">&quot;font-family:&#39;Liberation Sans&#39;, Arial, sans-serif;text-anchor:middle;fill:#0044aa&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span> <span class="na">id=</span><span class="s">&quot;trsvg2351-1-1-88&quot;</span> <span class="na">x=</span><span class="s">&quot;11.933496&quot;</span> <span class="na">y=</span><span class="s">&quot;1.381068&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan17037-0-9-2&quot;</span><span class="nt">&gt;</span>Vysokopillia<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
    <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text4206-2-uk-1-5&quot;</span> <span class="na">inkscape:label=</span><span class="s">&quot;text4206-2&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;uk&quot;</span> <span class="na">x=</span><span class="s">&quot;12&quot;</span> <span class="na">y=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan16021-7-uk-5-0&quot;</span><span class="nt">&gt;</span>Високопілля<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
    <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text4206-2-7-94&quot;</span> <span class="na">inkscape:label=</span><span class="s">&quot;text4206-2&quot;</span> <span class="na">x=</span><span class="s">&quot;12&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan16021-7-6-0&quot;</span><span class="nt">&gt;</span>Vysokopillia<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/switch&gt;</span>
</pre></div>
<p>The problem may be common enough so I should try to detect it.
</p>
<ul><li><code>switch/text[x] | switch/text[y] | switch/text[transform]</code></li>
<li><code>switch/text[x or y or transform]</code></li></ul>
<h5><span class="mw-headline" id="Elements_with_redundant_style_information">Elements with redundant <code>style</code> information</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=108" title="Edit section: Elements with redundant style information">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Replace <code>style</code> attribute with equivalent <code>class</code> value.
</p><p>Perhaps hoist information to the parent <code>switch</code> element.
</p>
<h4><span class="mw-headline" id="A_better_understanding_of_casual_group_formatting">A better understanding of casual group formatting</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=109" title="Edit section: A better understanding of casual group formatting">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The file uses casual groups to impose a common style on items that do not make their own sensible group. For example, a small set of Ukrainian villages may be grouped to impose a Ukrainian <code>fill</code> color on the group. The group of villages does not have a good reason to exist as a group. If the Russians gained control of one of the villages, then the group would need to be pierced to change its rendering.
</p><p>Similarly, several text elements may be grouped to impose a common font selection, size, or color. That is presentation style rather than semantics, and it should be done with CSS.
</p><p>Many of the formatting groups have been removed from cities, places, and dates. That puts the city circles at toplevel. The places are one-level down inside a group of places. The dates are one-level down inside a group of dates.
</p><p>There are elements that should be grouped, and they should be grouped to the point of making a symbol. For example, contested cities are represented as a checkerboard. The checkerboard is four grouped path elements followed by an outside-the-group rectangle. All of those elements are semantically related, and they should be a symbol in the <code>defs</code> section. These groups have been converted to use a <code>g</code> or <code>symbol</code> inside the <code>defs</code> element. That step uncovered some issues. The origin for an SVG 1.1 <code>symbol</code> is always the upper-left corner. Furthermore, Inkscape has trouble cloning something that is inside the <code>defs</code> element.
</p><p>Some groupings would make sense. The circles used for cities should be grouped with the names of the city. The symbols used for nuclear power plants should be grouped with the name of the power plant. The arrows showing the troop movements should be grouped with their dates. The date label boxes should be grouped with the date text.
</p><p>SVG does not have the notion of associated labels. Consider a flag note that contains a date. The file does that by drawing a rectangle and then overlaying that rectangle with text. That takes two elements. Logically, the elements should be grouped so they move together. To change the text, one must penetrate the grouping.
</p><p>Given the restrictions on the symbol origin, a possibility for dates would be
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;g</span> <span class="na">transform=</span><span class="s">&quot;translate(...)&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">&quot;#labelru&quot;</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;switch</span> <span class="na">class=</span><span class="s">&quot;date&quot;</span> <span class="na">fill=</span><span class="s">&quot;fff&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>March 15<span class="nt">&lt;/text&gt;</span>
    <span class="nt">&lt;text&gt;</span>March 15<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;/switch&gt;</span>
<span class="nt">&lt;/g&gt;</span>
</pre></div>
<p>So all the group's children are at the origin. A symbol would need a negative offset. Limitations on the WMF renderer prevents using CSS to set the <code>text</code> color.
</p><p>An alternative is to use a <code>filter</code> on the text. The filter would automatically size for the text, so it could be better than a fixed label size. Inkscape may start making copies....
</p><p>Does Inkscape's notion of layers allow easy editing? That is, does it avoid the cumbersome ungrouping and regrouping of an ordinary <code>g</code> element?
</p><p>What does it take to make an Inkscape layer? Presumably toplevel <code>g</code> elements with two <code>inkscape:</code> attributes and an <code>id</code> of the form <code>layer<i>n</i></code> (just like Inkscape identifies all its elements).<sup id="cite_ref-29" class="reference"><a href="#cite_note-29">&#91;29&#93;</a></sup>
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;g</span>
  <span class="na">inkscape:label=</span><span class="s">&quot;Layer 1&quot;</span>
  <span class="na">inkscape:groupmode=</span><span class="s">&quot;layer&quot;</span>
  <span class="na">id=</span><span class="s">&quot;layer1&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
<p>To use layers, must all graphics elements be in toplevel layers? If not, what happens to graphics elements that are outside of the layers?
</p><p>Furthermore, removing the two attributes or the <code>id</code> may not be wise.
</p><p>Layers and objects can be locked with <code>sodipodi:insensitive="true"</code>; it is the presence of the attribute and not its value that matters. See <a rel="nofollow" class="external free" href="https://wiki.inkscape.org/wiki/Inkscape-specific_XML_attributes">https://wiki.inkscape.org/wiki/Inkscape-specific_XML_attributes</a> and example at <a rel="nofollow" class="external free" href="https://gist.github.com/hedefalk/5b428772f7deefc906a194f297371e9e">https://gist.github.com/hedefalk/5b428772f7deefc906a194f297371e9e</a> . The latter file suggests the group <code>id</code> does not need a layer name.
</p><p>See also <a rel="nofollow" class="external free" href="https://wiki.inkscape.org/wiki/index.php/Inkscape_SVG_vs._plain_SVG">https://wiki.inkscape.org/wiki/index.php/Inkscape_SVG_vs._plain_SVG</a> .
</p><p>Inkscape has the notion of symbols and clones, but I'm not sure that it expects to clone objects in the <code>defs</code> section. What sort of access does Inkscape give to the <code>defs</code> section?
</p><p>Layers would do a better job of enforcing painting order. While the order was consistent, it is now confused. Some arrows are drawn before place names are rendered, and some arrows are drawn after.
</p>
<h4><span class="mw-headline" id="Languages:_LTR_and_RTL">Languages: LTR and RTL</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=110" title="Edit section: Languages: LTR and RTL">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The Hebrew and Arabic versions of this file swap the graphics on the map legend. There is also a cosmology illustration that does something similar. What is a good way to handle that problem? Two separate map legends?
</p>
<h4><span class="mw-headline" id="Metadata_for_the_file">Metadata for the file</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=111" title="Edit section: Metadata for the file">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Consider adding some metadata to the file. There was a recent comment that Inkscape prevented a user from editing someone else's SVG. Could that be a result of CC-BY-ND license? Or describing the license with a similar requirement? How could SVG Translate figure that out? How would it be handled in a production environment?
</p><p>A CC license should have a URL link to the license.
</p><p>A CC-BY license should have the attribution names or an attribution URL.
</p><p>In a derivative work, it is not enough to just give attribution to the creator of the derivative work. The license attribution requirements do not disappear for a derivative work. Many Commons files state incomplete attributions.
</p><p>There is a question about crediting the source maps. It may be that a link to their pages on Commons is enough. Should the metadata include the license information for the images that the derivative work uses?
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;metadata&gt;</span>
  <span class="nt">&lt;rdf:RDF</span> <span class="na">xmlns:rdf=</span><span class="s">&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
           <span class="na">xmlns:dc=</span><span class="s">&quot;http://purl.org/dc/terms/&quot;</span>
           <span class="na">xmlns:cc=</span><span class="s">&quot;http://creativecommons.org/ns#&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;cc:Work</span> <span class="na">rdf:about=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;dc:creator</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://commons.wikimedia.org/wiki/User_talk:Viewsridge&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;dc:source&gt;</span>
        <span class="nt">&lt;rdf:Bag&gt;</span>
          <span class="nt">&lt;rdf:li</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://commons.wikimedia.org/wiki/File:Russo-Ukraine_Conflict_(2014-2021).svg&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;rdf:li</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://commons.wikimedia.org/wiki/File:Ukraine_adm_location_map.svg&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/rdf:Bag&gt;</span>
      <span class="nt">&lt;/dc:source&gt;</span>
      <span class="nt">&lt;dc:publisher</span> <span class="na">rdf:resource=</span><span class="s">&quot;http://commons.wikimedia.org&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;cc:license</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://creativecommons.org/licenses/by-sa/4.0/deed.en&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;cc:attributionName&gt;</span>
        <span class="nt">&lt;rdf:Seq&gt;</span>
          <span class="nt">&lt;rdf:li</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://commons.wikimedia.org/wiki/User_talk:Viewsridge&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;rdf:li</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://commons.wikimedia.org/wiki/User:Rr016&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;rdf:li</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://commons.wikimedia.org/wiki/User:NordNordWest&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/rdf:Seq&gt;</span>
      <span class="nt">&lt;/cc:attributionName&gt;</span>
      <span class="nt">&lt;cc:attributionUrl</span> <span class="na">rdf:resource=</span><span class="s">&quot;https://commons.wikimedia.org/wiki/File:2022_Russian_invasion_of_Ukraine.svg&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/cc:Work&gt;</span>
  <span class="nt">&lt;/rdf:RDF&gt;</span>
<span class="nt">&lt;/metadata&gt;</span>
</pre></div>
<h2><span class="mw-headline" id="SVG_Translate">SVG Translate</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=112" title="Edit section: SVG Translate">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>SVG Translate is an application that helps users translate SVG files with <code>text</code> elements into other languages.
</p><p>Discuss history, Summer of Code, ... XXX, <a href="https://commons.wikimedia.org/wiki/User:Jarry1250" title="User:Jarry1250">Jarry1250</a>,<sup id="cite_ref-30" class="reference"><a href="#cite_note-30">&#91;30&#93;</a></sup> WMF Community Tech.<sup id="cite_ref-31" class="reference"><a href="#cite_note-31">&#91;31&#93;</a></sup>
</p><p>What it does.
</p><p>Diagrams need to be simple for it to work well. Single line text is best. Leave plenty of room because some languages use more text than others.
</p><p>See <a href="https://commons.wikimedia.org/wiki/File:BirdBeaksA.svg" title="File:BirdBeaksA.svg">File:BirdBeaksA.svg</a> and <a href="https://commons.wikimedia.org/wiki/Template:Other_versions/BirdBeaksA" title="Template:Other versions/BirdBeaksA"><span style="font-family:monospace,monospace;">&#123;&#123;Other versions/BirdBeaksA&#125;&#125;</span></a>. Several language versions that just vary the text labels.
</p><p>Syntactically, the text to translate must be a <code>text</code> element with 0 or more <code>tspan</code> elements. The <code>tspan</code> elements may not have any children. The tool expects only text; it does not expect <code>switch</code> elements containing group (<code>g</code>) elements or other graphics elements.  
</p><p>What it does not do.
</p><p>It does not handle complex text. It expects text to be lines of simple, unadorned, text. Text that tries to emphasize some words with bold or italic styles are not handled. Similarly, it does not handle changing text colors or fonts. It does not handle subscripts or superscripts.
</p><p>It does not handle adjusting the position of the text or the anchors. That is more of a graphics task than a translation task. SVG Translate is a text rather than a graphics application. In commercial translation settings, translators are not responsible for text positioning.
</p><p>Vertical text. There are different conventions. In the USA, a book title on the book's spine is rotated +90&#176;. In Europe, the title on the spine is rotated -90&#176;. In China, text is written vertically without rotating the characters; generally, English readers find such text difficult. Bizzare Chinese ambulance.
</p><p>Numbers, currency, and dates. SVG should have better support. Javascript has Intl, but Commons prohibits scripts. Translation from English "May 12, 1944" to German "12 Mai 1944". HTML has <code>&lt;time datetime="1944-05-12"&gt;May 12, 1944&lt;/time&gt;</code>, but it does not imply processing; it is just a machine readable time.
</p><p>Exotic CSS can fix some issues, but there must be support.
</p>
<h3><span class="mw-headline" id="SVG_Translate_usage">SVG Translate usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=113" title="Edit section: SVG Translate usage">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><a href="https://commons.wikimedia.org/wiki/User:JoKalliauer" title="User:JoKalliauer">JoKalliauer</a> question about SVG Translate usage:
<a class="external text" href="https://commons.wikimedia.org/w/index.php?title=User_talk:JoKalliauer&amp;oldid=684845987#Editing_error_in_c:File:2022_Russian_invasion_of_Ukraine.svg">talk page</a>
</p>
<h3><span id="Translate_me.21"></span><span class="mw-headline" id="Translate_me!">Translate me!</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=114" title="Edit section: Translate me!">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Consider mechanism to solicit translations of popular or significant images.
</p>
<h3><span class="mw-headline" id="Good_translation_targets">Good translation targets</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=115" title="Edit section: Good translation targets">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There are English SVG files that are already included on many Wikipedias. Running SVG Translate on these files would make the files more accessible.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Eukaryote_DNA-en.svg" title="File:Eukaryote DNA-en.svg">File:Eukaryote DNA-en.svg</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Endomembrane_system_diagram_en.svg" title="File:Endomembrane system diagram en.svg">File:Endomembrane system diagram en.svg</a> many separate translations; one invocation of SVG Translate.</li>
<li><a href="https://commons.wikimedia.org/wiki/File:Larynx_external_en.svg" title="File:Larynx external en.svg">File:Larynx external en.svg</a> (has Wikdata template)</li></ul>
<h3><span class="mw-headline" id="SVG_Translate_Issues">SVG Translate Issues</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=116" title="Edit section: SVG Translate Issues">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li><a class="external free" href="https://phabricator.wikimedia.org/tag/svg_translate_tool/">https://phabricator.wikimedia.org/tag/svg_translate_tool/</a></li></ul>
<p>clean code.
</p><p>The resulting file has lots of identifiers.
</p><p>SVG Translate does not obey <code>translate="no"</code>.
</p>
<h4><span class="mw-headline" id="The_default_clause_problem">The default clause problem</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=117" title="Edit section: The default clause problem">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<div class="tracked plainlinks mw-trackedTemplate"><link rel="mw-deduplicated-inline-style" href="https://commons.wikimedia.org/wiki/mw-data:TemplateStyles:r649510686"/>Tracked in <a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Phabricator" class="extiw" title="mw:Special:MyLanguage/Phabricator">Phabricator</a><br /><b><a href="https://phabricator.wikimedia.org/T312907" class="extiw" title="phabricator:T312907"><span class="tracked-url trakfab-T312907">Task T312907</span></a></b><br /><span class="status"></span></div>
<p>The tool does not work well with language preferences. Adding a German translation to
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;text&gt;</span>Hello, world<span class="nt">&lt;/text&gt;</span>
</pre></div></dd></dl>
<p>produces something similar to
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;de&quot;</span><span class="nt">&gt;</span>Hallo Welt.<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text&gt;</span>Hello, world.<span class="nt">&lt;/text&gt;</span>
<span class="nt">&lt;/text&gt;</span>
</pre></div></dd></dl>
<p>That works OK with WMF tools, but can be bizarre when displayed in a browser. For example, one can set a browser to prefer English but accept German. In that circumstance, the English language text should be displayed, but the SVG above will display German. The SVG agent does not know the default is English. The translation should be
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>Hello, World.<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;de&quot;</span><span class="nt">&gt;</span>Hallo Welt.<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;text&gt;</span>Hello, world.<span class="nt">&lt;/text&gt;</span>
<span class="nt">&lt;/text&gt;</span>
</pre></div></dd></dl>
<p>The fix is to copy the default clause, add <code>systemLanguage="en"</code>, and then insert that element into the <code>switch</code> element. The <code>insertNodeBefore(<i>newNode</i>, <i>referenceNode</i>)</code>. The SVG DOM method <code>.cloneNode(<i>deep</i>)</code> copies the <code>id</code> attribute, so the identifiers must be changed or removed.
</p>
<h4><span class="mw-headline" id="Autocomplete">Autocomplete</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=118" title="Edit section: Autocomplete">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Input boxes get filled in with previous inputs even if for a different file.
Turn off autocommplete?
</p>
<ul><li><a rel="nofollow" class="external free" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/autocomplete">https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/autocomplete</a></li></ul>
<h4><span class="mw-headline" id="SVG_Translate_should_handle_textPath">SVG Translate should handle <code>textPath</code></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=119" title="Edit section: SVG Translate should handle textPath">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The Gibraltar map has a <code>textPath</code> element.
</p><p>Treat <code>textPath</code> as equivalent to <code>tspan</code>.
</p><p>IIRC, mentioned in some Phabricator issue.
</p><p>Possible add another test to reject <code>textPath</code> similar to this test:
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="191"></span>        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">!==</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">document</span><span class="o">-&gt;</span><span class="na">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;tref&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">length</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="192"></span>            <span class="c1">// Tref tags not (yet) supported</span>
<span class="linenos" data-line="193"></span>            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">logFileProblem</span><span class="p">(</span><span class="s1">&#39;File {file} has &lt;tref&gt; tags&#39;</span><span class="p">);</span>
<span class="linenos" data-line="194"></span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="linenos" data-line="195"></span>        <span class="p">}</span>
</pre></div>
<h4><span class="mw-headline" id="SVG_Translate_descends_too_deeply">SVG Translate descends too deeply</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=120" title="Edit section: SVG Translate descends too deeply">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>SVG Translate does not recognized planar translations. If it sees a <code>switch</code> element with <code>systemLanguage</code> clauses, then it should not process that subtree.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch&gt;</span>
  <span class="nt">&lt;g</span> <span class="na">systemLanguage=</span><span class="s">&quot;tlh&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;text&gt;</span>Klingon text cannot be translated to any other language<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;/g&gt;</span>
  <span class="nt">&lt;g&gt;</span>
    <span class="nt">&lt;text&gt;</span>Default text can be translated, but it will be ugly<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;/g&gt;</span>
<span class="nt">&lt;/switch&gt;</span>
</pre></div>
<p>SVG Translate does not walk the tree, so it does not notice the problem. Instead, it fetches elements no matter their location in the with operations such as
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr" dir="ltr"><pre><span></span>        <span class="nv">$texts</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">document</span><span class="o">-&gt;</span><span class="na">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">);</span>
</pre></div>
<p>If the elements have an ancestor with a <code>systemLanguage</code> attribute, then it should not process the element; the element's ability to be translated has been foreclosed already.
</p><p>Where did I write about this before?
</p>
<h4><span id="Does_SVG_Translate_multiply_text.3F_No."></span><span class="mw-headline" id="Does_SVG_Translate_multiply_text?_No.">Does SVG Translate multiply text? No.</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=121" title="Edit section: Does SVG Translate multiply text? No.">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>To simply matters with language matching, SVG Translate explodes a <code>systemLanguage</code> attribute with a language list.
A single element with three langtags is morphed into three elements with a single langtag.
</p><p>SVG allows elements with <code>systemLanguage</code> attributes anywhere; they need not be inside a switch.
</p><p>Check that the combination of the two operations is safe or at least harmless. Maybe it is always harmless? If text is wrapped in a <code>switch</code> before being copied, then it should be harmless?
</p><p>The fear is isolated text with <code>systemLanguage="en, en-US, en-GB"</code> gets duplicated three times.
</p><p>Not a problem. The explosion is at line 370, and it is done while processing the children of a <code>switch</code>.
</p>
<ul><li><a rel="nofollow" class="external free" href="https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php">https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php</a></li></ul>
<h4><span class="mw-headline" id="SVG_Translate_switch_processing">SVG Translate <code>switch</code> processing</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=122" title="Edit section: SVG Translate switch processing">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:SVG_Switch_Test.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/SVG_Switch_Test.svg/220px-SVG_Switch_Test.svg.png" decoding="async" width="220" height="77" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/SVG_Switch_Test.svg/330px-SVG_Switch_Test.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/SVG_Switch_Test.svg/440px-SVG_Switch_Test.svg.png 2x" data-file-width="512" data-file-height="179" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:SVG_Switch_Test.svg" class="internal" title="Enlarge"></a></div>The second line is a <code>switch</code> with annotation elements <code>title</code>, <code>desc</code>, and <code>metadata</code>.</div></div></div>
<p>SVG permits more than just <code>text</code> elements within a <code>switch</code>.
In particular, <code>title</code>, <code>desc</code>, <code>metadata</code>, and comments should not confuse processing.
Less likely but still permitted elements are <code>metadata</code> and animation elements.
</p><p>Does the sorting of hyphenated langtags come into play? The <code>title</code> element should be first for many SVG agents.
</p><p>Run SVG Translate:
</p>
<ul><li><a class="external free" href="https://svgtranslate.toolforge.org/File:SVG_Switch_Test.svg">https://svgtranslate.toolforge.org/File:SVG_Switch_Test.svg</a></li></ul>
<p>Looks like SVG Translate works on line 2.
</p><p>What is going on? The method <code>makeTranslationReady()</code> (line 136)
</p>
<ul><li>does a bunch of stuff not relevant here</li>
<li>loops through all the <code>switch</code> tags at line 329.</li>
<li>looks at the childNodes of the switch (it could just look at elements)</li>
<li>returns false if the childnode is a non-empty <code>#text</code> node.</li>
<li>returns false if the childnode is not an element. So a PI or comment should return false.</li>
<li>returns false if the childnode is not a <code>text</code> element.</li>
<li>examines <code>systemLanguage</code></li>
<li>explodes if <code>systemLanguage</code> is multivalued.</li></ul>
<p>I understood that <code>makeTranslationReady()</code> returning false nixes the translation of the whole file.
</p><p>Maybe not.
Look at <code>_construct()</code>. The last line is the call to <code>makeTranslationReady()</code>, but it does not check the result.
Looks like somebody does not check <code>isTranslationReady()</code>.
</p><p>I should split the test file into three files. KISS.
</p>
<div style="clear:both;"></div>
<h4><span class="mw-headline" id="Check_switch_processing">Check <code>switch</code> processing</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=123" title="Edit section: Check switch processing">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul><li><a rel="nofollow" class="external free" href="https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php">https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php</a></li></ul>
<p>IETF lowercase at 293, but only to <code>text</code> elements.
</p><p>At line 324, all the <code>switch</code> elements are grabbed. (No namespace check.)
</p><p>Then all child nodes are examined at line 329.
</p><p>(DOMElement <a rel="nofollow" class="external free" href="https://www.php.net/manual/en/class.domelement.php">https://www.php.net/manual/en/class.domelement.php</a> does not have <code>$children</code>, so code must use <code>$childNodes</code>.)
</p><p>Non-empty text nodes cause a problem at line 337; return false.
</p><p>Non-element nodes cause a problem at line 344; return false. Does this mean a comment node returns false?
</p><p>If the child is not a <code>text</code> element, it fails at line 349. That should kill <code>title</code>, <code>desc</code>, <code>metadata</code>, and animation elements, but I thought they were getting through....
</p><p>Language split is at 356. It only happens inside a <code>switch</code>. That should answer the isolated <code>systemLanguage</code> element question.
</p><p>An explosion will increase the number of <code>text</code> elements in the live list, so some will be missed.
</p>
<h4><span class="mw-headline" id="DOM:_tags_and_namespace">DOM: tags and namespace</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=124" title="Edit section: DOM: tags and namespace">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:SVG_Translate_test_namespace.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/SVG_Translate_test_namespace.svg/220px-SVG_Translate_test_namespace.svg.png" decoding="async" width="220" height="28" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/SVG_Translate_test_namespace.svg/330px-SVG_Translate_test_namespace.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/SVG_Translate_test_namespace.svg/440px-SVG_Translate_test_namespace.svg.png 2x" data-file-width="512" data-file-height="64" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:SVG_Translate_test_namespace.svg" class="internal" title="Enlarge"></a></div>file that uses arbitrary prefix for the SVG namespace.</div></div></div>
<p>The DOM distinguishes
</p>
<ul><li><code>nodeName</code></li>
<li><code>localName</code></li>
<li><code>namespaceURI</code></li></ul>
<p>A <code>nodeName</code> may or may not have a prefix.
</p><p>The tag name has some interesting capitalization issues for HTML, but that is not relevant here. In the case of just HTML, there is only one namespace, so the name ambiguity is not as important.
</p>
<ul><li><a rel="nofollow" class="external free" href="https://dom.spec.whatwg.org/#concept-getelementsbytagname">https://dom.spec.whatwg.org/#concept-getelementsbytagname</a></li></ul>
<p>The specification says that <code>getElementsbyTagName()</code> searches for a qualified name. <a rel="nofollow" class="external free" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/tagName">https://developer.mozilla.org/en-US/docs/Web/API/Element/tagName</a> says that the tag name for an element is the <code>nodeName</code>. So what does a DOM implementation return? In an SVG file, if I ask for <code>"text"</code>, do I get all the nodes in the default namespace? That is, those names do not need prefixes. Do I get the same nodes if I ask for <code>"svg:text"</code>? Do some implementations simply provide all the elements with the <code>localName</code> and ignore the namespace?
</p><p>In particular, I think qualified names can vary depending on the context. It is possible to set the default namespace for a subtree.
</p><p>The method <code>getElementsByTagNameNS()</code> is far clearer. It looks for elements with the <code>localName</code> and in the <code>namespaceURI</code>. An implementation is not going to mess that up. It also does not depend on which prefixes are active.
</p><p>I expected this to fail. It may work even if it fails.
</p>
<ul><li><a class="external free" href="https://svgtranslate.toolforge.org/File:SVG_Translate_test_namespace.svg">https://svgtranslate.toolforge.org/File:SVG_Translate_test_namespace.svg</a></li></ul>
<p>I added a <code>rdf:text</code> element. SVG Translate wrapped the <code>.textContent</code> with a <code>tspan</code> element in the SVG namespace, but it did not offer the text to be translated (the elements never got <code>id</code> attributes.
</p><p>Looking at the code, the <code>rdf:text</code> element was found at line 201:
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="197"></span>        <span class="c1">// Strip empty tspans, texts, fill $idsInUse</span>
<span class="linenos" data-line="198"></span>        <span class="nv">$idsInUse</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span> <span class="p">];</span>
<span class="linenos" data-line="199"></span>        <span class="nv">$translatableNodes</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos" data-line="200"></span>        <span class="nv">$tspans</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">document</span><span class="o">-&gt;</span><span class="na">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;tspan&#39;</span><span class="p">);</span>
<span class="linenos" data-line="201"></span>        <span class="nv">$texts</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">document</span><span class="o">-&gt;</span><span class="na">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">);</span>
</pre></div>
<p>So the PHP DOM implementation looks for the <code>localName</code>.
</p><p>The source for PHP
</p>
<ul><li><a rel="nofollow" class="external free" href="https://github.com/php/php-src/blob/master/ext/dom/element.c">https://github.com/php/php-src/blob/master/ext/dom/element.c</a></li></ul>
<p>cites to the spec
</p>
<ul><li><a rel="nofollow" class="external free" href="http://www.w3.org/TR/2003/WD-DOM-Level-3-Core-20030226/DOM3-Core.html#core-ID-1938918D">http://www.w3.org/TR/2003/WD-DOM-Level-3-Core-20030226/DOM3-Core.html#core-ID-1938918D</a></li></ul>
<p>which only claims the search is by "tag name" but does not define that term. The namespace version is explicit about using <code>localName</code>. So using the non-namespace version for an XML document is not a good idea.
</p><p>It also becomes clear that the identifier assignment believes that <code>trsvg[0-9]+</code> identifiers will only appear on <code>text</code> and <code>tspan</code> elements. Also, the code does not need to keep the entire set of attributes around.
</p>
<h4><span id="Is_the_svg_prefix_required.3F"></span><span class="mw-headline" id="Is_the_svg_prefix_required?">Is the <code>svg</code> prefix required?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=125" title="Edit section: Is the svg prefix required?">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<div class="tracked plainlinks mw-trackedTemplate"><link rel="mw-deduplicated-inline-style" href="https://commons.wikimedia.org/wiki/mw-data:TemplateStyles:r649510686"/>Tracked in <a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Phabricator" class="extiw" title="mw:Special:MyLanguage/Phabricator">Phabricator</a><br /><b><a href="https://phabricator.wikimedia.org/T316741" class="extiw" title="phabricator:T316741"><span class="tracked-url trakfab-T316741">Task T316741</span></a></b><br /><span class="status"></span></div>
<p><a href="https://phabricator.wikimedia.org/T316741" class="extiw" title="phab:T316741">Phab:T316741</a> (Allow svg namespace prefixes other than 'svg') was opened.
</p><p>I see a lot of tests that are something like <code>('svg:element' === $el-&gt;nodeName)</code>.
Does that mean the code depends on files using the <code>svg:</code> prefix?
Does using <code>xmlns:foo="<a rel="nofollow" class="external free" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>"</code> and <code>&lt;foo:text&gt;</code> confuse SVG Translate?
</p><p>Is the problem with the PHP DOM or with the code?
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.php.net/manual/en/class.domnode.php">https://www.php.net/manual/en/class.domnode.php</a></li></ul>
<p>Should tests such as
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr" dir="ltr"><pre><span></span>                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;tspan&#39;</span> <span class="o">===</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="na">nodeName</span> <span class="o">||</span> <span class="s1">&#39;svg:tspan&#39;</span> <span class="o">===</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="na">nodeName</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span>
</pre></div>
<p>be written
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr" dir="ltr"><pre><span></span>                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;tspan&#39;</span> <span class="o">===</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="na">localName</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span> <span class="o">===</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="na">namespaceURI</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span>
</pre></div>
<p>If a file does not use the SVG namespace, then SVG Translate may refuse to translate it.
</p><p>Programming idioms from when the PHP DOM did not do namespaces?
</p>
<h4><span class="mw-headline" id="Reorder_text_elements">Reorder <code>text</code> elements</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=126" title="Edit section: Reorder text elements">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Sorting the langtags so the hyphenated langtags come first.
</p><p>Is it needed?
</p><p>Does it compromise SVG 1.1 semantics? If I ask for <code>en-GB</code>, then it should not match the <code>en</code> clause.
</p><p>If I promote <code>en-RAREDIALECT</code> to first position in the clauses, then asking for generic <code>en</code> gives me the rare dialect.
</p><p>The only good way around this is <code>allowReorder</code>.
</p><p>With the underscore, it would work around the old <code>librsvg</code> langtag matching bug.
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr" dir="ltr"><pre><span></span><span class="sd">/**</span>
<span class="sd"> * Reorder text elements within the document so that all sublocales (i.e. systemLanguage values</span>
<span class="sd"> * containing a hyphen or underscore, e.g. de_CH) are moved to the beginning of the switch</span>
<span class="sd"> * element, and all fallback elements are moved to the end.</span>
<span class="sd"> */</span>
<span class="k">protected</span> <span class="k">function</span> <span class="nf">reorderTexts</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
</pre></div>
<h4><span class="mw-headline" id="The_underscore_issue">The underscore issue</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=127" title="Edit section: The underscore issue">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<div class="tracked plainlinks mw-trackedTemplate"><link rel="mw-deduplicated-inline-style" href="https://commons.wikimedia.org/wiki/mw-data:TemplateStyles:r649510686"/>Tracked in <a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Phabricator" class="extiw" title="mw:Special:MyLanguage/Phabricator">Phabricator</a><br /><b><a href="https://phabricator.wikimedia.org/T271000" class="extiw" title="phabricator:T271000"><span class="tracked-url trakfab-T271000">Task T271000</span></a></b><br /><span class="status"></span></div>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:SVG_Switch_Test.svg" class="image"><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/SVG_Switch_Test.svg/220px-SVG_Switch_Test.svg.png" decoding="async" width="220" height="77" class="thumbimage" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/SVG_Switch_Test.svg/330px-SVG_Switch_Test.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/SVG_Switch_Test.svg/440px-SVG_Switch_Test.svg.png 2x" data-file-width="512" data-file-height="179" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://commons.wikimedia.org/wiki/File:SVG_Switch_Test.svg" class="internal" title="Enlarge"></a></div>The third line is a <code>switch</code> with en, zh_Hans, zh-Hant, and default clauses.</div></div></div>
<p>SVG Translate uses parochial <code>systemLanguage</code> identifiers instead of IETF langtags. This bug arises as a workaround to langtag processing bugs in <code>librsvg</code> and langtag passing methods in MediaWiki. First, the C-language version of <code>librsvg</code> that WMF uses only matches langtags to the first hyphen. It treats <code>zh-Hans</code> and <code>zh-Hant</code> as equivalent. Second, MediaWiki passes langtags in the <code>LANG</code> environment variable; that variable expects a locale string rather than an IETF langtag. Third, <code>librsvg</code> uses the <code>LANG</code> environment variable as a langtag. SVG Translate exploits those problems by using <code>zh_HANS</code> rather than the correct <code>zh-Hant</code> IETF langtag. It makes the display work on (broken) WMF servers, but the SVG files do not work on other SVG user agents.
</p><p>The underscore issue is even more twisted. Multiple SVG Translate invocations are adding multiple identical clauses with non-unique identifiers:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch</span> <span class="na">id=</span><span class="s">&quot;switch2174&quot;</span> <span class="na">transform=</span><span class="s">&quot;translate(1853.7,532.54)&quot;</span> <span class="na">class=</span><span class="s">&quot;place&quot;</span> <span class="na">font-size=</span><span class="s">&quot;5.34px&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-zh-tw&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_TW&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-zh-tw&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-zh-hant&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_HANT&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-zh-hant&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-zh-tw&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_TW&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-zh-tw&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-zh-hant&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_HANT&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-zh-hant&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text6217&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_TW&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan6215&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text6221&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_HANT&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan6219&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text6225&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_TW&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan6223&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text6229&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_HANT&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan6227&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text6233&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_TW&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan6231&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text6237&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_HANT&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan6235&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text6241&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_TW&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan6239&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text6245&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_HANT&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan6243&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text6249&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;zh_HANT&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;tspan6247&quot;</span><span class="nt">&gt;</span>基夫沙里夫卡<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
     
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span> <span class="na">id=</span><span class="s">&quot;trsvg1842&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg1218&quot;</span><span class="nt">&gt;</span>Kivsharivka<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-it&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;it&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-it&quot;</span><span class="nt">&gt;</span>Kovšarovka<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-fr&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;fr&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-fr&quot;</span><span class="nt">&gt;</span>Kivcharivka<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-el&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;el&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-el&quot;</span><span class="nt">&gt;</span>Κιβσαρίφσκα<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-ru&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;ru&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-ru&quot;</span><span class="nt">&gt;</span>Ковшаровка<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-uk&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;uk&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-uk&quot;</span><span class="nt">&gt;</span>Ківшарівка<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-ka&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;ka&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-ka&quot;</span><span class="nt">&gt;</span>კივშარივკა<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-lt&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;lt&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-lt&quot;</span><span class="nt">&gt;</span>Kivšarivka<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001-ca&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;ca&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142-ca&quot;</span><span class="nt">&gt;</span>Kivxàrivka<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;text3001&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg142&quot;</span><span class="nt">&gt;</span>Kivsharivka<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/switch&gt;</span>
</pre></div>
<p>The relevant SVG Translate code:
</p>
<ul><li><a rel="nofollow" class="external text" href="https://github.com/wikimedia/svgtranslate/blob/913c447750ef16a023daed3681b3f57f39af29f1/src/Model/Svg/SvgFile.php">src/Model/Svg/SvgFile.php</a></li></ul>
<p>OK, it looks like a problem with inadvertently distinguishing equivalent langtags. The code mistakenly distinguishes <code>zh_hant</code>, <code>zh_Hant</code>, and <code>zh_HANT</code>.
</p><p>I believe <code>$language</code> will be lowercase because
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="431"></span>                <span class="nv">$langCode</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$lang</span><span class="p">));</span>
</pre></div>
<p>So the code reasonable canonizes all langtags to lower case and converts non-standard underscore langtags to hypen langtags.
</p><p>Consequently, the code below will work for all-lowercase langtags (such as the usual <code>en</code> or <code>de</code>) that are present in the SVG file, but it will never match langtags with an uppercase character (such as <code>zh-Hant</code>) because they have a capital letter. Furthermore, it will never match the converted, non-standard, langtags (such as <code>zh_HANT</code>) even with a case-insensitive match because the underscore was changed to a hyphen. Also notice that if two or more <code>text</code> elements match, then nothing will be changed, and no error will be logged.
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="605"></span>                <span class="c1">// Put text tag into document</span>
<span class="linenos" data-line="606"></span>                <span class="nv">$path</span> <span class="o">=</span> <span class="s1">&#39;fallback&#39;</span> <span class="o">===</span> <span class="nv">$language</span> <span class="o">?</span>
<span class="linenos" data-line="607"></span>                    <span class="s2">&quot;svg:text[not(@systemLanguage)]|text[not(@systemLanguage)]&quot;</span> <span class="o">:</span>
<span class="linenos" data-line="608"></span>                    <span class="s2">&quot;svg:text[@systemLanguage=&#39;</span><span class="si">$language</span><span class="s2">&#39;]|text[@systemLanguage=&#39;</span><span class="si">$language</span><span class="s2">&#39;]&quot;</span><span class="p">;</span>
<span class="linenos" data-line="609"></span>                <span class="nv">$existing</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">xpath</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="nv">$switch</span><span class="p">);</span>
<span class="linenos" data-line="610"></span>                <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="nv">$existing</span><span class="o">-&gt;</span><span class="na">length</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="611"></span>                    <span class="c1">// Only one matching text node, replace if different</span>
<span class="linenos" data-line="612"></span>                    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nodeToArray</span><span class="p">(</span><span class="nv">$newTextTag</span><span class="p">)</span> <span class="o">===</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nodeToArray</span><span class="p">(</span><span class="nv">$existing</span><span class="o">-&gt;</span><span class="na">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span> <span class="p">{</span>
<span class="linenos" data-line="613"></span>                        <span class="k">continue</span><span class="p">;</span>
<span class="linenos" data-line="614"></span>                    <span class="p">}</span>
<span class="linenos" data-line="615"></span>                    <span class="nv">$switch</span><span class="o">-&gt;</span><span class="na">replaceChild</span><span class="p">(</span><span class="nv">$newTextTag</span><span class="p">,</span> <span class="nv">$existing</span><span class="o">-&gt;</span><span class="na">item</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="linenos" data-line="616"></span>                <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="nv">$existing</span><span class="o">-&gt;</span><span class="na">length</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="617"></span>                    <span class="c1">// No matching text node for this language, so we&#39;ll create one</span>
<span class="linenos" data-line="618"></span>                    <span class="nv">$switch</span><span class="o">-&gt;</span><span class="na">appendChild</span><span class="p">(</span><span class="nv">$newTextTag</span><span class="p">);</span>
<span class="linenos" data-line="619"></span>                <span class="p">}</span>
</pre></div>
<p>OK, tried a file with <code>systemLanguage="FR"</code>, added a German translation, and the French clause was duplicated. SVG Translate produced:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span>    <span class="nt">&lt;switch</span> <span class="na">transform=</span><span class="s">&quot;translate(20, 60)&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;title&gt;</span>This title should display.<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;desc&gt;</span>Test that title, desc, and metadata process correctly.<span class="nt">&lt;/desc&gt;</span>
      <span class="nt">&lt;metadata/&gt;</span>
      <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;tlh&quot;</span> <span class="na">id=</span><span class="s">&quot;trsvg13&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg2&quot;</span><span class="nt">&gt;</span>Klingon<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
      <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;FR&quot;</span> <span class="na">id=</span><span class="s">&quot;trsvg14&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg3&quot;</span><span class="nt">&gt;</span>French<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
      <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span> <span class="na">id=</span><span class="s">&quot;trsvg15&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg4&quot;</span><span class="nt">&gt;</span>English<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
      <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg14&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;fr&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg3&quot;</span><span class="nt">&gt;</span>French<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
      <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg16-de&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;de&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg5-de&quot;</span><span class="nt">&gt;</span>German 2<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
      <span class="nt">&lt;text</span> <span class="na">id=</span><span class="s">&quot;trsvg16&quot;</span><span class="nt">&gt;&lt;tspan</span> <span class="na">id=</span><span class="s">&quot;trsvg5&quot;</span><span class="nt">&gt;</span>Default<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
    <span class="nt">&lt;/switch&gt;</span>
</pre></div>
<p>The basic issue above is the case-sensitive comparison in <code>text[@systemLanguage='$language']</code>. XPath 1.0 does not have a case-sensitive comparison. A possible fix is to modify the XPath filter to fix both the lowercase and the underscore issues:
</p>
<div class="mw-highlight mw-highlight-lang-xquery mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">text</span><span class="p">[</span><span class="nf">translate</span><span class="p">(</span><span class="na">@systemLanguage</span><span class="p">,</span> <span class="s2">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ_&quot;</span><span class="p">,</span> <span class="s2">&quot;abcdefghijklmnopqrstuvwxyz-&quot;</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;$language&#39;</span><span class="p">]</span>
</pre></div>
<p>There are still some questions about the code. How does <code>systemLanguage="zh_HANT"</code> enter? Are translation selections edited in the UI? And how does the file's <code>systemLanguage="zh-Hant"</code> turn into <code>systemLanguage="zh_HANT"</code>?
</p><p>Looks like this routine will change <code>zh-hant</code> into <code>zh_HANT</code>:
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="825"></span>    <span class="sd">/**</span>
<span class="linenos" data-line="826"></span><span class="sd">     * @param string $langCode</span>
<span class="linenos" data-line="827"></span><span class="sd">     * @return string</span>
<span class="linenos" data-line="828"></span><span class="sd">     */</span>
<span class="linenos" data-line="829"></span>    <span class="k">private</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">langCodeToOs</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$langCode</span><span class="p">)</span><span class="o">:</span> <span class="nx">string</span>
<span class="linenos" data-line="830"></span>    <span class="p">{</span>
<span class="linenos" data-line="831"></span>        <span class="k">if</span> <span class="p">(</span><span class="k">false</span> <span class="o">===</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$langCode</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-line="832"></span>            <span class="c1">// No territory specified, so no change to make (fr =&gt; fr)</span>
<span class="linenos" data-line="833"></span>            <span class="k">return</span> <span class="nv">$langCode</span><span class="p">;</span>
<span class="linenos" data-line="834"></span>        <span class="p">}</span>
<span class="linenos" data-line="835"></span>        <span class="p">[</span> <span class="nv">$prefix</span><span class="p">,</span> <span class="nv">$suffix</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="nv">$langCode</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="linenos" data-line="836"></span>        <span class="k">return</span> <span class="nv">$prefix</span><span class="o">.</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$suffix</span><span class="p">);</span>
<span class="linenos" data-line="837"></span>    <span class="p">}</span>
</pre></div>
<h4><span class="mw-headline" id="The_number_of_tspan_elements_must_match">The number of <code>tspan</code> elements must match</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=128" title="Edit section: The number of tspan elements must match">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Here's a <a href="https://phabricator.wikimedia.org/T216283#5106699" class="extiw" title="phab:T216283">Phab:T216283#5106699</a> discussing mismatching number of <code>tspan</code> elements.
</p><p>Somewhere there was a more specific problem where SVG Translate drops the <code>tspan</code>. Searching for it, but have not found it.
</p><p>Look in the code to find this requirement.
</p>
<ul><li><a rel="nofollow" class="external free" href="https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php">https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php</a></li></ul>
<p>IIRC, some code deletes empty <code>text</code> and <code>tspan</code>.
</p><p>In addition, I think there was a Phabricator item where an empty <code>tspan</code> was removed, and that cause subsequent translation problems.
</p><p>The trouble may be at line 254. All the translatable nodes (<code>text</code> and <code>tspan</code> elements) are scanned. If the element has no child nodes (which would be true for an empty <code>tspan</code>), then that element would be removed. Consider a two-line translation where some lines may be empty. This code will remove the empty line. When a translation on that <code>switch</code> is attempted, the number of <code>tspan</code> elements will not match.
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="254"></span>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$translatableNode</span><span class="o">-&gt;</span><span class="na">hasChildNodes</span><span class="p">())</span> <span class="p">{</span>
<span class="linenos" data-line="255"></span>                <span class="c1">// Empty tag, will just confuse translators if we leave it in</span>
<span class="linenos" data-line="256"></span>                <span class="nv">$translatableNode</span><span class="o">-&gt;</span><span class="na">parentNode</span><span class="o">-&gt;</span><span class="na">removeChild</span><span class="p">(</span><span class="nv">$translatableNode</span><span class="p">);</span>
<span class="linenos" data-line="257"></span>            <span class="p">}</span>
</pre></div>
<h4><span id="The_.24_issue"></span><span class="mw-headline" id="The_$_issue">The $ issue</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=129" title="Edit section: The $ issue">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<dl><dd><small><b>FIXED</b> <a rel="nofollow" class="external free" href="https://github.com/wikimedia/svgtranslate/pull/620">https://github.com/wikimedia/svgtranslate/pull/620</a></small></dd></dl>
<p>SVG Translate is supposed to refuse to translate text that has a dollar sign followed by a number (e.g., "$17").
</p><p>I suspect the code has a bug because it does not escape the <code>$</code> in the <code>preg_match</code> on line 288.
</p>
<ul><li><a rel="nofollow" class="external free" href="https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php">https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php</a></li></ul>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="285"></span><span class="c1">// Text strings like $1, $2 will cause problems later because</span>
<span class="linenos" data-line="286"></span><span class="c1">// self::replaceIndicesRecursive() will try to replace them</span>
<span class="linenos" data-line="287"></span><span class="c1">// with (non-existent) child nodes.</span>
<span class="linenos" data-line="288"></span><span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;/$[0-9]/&#39;</span><span class="p">,</span> <span class="nv">$text</span><span class="o">-&gt;</span><span class="na">textContent</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-line="289"></span>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">logFileProblem</span><span class="p">(</span><span class="s1">&#39;File {file} has text with $-numbers&#39;</span><span class="p">);</span>
<span class="linenos" data-line="290"></span>    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="linenos" data-line="291"></span><span class="p">}</span>
</pre></div>
<p>The issue was mentioned at <a href="https://phabricator.wikimedia.org/T271000#8134211" class="extiw" title="phab:T271000">Phab:T271000#8134211</a>. <cite>Bad language code: zh_Hans should be zh-Hans</cite>.
</p>
<h4><span class="mw-headline" id="The_style_element_must_have_trailing_characters">The <code>style</code> element must have trailing characters</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=130" title="Edit section: The style element must have trailing characters">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><a href="https://phabricator.wikimedia.org/T271595" class="extiw" title="phab:T271595">Phab:T271595</a> <cite>SVG translate tool replaces all fields with "$1" (style element needs at least one trailing character)</cite>
</p><p>What's left over after a failed media rule parse?
</p>
<ul><li><code>@media printer {  text { fill: black; }  }</code></li></ul>
<p>The regex match does not balance parentheses, so the second brace is collected as part of the ruleset. The trailing character is a right brace.
</p>
<h4><span class="mw-headline" id="Hoisting_style_attributes">Hoisting <code>style</code> attributes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=131" title="Edit section: Hoisting style attributes">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>At <a rel="nofollow" class="external free" href="https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php">https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php</a>
I hope this does not do what I think it does:
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="304"></span>            <span class="c1">// Non-translatable style elements on texts get lost, so bump up to switch</span>
<span class="linenos" data-line="305"></span>            <span class="k">if</span> <span class="p">(</span><span class="nv">$text</span><span class="o">-&gt;</span><span class="na">hasAttribute</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-line="306"></span>                <span class="nv">$style</span> <span class="o">=</span> <span class="nv">$text</span><span class="o">-&gt;</span><span class="na">getAttribute</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">);</span>
<span class="linenos" data-line="307"></span>                <span class="nv">$text</span><span class="o">-&gt;</span><span class="na">parentNode</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="nv">$style</span><span class="p">);</span>
<span class="linenos" data-line="308"></span>            <span class="p">}</span>
</pre></div>
<h4><span class="mw-headline" id="Splitting_langtags_duplicates_identifiers">Splitting langtags duplicates identifiers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=132" title="Edit section: Splitting langtags duplicates identifiers">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Splitting <code>systemLanguage</code> langtags duplicates <code>id</code> attributes:
</p>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="365"></span>                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$realLangs</span> <span class="k">as</span> <span class="nv">$realLang</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="366"></span>                    <span class="c1">// Although the SVG spec supports multi-language text tags (e.g. &quot;en,fr,de&quot;)</span>
<span class="linenos" data-line="367"></span>                    <span class="c1">// these are a really poor idea since (a) they are confusing to read and (b) the</span>
<span class="linenos" data-line="368"></span>                    <span class="c1">// desired translations could diverge at any point. So get rid.</span>
<span class="linenos" data-line="369"></span>                    <span class="nv">$singleLanguageNode</span> <span class="o">=</span> <span class="nv">$sibling</span><span class="o">-&gt;</span><span class="na">cloneNode</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
<span class="linenos" data-line="370"></span>                    <span class="nv">$singleLanguageNode</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="s1">&#39;systemLanguage&#39;</span><span class="p">,</span> <span class="nv">$realLang</span><span class="p">);</span>
<span class="linenos" data-line="371"></span>
<span class="linenos" data-line="372"></span>                    <span class="c1">// @todo: Should also go into tspans and change their ids, too.</span>
<span class="linenos" data-line="373"></span>                    <span class="c1">// $prefix = implode( &#39;-&#39;, explode( &#39;-&#39;, $singleLanguageNode-&gt;getAttribute( &#39;id&#39; ), -1 ) );</span>
<span class="linenos" data-line="374"></span>                    <span class="c1">// $singleLanguageNode-&gt;setAttribute( &#39;id&#39;, &quot;$prefix-$realLang&quot; );</span>
<span class="linenos" data-line="375"></span>
<span class="linenos" data-line="376"></span>                    <span class="c1">// Add in new element</span>
<span class="linenos" data-line="377"></span>                    <span class="nv">$switch</span><span class="o">-&gt;</span><span class="na">appendChild</span><span class="p">(</span><span class="nv">$singleLanguageNode</span><span class="p">);</span>
<span class="linenos" data-line="378"></span>                <span class="p">}</span>
<span class="linenos" data-line="379"></span>                <span class="nv">$switch</span><span class="o">-&gt;</span><span class="na">removeChild</span><span class="p">(</span><span class="nv">$sibling</span><span class="p">);</span>
</pre></div>
<h4><span class="mw-headline" id="PHP_static_analyzer">PHP static analyzer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=133" title="Edit section: PHP static analyzer">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<div class="tracked plainlinks mw-trackedTemplate"><link rel="mw-deduplicated-inline-style" href="https://commons.wikimedia.org/wiki/mw-data:TemplateStyles:r649510686"/>Tracked in <a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Phabricator" class="extiw" title="mw:Special:MyLanguage/Phabricator">Phabricator</a><br /><b><a href="https://phabricator.wikimedia.org/T316310" class="extiw" title="phabricator:T316310"><span class="tracked-url trakfab-T316310">Task T316310</span></a></b><br /><span class="status"></span></div>
<p>SVG Translate already has some phpdoc (JavaDoc-style) comments, but the declarations have some issues.
<a href="https://phabricator.wikimedia.org/T316310" class="extiw" title="phab:T316310">Phab:T316310</a> seeks to add the PHP static analyzer / linter <a rel="nofollow" class="external text" href="https://github.com/phan/phan">Phan</a>. A proposed patch adds Phan to the build process.
</p><p>See the <a rel="nofollow" class="external free" href="https://github.com/phan/phan/wiki/Tutorial-for-Analyzing-a-Large-Sloppy-Code-Base">https://github.com/phan/phan/wiki/Tutorial-for-Analyzing-a-Large-Sloppy-Code-Base</a> tutorial.
A baseline run on SVG Translate produced
</p>
<pre>// PhanUndeclaredMethod&#160;: 10+ occurrences
// PhanTypeMismatchArgumentNullableInternal&#160;: 7 occurrences
// PhanCommentDuplicateParam&#160;: 3 occurrences
// PhanDeprecatedFunction&#160;: 3 occurrences
// PhanTypeMismatchArgumentInternalProbablyReal&#160;: 2 occurrences
// PhanTypeMismatchDeclaredParamNullable&#160;: 2 occurrences
// PhanTypeMismatchPropertyProbablyReal&#160;: 2 occurrences
// PhanAccessMethodInternal&#160;: 1 occurrence
// PhanTypeMismatchArgumentNullable&#160;: 1 occurrence
// PhanTypeMismatchArgumentProbablyReal&#160;: 1 occurrence
// PhanTypePossiblyInvalidDimOffset&#160;: 1 occurrence
// PhanTypeSuspiciousNonTraversableForeach&#160;: 1 occurrence
</pre>
<p>That does not look outrageous. Some look like expected trivial fixes. Maybe a higher analysis level will complain about code not looking at the returned value. I have not seen the start out with weak checking plan and increase the level later. Software engineering advice has been to set the warning level at maximum and just deal with the flood. The ratchet-up-later plan sounds interesting, but somebody needs to remember to do the ratcheting. (Ah, Eric just wanting to ignore 200+ warnings that had to be wrong.)
</p><p>Phan has not been around a long time (in development in 2017). What other PHP linters are there?
</p>
<h4><span class="mw-headline" id="Mere_mortals_cannot_view_the_log">Mere mortals cannot view the log</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=134" title="Edit section: Mere mortals cannot view the log">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>See <a class="external free" href="https://phabricator.wikimedia.org/T271000#8201384">https://phabricator.wikimedia.org/T271000#8201384</a>
</p><p>So raise a creature feature request for a logging window.
</p><p>I think I was bit by silent errors. The code detected a problem, logged an error, stopped further processing in that metnod, but forged ahead with subsequent tasks that GIGO'd.
</p>
<h4><span class="mw-headline" id="Phabricator_tickets">Phabricator tickets</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=135" title="Edit section: Phabricator tickets">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>I need to update some phab tickets and create some others.
</p>
<pre>T271000

Mentioned In
T319259: Check that document element is &lt;svg&gt; and in the right namespace
rGSVTd5fc9388e033: Allow tspan to be in svg namespace (#622)
T248252: SVG Translate: Skip unsupported text pattern and continue with the supported ones
rGSVTb8c23d973c36: Create (and catch) exceptions for all existing error states
T316741: Allow svg namespace prefixes other than 'svg'
rGSVT91689a31bb6b: Fix regex to find $1, $2, etc.
rGSVT05d2724e6765: Normalize lang codes when reading SVGs and writing translations
T261192: Rendering multilingual (systemLanguage) SVG files fails locally after upgrading librsvg from 2.40.21 to 2.44.10
T40010: RFC: Re-evaluate librsvg as SVG renderer on Wikimedia wikis
T275263: Translation dropdown not available on File: page after translating a specific SVG file on Commons via svgtranslate tool
T271595: SVG translate tool replaces all fields with "$1" (style element needs at least one trailing character)

Mentioned Here
T271595: SVG translate tool replaces all fields with "$1" (style element needs at least one trailing character)
T221382: [BUG] Some CSS selectors break translation input
T319259: Check that document element is &lt;svg&gt; and in the right namespace
T316310: Add Phan to SVG Translate CI
T316741: Allow svg namespace prefixes other than 'svg'
T221453: Add "newer" open fonts
T280718: Re-evaluate whether keeping around https://noc.wikimedia.org/conf/fc-list is a good practive
T261192: Rendering multilingual (systemLanguage) SVG files fails locally after upgrading librsvg from 2.40.21 to 2.44.10
T40010: RFC: Re-evaluate librsvg as SVG renderer on Wikimedia wikis
T154237: SVG image wikisyntax can't use "lang=zh-hant"
T265549: Update librsvg to &gt; 2.44.10
</pre>
<h3><span class="mw-headline" id="Hoisting_attributes">Hoisting attributes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=136" title="Edit section: Hoisting attributes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>SVG Translate produces verbose output. One reason is that it copies all the attributes on the original <code>text</code> element to the <code>switch</code> element clauses. Consequently, we see something like
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;100&quot;</span> <span class="na">y=</span><span class="s">&quot;200&quot;</span> <span class="na">font-family=</span><span class="s">&quot;Arial&quot;</span> <span class="na">font-size=</span><span class="s">&quot;10&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>Hello, world.<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;100&quot;</span> <span class="na">y=</span><span class="s">&quot;200&quot;</span> <span class="na">font-family=</span><span class="s">&quot;Arial&quot;</span> <span class="na">font-size=</span><span class="s">&quot;10&quot;</span> <span class="na">systemLanguage=</span><span class="s">&quot;de&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>Hallo Welt.<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&quot;100&quot;</span> <span class="na">y=</span><span class="s">&quot;200&quot;</span> <span class="na">font-family=</span><span class="s">&quot;Arial&quot;</span> <span class="na">font-size=</span><span class="s">&quot;10&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>Hello, world.<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/text&gt;</span>
</pre></div></dd></dl>
<p>A more concise version would be
</p>
<dl><dd><div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch</span> <span class="na">transform=</span><span class="s">&quot;translate(100, 200)&quot;</span> <span class="na">font-family=</span><span class="s">&quot;Arial&quot;</span> <span class="na">font-size=</span><span class="s">&quot;10&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>Hello, world.<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text</span> <span class="na">systemLanguage=</span><span class="s">&quot;de&quot;</span><span class="nt">&gt;&lt;tspan&gt;</span>Hallo Welt.<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
  <span class="nt">&lt;text&gt;&lt;tspan&gt;</span>Hello, world.<span class="nt">&lt;/tspan&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/text&gt;</span>
</pre></div></dd></dl>
<p>There can be a list of attributes to promote. For example, attributes <code>font-family</code>, <code>font-size</code>, <code>font-weight</code>, and <code>font-style</code>. If a <code>switch</code> element has only <code>text</code> elements and each of those elements have the same attribute <i>z</i>, then delete <i>z</i> from each child and move it to the <code>switch</code> element. The replacement may override a value on the <code>switch</code> element.
</p>
<h4><span class="mw-headline" id="Class_and_Style_confuse_the_issue">Class and Style confuse the issue</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=137" title="Edit section: Class and Style confuse the issue">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The <code>class</code> and <code>style</code> attributes complicate the replacement. The simple method would insist those attributes are not present on any element. There may still be a CSS selector that matches the <code>switch</code> or <code>text</code> elements. The priority of CSS rules is higher than attributes, so the only real trouble is the <code>class</code> attribute. Leave the <code>class</code> attribute on any element.
</p>
<dl><dd><small>Note: SVG 1.1 does not require CSS or <code>style</code> attribute support.<sup id="cite_ref-32" class="reference"><a href="#cite_note-32">&#91;32&#93;</a></sup></small></dd></dl>
<p>There are many ways to specify presentation properties, and those specifications may conflict. The conflicts are resolved by assigning priorities to the property specifications:<sup id="cite_ref-33" class="reference"><a href="#cite_note-33">&#91;33&#93;</a></sup>
</p>
<ul><li>Attributes (lowest priority)</li>
<li>CSS selectors have calculated priorities based on specificity and order</li>
<li>inline styles (may be overridden with CSS <code>!important</code> selectors) (highest priority)</li></ul>
<p>The style priority makes hoisting difficult. It also means that inline styles are not (usually) overridden with CSS patterns.
</p><p>Mozilla <a rel="nofollow" class="external free" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity">https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity</a> says
</p>
<blockquote>
<p>Your global CSS file that sets visual aspects of your site globally may be overwritten by inline styles defined directly on individual elements. Both inline styles and !important are considered bad practice, but sometimes you need the latter to override the former.
</p>
</blockquote>
<p>Inkscape heavily uses inline styles. In a way, that makes interpretation easier: inline styles have the highest precedence, so it is the least confusing way to apply style information. It is unlikely to be overridden by other information. At the same time, it also means that converting inline style information to attributes may have unexpected results if a CSS selector applies contradicting information.
</p>
<h4><span class="mw-headline" id="Prefer_class">Prefer class</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=138" title="Edit section: Prefer class">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>It makes sense to prefer class (or other selectors) over explicit <code>style</code> attributes. For example, say a <code>class</code> selector sets the font characteristics to certain values and the <code>style</code> attribute sets the same values. A <code>class</code> selector may apply to more elements, so it should be favored.
</p><p>A quick and dirty way to play this game is to remove the <code>style</code> attribute and then <code>Window.getComputedStyle()</code>. Any properties in the <code>style</code> attribute that are already present may be removed. Coding can be a bit tricky.
</p><p>Being more direct is also difficult. One can access the stylesheets and the <code>style</code> attribute, but the CSSRule (Media rules make a multiverse), CSSStyleRule (does not parse selectors), and CSSStyleDeclaration do not have more mechanism. CSSStyleRule provides the <code>selectorText</code>, but the interface does not provide a priority list of which rules apply to an element. Parsing and interpreting selectors is a difficult task.
</p><p>There is <code>querySelector</code>, so the inverted test may be done. Should check at how well that method works. The method does not return the priority.
</p><p>Pseudo selectors may be difficult to get right. For example, <code>:active</code> suggests the need to example all possibilities.
</p><p>Animation may also cause trouble.
</p>
<h4><span class="mw-headline" id="Transformation_rewrites">Transformation rewrites</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=139" title="Edit section: Transformation rewrites">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The <code>transform</code> rewrite is more complicated. A potential method chooses a suitable translation, appends it to the <code>switch</code> element's <code>transform</code>, and then adjusts the coordinates of all the children. For the <code>text</code> element, if the coordinate adjusts to zero, then remove the attribute. Do not remove the zero attributes of <code>tspan</code> elements because they start new text chunks. A <code>transform</code> element on the <code>text</code> or <code>tspan</code> elements would cause a lot of trouble. So hoist the <code>transform</code> attributes first and give up if they do not hoist.
</p><p>Is this step a good idea? If the file is localized, all this information would be moved back into the <code>text</code> element. In addition, the styling may be accomplished with a <code>class</code> attribute and CSS, so it is not a heavy penalty for each clause. Moving styling information into a <code>text</code> element may be the better goal. The issue of hoisting position information may still be reasonable.
</p>
<h3><span class="mw-headline" id="Multiline_trick">Multiline trick</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=140" title="Edit section: Multiline trick">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Merge with <code>tspan</code> count issue.
</p><p>It may be possible to do a multiline with vertical alignment trick. Instead of a one-line translation or a two-line translation, make it a three-line translation. For one-line translations, only one <code>tspan</code> is used; the other two are left empty. For a two-line translation, the one-line <code>tspan</code> is left empty.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;switch&gt;</span>
  <span class="nt">&lt;text&gt;</span>
    <span class="nt">&lt;tspan</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>One-line translation<span class="nt">&lt;/tspan&gt;</span>
    <span class="nt">&lt;tspan</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;-20&quot;</span><span class="nt">&gt;</span>Two-line translation, line 1<span class="nt">&lt;/tspan&gt;</span>
    <span class="nt">&lt;tspan</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;20&quot;</span><span class="nt">&gt;</span>Two-line translation, line 2<span class="nt">&lt;/tspan&gt;</span>
  <span class="nt">&lt;/text&gt;</span>
<span class="nt">&lt;/switch&gt;</span>
</pre></div>
<h3><span class="mw-headline" id="WMF_warts">WMF warts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=141" title="Edit section: WMF warts">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li><a rel="nofollow" class="external free" href="https://www.debian.org/releases/">https://www.debian.org/releases/</a> Debian releases...</li></ul>
<h2><span class="mw-headline" id="SVG_and_Inkscape">SVG and Inkscape</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=142" title="Edit section: SVG and Inkscape">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Inkscape is an editor that will preserve a lot of SVG because Inkscape uses SVG as its internal representation. Unlike other graphics editors, Inkscape does not have a different native format.
</p><p>Inkscape produces bizarre numbers. Single precision formatted as a double. Metric conversions.
</p><p>Inkscape uses concrete bounding boxes. Test the following scenario. An SVG image with 4 circles and each circle points to a <code>linearGradient</code> element. The linear gradient uses the default <code>gradientUnits="objectBoundingBox"</code>. I believe Inkscape will clone 4 &lt;codeLlinearGradient elements, and those elemnents will be <code>gradientUnits="userSpaceOnUse"</code>. Test if moving an object changes the coordinates or creates a new linear gradient.
</p>
<h3><span class="mw-headline" id="Inkscape_units">Inkscape units</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=143" title="Edit section: Inkscape units">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>I worked on this topic somewhere else....
</p><p>Notice the strange units in this header.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;svg</span>
   <span class="na">width=</span><span class="s">&quot;1281.4634mm&quot;</span>
   <span class="na">height=</span><span class="s">&quot;246.60315mm&quot;</span>
   <span class="na">viewBox=</span><span class="s">&quot;0 0 5125.8537 986.41263&quot;</span>
   <span class="na">version=</span><span class="s">&quot;1.1&quot;</span>
   <span class="na">id=</span><span class="s">&quot;svg370&quot;</span>
   <span class="na">xml:space=</span><span class="s">&quot;preserve&quot;</span>
   <span class="na">inkscape:version=</span><span class="s">&quot;1.2 (dc2aedaf03, 2022-05-15)&quot;</span>
   <span class="na">sodipodi:docname=</span><span class="s">&quot;Chronologie_constitutions_françaises.svg&quot;</span>
   <span class="na">xmlns:inkscape=</span><span class="s">&quot;http://www.inkscape.org/namespaces/inkscape&quot;</span>
   <span class="na">xmlns:sodipodi=</span><span class="s">&quot;http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd&quot;</span>
   <span class="na">xmlns:xlink=</span><span class="s">&quot;http://www.w3.org/1999/xlink&quot;</span>
   <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span>
   <span class="na">xmlns:svg=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span><span class="nt">&gt;</span>
</pre></div>
<p>The <code>viewBox</code> x-zoom: 0.24999999512276 &#8594; 1/4 to a single-float epsilon<br />
The <code>viewBox</code> y-zoom: 0.24999999239669 &#8594; 1/4 to a single-float epsilon<br />
Convert the 5125.8537 pixels to inches: 53.394309375<br />
Convert the 5125.8537 pixels to mm: 1356.215458125<br />
Convert the width of 1281.4634&#160;mm to inches: 50.45131496063<br />
Convert the width of 1281.4634&#160;mm to CSS pixels: 4843.3262362205
</p>
<h2><span class="mw-headline" id="Accuracy">Accuracy</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=144" title="Edit section: Accuracy">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Some random issues about technical accuracy.
</p>
<h3><span class="mw-headline" id="Motors">Motors</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=145" title="Edit section: Motors">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Compare diagram of a 3-phase induction motors <a href="https://commons.wikimedia.org/wiki/File:Vierpolig-3stränge.svg" title="File:Vierpolig-3stränge.svg">File:Vierpolig-3stränge.svg</a> with <a href="https://commons.wikimedia.org/wiki/File:Asynchronous_Motor.svg" title="File:Asynchronous Motor.svg">File:Asynchronous Motor.svg</a>.
Look at the flux lines.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 335px"><div style="width: 335px">
			<div class="thumb" style="width: 330px;"><div style="margin:35px auto;"><a href="https://commons.wikimedia.org/wiki/File:Vierpolig-3stränge.svg" class="image" title="4-pole 3-phase motor"><img alt="4-pole 3-phase motor" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7c/Vierpolig-3stränge.svg/300px-Vierpolig-3stränge.svg.png" decoding="async" width="300" height="360" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7c/Vierpolig-3str%C3%A4nge.svg/450px-Vierpolig-3str%C3%A4nge.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/7/7c/Vierpolig-3str%C3%A4nge.svg/600px-Vierpolig-3str%C3%A4nge.svg.png 2x" data-file-width="750" data-file-height="900" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Vierpolig-3stränge.svg" class="galleryfilename galleryfilename-truncate" title="File:Vierpolig-3stränge.svg">Vierpolig-3stränge.svg</a>
4-pole 3-phase motor
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 335px"><div style="width: 335px">
			<div class="thumb" style="width: 330px;"><div style="margin:72.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Asynchronous_Motor.svg" class="image"><img alt="Asynchronous Motor.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Asynchronous_Motor.svg/300px-Asynchronous_Motor.svg.png" decoding="async" width="300" height="285" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Asynchronous_Motor.svg/450px-Asynchronous_Motor.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Asynchronous_Motor.svg/600px-Asynchronous_Motor.svg.png 2x" data-file-width="512" data-file-height="486" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Asynchronous_Motor.svg" class="galleryfilename galleryfilename-truncate" title="File:Asynchronous Motor.svg">Asynchronous Motor.svg</a>
</p>
			</div>
		</div></li>
</ul>
<p>Motor winding
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.youtube.com/watch?v=KxGMrr2Atso">https://www.youtube.com/watch?v=KxGMrr2Atso</a> 3-phase
<dl><dd></dd></dl></li></ul>
<table class="wikitable">
<caption>3-phase 4-pole motor winding with 24 slots
</caption>
<tbody><tr>
<th>Terminal</th>
<th>Phase</th>
<th>Slot</th>
<th>Slot</th>
<th>connect to
</th></tr>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>6</td>
<td>12
</td></tr>
<tr>
<td>6</td>
<td>2</td>
<td>3</td>
<td>8</td>
<td>2
</td></tr>
<tr>
<td>8</td>
<td>3</td>
<td>5</td>
<td>10</td>
<td>4
</td></tr>
<tr>
<td>4</td>
<td>1</td>
<td>7</td>
<td>12</td>
<td>6
</td></tr>
<tr>
<td>9</td>
<td>2</td>
<td>9</td>
<td>14</td>
<td>20
</td></tr>
<tr>
<td>5</td>
<td>3</td>
<td>11</td>
<td>16</td>
<td>22
</td></tr>
<tr>
<td>7</td>
<td>1</td>
<td>13</td>
<td>18</td>
<td>24
</td></tr>
<tr>
<td>12</td>
<td>2</td>
<td>15</td>
<td>20</td>
<td>14
</td></tr>
<tr>
<td>2</td>
<td>3</td>
<td>17</td>
<td>22</td>
<td>16
</td></tr>
<tr>
<td>10</td>
<td>1</td>
<td>19</td>
<td>24</td>
<td>18
</td></tr>
<tr>
<td>3</td>
<td>2</td>
<td>21</td>
<td>2</td>
<td>8
</td></tr>
<tr>
<td>11</td>
<td>3</td>
<td>23</td>
<td>4</td>
<td>10
</td></tr></tbody></table>
<ul><li>also concentric windings...</li></ul>
<p>Wiring diagram on Commons?
</p>
<ul><li><a rel="nofollow" class="external free" href="https://faceitsalon.com/dual-voltage-single-phase-motor-wiring-diagram-database/">https://faceitsalon.com/dual-voltage-single-phase-motor-wiring-diagram-database/</a></li></ul>
<p>NEMA and IEC
</p>
<ul><li><a rel="nofollow" class="external free" href="https://electricmotorwarehouse.com/motor-connection-diagrams/">https://electricmotorwarehouse.com/motor-connection-diagrams/</a></li>
<li><a rel="nofollow" class="external free" href="https://download.sew-eurodrive.com/download/pdf/9PD0048.pdf">https://download.sew-eurodrive.com/download/pdf/9PD0048.pdf</a></li>
<li><a rel="nofollow" class="external free" href="https://www.gulfelectroquip.com/wp-geq/wp-content/uploads/GEQ-Terminal-Markings-and-Connections-Guide-020520.pdf">https://www.gulfelectroquip.com/wp-geq/wp-content/uploads/GEQ-Terminal-Markings-and-Connections-Guide-020520.pdf</a></li></ul>
<p>General
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.nema.org/docs/default-source/motor-and-generator-guides-and-resources-library/6-electric-motor-terminology-and-performance-characteristics-v2.pdf">https://www.nema.org/docs/default-source/motor-and-generator-guides-and-resources-library/6-electric-motor-terminology-and-performance-characteristics-v2.pdf</a></li>
<li><a rel="nofollow" class="external free" href="https://motor-hmc.com/wp-content/uploads/2014/03/Motor-Glossary-from-Rockwell.pdf">https://motor-hmc.com/wp-content/uploads/2014/03/Motor-Glossary-from-Rockwell.pdf</a></li></ul>
<p>I have trouble with this diagram of a shaded pole motor. The vertical flux paths are too thick. Compare to an actual design. Also winding flux path should be similar width.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 335px"><div style="width: 335px">
			<div class="thumb" style="width: 330px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Spleetpoolmotor.svg" class="image" title="shaded pole motor]]"><img alt="shaded pole motor]]" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Spleetpoolmotor.svg/195px-Spleetpoolmotor.svg.png" decoding="async" width="195" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Spleetpoolmotor.svg/292px-Spleetpoolmotor.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Spleetpoolmotor.svg/389px-Spleetpoolmotor.svg.png 2x" data-file-width="600" data-file-height="370" /></a></div></div>
			<div class="gallerytext">
<p>shaded pole motor]]
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 335px"><div style="width: 335px">
			<div class="thumb" style="width: 330px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Braun_Camera-Werk_Novamat_M_330_-_shaded-pole_motor_EM2518-123-3104.jpg" class="image" title="shaded pole motor"><img alt="shaded pole motor" src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Braun_Camera-Werk_Novamat_M_330_-_shaded-pole_motor_EM2518-123-3104.jpg/120px-Braun_Camera-Werk_Novamat_M_330_-_shaded-pole_motor_EM2518-123-3104.jpg" decoding="async" width="120" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Braun_Camera-Werk_Novamat_M_330_-_shaded-pole_motor_EM2518-123-3104.jpg/180px-Braun_Camera-Werk_Novamat_M_330_-_shaded-pole_motor_EM2518-123-3104.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Braun_Camera-Werk_Novamat_M_330_-_shaded-pole_motor_EM2518-123-3104.jpg/240px-Braun_Camera-Werk_Novamat_M_330_-_shaded-pole_motor_EM2518-123-3104.jpg 2x" data-file-width="3624" data-file-height="3624" /></a></div></div>
			<div class="gallerytext">
<p>shaded pole motor
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 335px"><div style="width: 335px">
			<div class="thumb" style="width: 330px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Shaded_pole_detail.jpg" class="image" title="shaded pole motor. Note thin sides."><img alt="shaded pole motor. Note thin sides." src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Shaded_pole_detail.jpg/190px-Shaded_pole_detail.jpg" decoding="async" width="190" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Shaded_pole_detail.jpg/284px-Shaded_pole_detail.jpg 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Shaded_pole_detail.jpg/379px-Shaded_pole_detail.jpg 2x" data-file-width="768" data-file-height="487" /></a></div></div>
			<div class="gallerytext">
<p>shaded pole motor. Note thin sides.
</p>
			</div>
		</div></li>
</ul>
<h3><span class="mw-headline" id="Microphones_and_flux_path">Microphones and flux path</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=146" title="Edit section: Microphones and flux path">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>A ribbon microphone with no flux return path.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 335px"><div style="width: 335px">
			<div class="thumb" style="width: 330px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Bändchenmikrofon.svg" class="image" title="ribbon microphone"><img alt="ribbon microphone" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Bändchenmikrofon.svg/174px-Bändchenmikrofon.svg.png" decoding="async" width="174" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/B%C3%A4ndchenmikrofon.svg/262px-B%C3%A4ndchenmikrofon.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/B%C3%A4ndchenmikrofon.svg/349px-B%C3%A4ndchenmikrofon.svg.png 2x" data-file-width="900" data-file-height="620" /></a></div></div>
			<div class="gallerytext">
<p>ribbon microphone
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 335px"><div style="width: 335px">
			<div class="thumb" style="width: 330px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Mikrofon_szalag.png" class="image" title="ribbon microphone with return path"><img alt="ribbon microphone with return path" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Mikrofon_szalag.png/120px-Mikrofon_szalag.png" decoding="async" width="120" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Mikrofon_szalag.png/181px-Mikrofon_szalag.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Mikrofon_szalag.png/241px-Mikrofon_szalag.png 2x" data-file-width="738" data-file-height="735" /></a></div></div>
			<div class="gallerytext">
<p>ribbon microphone with return path
</p>
			</div>
		</div></li>
</ul>
<h3><span class="mw-headline" id="Vacuum_pumps_and_details">Vacuum pumps and details</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=147" title="Edit section: Vacuum pumps and details">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><a href="https://commons.wikimedia.org/wiki/File:Rotary_vane_pump.svg" class="image"><img alt="Rotary vane pump.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Rotary_vane_pump.svg/300px-Rotary_vane_pump.svg.png" decoding="async" width="300" height="294" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Rotary_vane_pump.svg/450px-Rotary_vane_pump.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Rotary_vane_pump.svg/600px-Rotary_vane_pump.svg.png 2x" data-file-width="2448" data-file-height="2400" /></a>
</p><p>Stator shape, reflood, exhaust valve, oil seals, oil pump, foam, vanes through the axle.
</p><p>Clearances. Bearings and something like an Oldham coupling.
</p>
<h3><span class="mw-headline" id="Biology">Biology</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=148" title="Edit section: Biology">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The comment ("This picture is obsolete. the pluripotent stemcell of the blood is giving origin to a lymphoid and a myeloid cell line.") at
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Illu_blood_cell_lineage.jpg" title="File:Illu blood cell lineage.jpg">File:Illu blood cell lineage.jpg</a></li></ul>
<p>and
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_simple.svg" title="File:Hematopoiesis simple.svg">File:Hematopoiesis simple.svg</a></li></ul>
<p>Many have worked on similar diagrams, so sort out the effort.
</p>
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Illu_blood_cell_lineage.jpg" title="File:Illu blood cell lineage.jpg">File:Illu blood cell lineage.jpg</a> 2006-05-17 on Commons. 77 kB. NIH (when?).</li>
<li><a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_(human)_diagram.png" title="File:Hematopoiesis (human) diagram.png">File:Hematopoiesis (human) diagram.png</a> 2006-08-11 1.18 MB. <a href="https://commons.wikimedia.org/wiki/User:A._Rad~commonswiki" title="User:A. Rad~commonswiki">A. Rad</a>. Has dense text block. There is also an extensive description about the cell images. It has an incompatible Commons license: "GFDL-self. This image is released under the GFDL-self license and is considered freely distributable. This image or any reproductions/customizations thereof (or any reproductions/customizations of its reproductions/customizations, and so forth) may NOT be sold without my explicit consent." The separate licensing section has just {{self|GFDL}}, so the licensing terms are inconsistent.
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_(human)_diagram.svg" title="File:Hematopoiesis (human) diagram.svg">File:Hematopoiesis (human) diagram.svg</a> 2010-02-06 3.1 MB. <a href="https://commons.wikimedia.org/wiki/User:Spacebirdy" title="User:Spacebirdy">Spacebirdy</a>, no text
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_(human)_diagram_en.svg" title="File:Hematopoiesis (human) diagram en.svg">File:Hematopoiesis (human) diagram en.svg</a> 2010-02-07 1.68 MB. <a href="https://commons.wikimedia.org/wiki/User:RexxS" title="User:RexxS">RexxS</a> + others, first versions do not thumbnail in history section, has display=none text
<ul><li><a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_(human)_diagram_switch.svg" title="File:Hematopoiesis (human) diagram switch.svg">File:Hematopoiesis (human) diagram switch.svg</a> 2020-07-18 1.33 MB. <a href="https://commons.wikimedia.org/wiki/User:JoKalliauer" title="User:JoKalliauer">JoKalliauer</a>, render in X issue. Easy to fix the render in X issue, but the <code>switch</code> translations are planar. No default language. Transforms with rotate and then x-y positioning. Only used on ja.Wiki. There are about 75 strings per plane and a dozen planes. Not a quick task. It would be nice to upload it to the _en ver, but then it would be difficult to do graphics edits.</li></ul></li></ul></li></ul></li></ul>
<p>The license issue is troubling. It affects all derivatives. It also has further issues because many files have been extracted from <a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_(human)_diagram_en.svg" title="File:Hematopoiesis (human) diagram en.svg">File:Hematopoiesis (human) diagram en.svg</a>. See, for example, <a href="https://commons.wikimedia.org/wiki/File:Monoblast.svg" title="File:Monoblast.svg">File:Monoblast.svg</a>.
</p><p>Comments on individual versions.
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 435px"><div style="width: 435px">
			<div class="thumb" style="width: 430px;"><div style="margin:19px auto;"><a href="https://commons.wikimedia.org/wiki/File:Illu_blood_cell_lineage.jpg" class="image" title="JPEG NIH"><img alt="JPEG NIH" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Illu_blood_cell_lineage.jpg/400px-Illu_blood_cell_lineage.jpg" decoding="async" width="400" height="292" srcset="https://upload.wikimedia.org/wikipedia/commons/2/20/Illu_blood_cell_lineage.jpg 1.5x" data-file-width="480" data-file-height="350" /></a></div></div>
			<div class="gallerytext">
<p>JPEG NIH
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 435px"><div style="width: 435px">
			<div class="thumb" style="width: 430px;"><div style="margin:33.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_(human)_diagram.png" class="image" title="PNG human"><img alt="PNG human" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/Hematopoiesis_(human)_diagram.png/400px-Hematopoiesis_(human)_diagram.png" decoding="async" width="400" height="263" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/Hematopoiesis_%28human%29_diagram.png/600px-Hematopoiesis_%28human%29_diagram.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/Hematopoiesis_%28human%29_diagram.png/800px-Hematopoiesis_%28human%29_diagram.png 2x" data-file-width="3472" data-file-height="2280" /></a></div></div>
			<div class="gallerytext">
<p>PNG human
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 435px"><div style="width: 435px">
			<div class="thumb" style="width: 430px;"><div style="margin:31.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_simple.png" class="image" title="PNG more modern (lost backarrow)"><img alt="PNG more modern (lost backarrow)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Hematopoiesis_simple.png/400px-Hematopoiesis_simple.png" decoding="async" width="400" height="267" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Hematopoiesis_simple.png/600px-Hematopoiesis_simple.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Hematopoiesis_simple.png/800px-Hematopoiesis_simple.png 2x" data-file-width="4000" data-file-height="2667" /></a></div></div>
			<div class="gallerytext">
<p>PNG more modern (lost backarrow)
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 435px"><div style="width: 435px">
			<div class="thumb" style="width: 430px;"><div style="margin:31.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_simple.svg" class="image" title="SVG more modern (lost backarrow)"><img alt="SVG more modern (lost backarrow)" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Hematopoiesis_simple.svg/400px-Hematopoiesis_simple.svg.png" decoding="async" width="400" height="267" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Hematopoiesis_simple.svg/600px-Hematopoiesis_simple.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Hematopoiesis_simple.svg/800px-Hematopoiesis_simple.svg.png 2x" data-file-width="1800" data-file-height="1200" /></a></div></div>
			<div class="gallerytext">
<p>SVG more modern (lost backarrow)
</p>
			</div>
		</div></li>
</ul>
<p>Look at Wikidata items. Examine instance and subclass relations. (<a href="https://www.wikidata.org/wiki/Property:P3094" class="extiw" title="d:Property:P3094"><span title="this class of items develops from another class of items (biology)">develops from <small>(P3094)</small></span></a>, <a href="https://www.wikidata.org/wiki/Property:P155" class="extiw" title="d:Property:P155"><span title="immediately prior item in a series of which the subject is a part, preferably use as qualifier of P179 &#91;if the subject has replaced the preceding item, e.g. political offices, use &quot;replaces&quot; (P1365)&#93;">follows <small>(P155)</small></span></a>, <a href="https://www.wikidata.org/wiki/Property:P156" class="extiw" title="d:Property:P156"><span title="immediately following item in a series of which the subject is a part, preferably use as qualifier of P179 &#91;if the subject has been replaced, e.g. political offices, use &quot;replaced by&quot; (P1366)&#93;">followed by <small>(P156)</small></span></a>)
</p>
<ul><li>Hemocytoblast <a href="https://www.wikidata.org/wiki/Q514525" class="extiw" title="d:Q514525"><span title="stem cells that give rise to other blood cells">hematopoietic stem cell <small>(Q514525)</small></span></a></li>
<li>Proerythroblast <a href="https://www.wikidata.org/wiki/Q2284254" class="extiw" title="d:Q2284254"><span title="Red blood cell">proerythroblast <small>(Q2284254)</small></span></a></li>
<li>Myeloblast <a href="https://www.wikidata.org/wiki/Q1956556" class="extiw" title="d:Q1956556"><span title="stem cell">myeloblast <small>(Q1956556)</small></span></a></li>
<li>lymphoblast <a href="https://www.wikidata.org/wiki/Q1873857" class="extiw" title="d:Q1873857"><span title="cell type">lymphoblast <small>(Q1873857)</small></span></a></li>
<li>monoblast <a href="https://www.wikidata.org/wiki/Q2617333" class="extiw" title="d:Q2617333"><span title="cell that matures into a monocyte">monoblast <small>(Q2617333)</small></span></a></li>
<li>megakaryoblast <a href="https://www.wikidata.org/wiki/Q2984950" class="extiw" title="d:Q2984950"><span title="cell type">megakaryoblast <small>(Q2984950)</small></span></a></li>
<li>polychromatic erythroblast&#160;??? <a href="https://www.wikidata.org/wiki/Q3296909" class="extiw" title="d:Q3296909"><span title="cell type; precursor of erythrocytes">erythroblast <small>(Q3296909)</small></span></a></li>
<li>progranulocyte&#160;??? <a href="https://www.wikidata.org/wiki/Q2382063" class="extiw" title="d:Q2382063"><span title="granulocyte precursor cell">promyelocyte <small>(Q2382063)</small></span></a> with dup <a href="https://www.wikidata.org/wiki/Q66590191" class="extiw" title="d:Q66590191"><span title="cell type">promyelocyte <small>(Q66590191)</small></span></a></li>
<li>lymphocyte <a href="https://www.wikidata.org/wiki/Q715347" class="extiw" title="d:Q715347"><span title="subtype of white blood cell">lymphocyte <small>(Q715347)</small></span></a></li>
<li>monocyte <a href="https://www.wikidata.org/wiki/Q107244" class="extiw" title="d:Q107244"><span title="sub-type of white blood cells">monocyte <small>(Q107244)</small></span></a></li>
<li>megakaryocyte <a href="https://www.wikidata.org/wiki/Q821701" class="extiw" title="d:Q821701"><span title="large bone marrow cell responsible for the production of platelets">megakaryocyte <small>(Q821701)</small></span></a></li>
<li>erythrocytes <a href="https://www.wikidata.org/wiki/Q37187" class="extiw" title="d:Q37187"><span title="most common type of blood cell">red blood cell <small>(Q37187)</small></span></a></li>
<li>basophil <a href="https://www.wikidata.org/wiki/Q107988" class="extiw" title="d:Q107988"><span title="type of white blood cell">basophil <small>(Q107988)</small></span></a></li>
<li>eosinophil <a href="https://www.wikidata.org/wiki/Q107238" class="extiw" title="d:Q107238"><span title="variety of white blood cell">eosinophil <small>(Q107238)</small></span></a></li>
<li>neutrophil <a href="https://www.wikidata.org/wiki/Q188417" class="extiw" title="d:Q188417"><span title="most abundant white blood cell, a type of granulocyte">neutrophil <small>(Q188417)</small></span></a></li>
<li>granulocytes <a href="https://www.wikidata.org/wiki/Q223143" class="extiw" title="d:Q223143"><span title="mature white blood cells with granules in the cytoplasm">granulocyte <small>(Q223143)</small></span></a></li>
<li>agranulocytes <a href="https://www.wikidata.org/wiki/Q1775422" class="extiw" title="d:Q1775422"><span title="mature lymphocytes and monocytes transported by the blood to extravascular space">agranulocytes <small>(Q1775422)</small></span></a></li>
<li>leukocytes <a href="https://www.wikidata.org/wiki/Q42395" class="extiw" title="d:Q42395"><span title="type of cells of the immunological system">white blood cell <small>(Q42395)</small></span></a></li>
<li>thrombocytes <a href="https://www.wikidata.org/wiki/Q101026" class="extiw" title="d:Q101026"><span title="component of blood aiding in coagulation.">platelets <small>(Q101026)</small></span></a></li></ul>
<p>Looking for files extracted from <a href="https://commons.wikimedia.org/wiki/File:Hematopoiesis_(human)_diagram_en.svg" title="File:Hematopoiesis (human) diagram en.svg">File:Hematopoiesis (human) diagram en.svg</a>. Keeping track of derivatives is nice....
</p>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:20px auto;"><a href="https://commons.wikimedia.org/wiki/File:B._metamyelocyte.svg" class="image"><img alt="B. metamyelocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/89/B._metamyelocyte.svg/120px-B._metamyelocyte.svg.png" decoding="async" width="120" height="110" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/8/89/B._metamyelocyte.svg/180px-B._metamyelocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/8/89/B._metamyelocyte.svg/240px-B._metamyelocyte.svg.png 2x" data-file-width="37" data-file-height="34" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:B._metamyelocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:B. metamyelocyte.svg">B. metamyelocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:24.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:B._myelocyte.svg" class="image"><img alt="B. myelocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/B._myelocyte.svg/120px-B._myelocyte.svg.png" decoding="async" width="120" height="101" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/B._myelocyte.svg/180px-B._myelocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/B._myelocyte.svg/240px-B._myelocyte.svg.png 2x" data-file-width="44" data-file-height="37" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:B._myelocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:B. myelocyte.svg">B. myelocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:48.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:B._band.svg" class="image"><img alt="B. band.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/B._band.svg/120px-B._band.svg.png" decoding="async" width="120" height="53" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/B._band.svg/180px-B._band.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/B._band.svg/240px-B._band.svg.png 2x" data-file-width="79" data-file-height="35" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:B._band.svg" class="galleryfilename galleryfilename-truncate" title="File:B. band.svg">B. band.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:22px auto;"><a href="https://commons.wikimedia.org/wiki/File:B._promyelocyte.svg" class="image"><img alt="B. promyelocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/B._promyelocyte.svg/120px-B._promyelocyte.svg.png" decoding="async" width="120" height="106" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/B._promyelocyte.svg/180px-B._promyelocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/B._promyelocyte.svg/240px-B._promyelocyte.svg.png 2x" data-file-width="51" data-file-height="45" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:B._promyelocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:B. promyelocyte.svg">B. promyelocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:18px auto;"><a href="https://commons.wikimedia.org/wiki/File:Basophilic_erythoblast.svg" class="image"><img alt="Basophilic erythoblast.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/Basophilic_erythoblast.svg/120px-Basophilic_erythoblast.svg.png" decoding="async" width="120" height="114" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/Basophilic_erythoblast.svg/180px-Basophilic_erythoblast.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/Basophilic_erythoblast.svg/240px-Basophilic_erythoblast.svg.png 2x" data-file-width="40" data-file-height="38" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Basophilic_erythoblast.svg" class="galleryfilename galleryfilename-truncate" title="File:Basophilic erythoblast.svg">Basophilic erythoblast.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:18px auto;"><a href="https://commons.wikimedia.org/wiki/File:Basophil.svg" class="image"><img alt="Basophil.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1e/Basophil.svg/120px-Basophil.svg.png" decoding="async" width="120" height="114" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1e/Basophil.svg/180px-Basophil.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/1e/Basophil.svg/240px-Basophil.svg.png 2x" data-file-width="37" data-file-height="35" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Basophil.svg" class="galleryfilename galleryfilename-truncate" title="File:Basophil.svg">Basophil.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:B_lymphocyte.svg" class="image"><img alt="B lymphocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/B_lymphocyte.svg/116px-B_lymphocyte.svg.png" decoding="async" width="116" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/B_lymphocyte.svg/175px-B_lymphocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/B_lymphocyte.svg/233px-B_lymphocyte.svg.png 2x" data-file-width="33" data-file-height="34" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:B_lymphocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:B lymphocyte.svg">B lymphocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:19.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Common_lymphoid_progenitor.svg" class="image"><img alt="Common lymphoid progenitor.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/61/Common_lymphoid_progenitor.svg/120px-Common_lymphoid_progenitor.svg.png" decoding="async" width="120" height="111" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/6/61/Common_lymphoid_progenitor.svg/180px-Common_lymphoid_progenitor.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/6/61/Common_lymphoid_progenitor.svg/240px-Common_lymphoid_progenitor.svg.png 2x" data-file-width="41" data-file-height="38" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Common_lymphoid_progenitor.svg" class="galleryfilename galleryfilename-truncate" title="File:Common lymphoid progenitor.svg">Common lymphoid progenitor.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:49.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:E._band.svg" class="image"><img alt="E. band.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cb/E._band.svg/120px-E._band.svg.png" decoding="async" width="120" height="51" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cb/E._band.svg/180px-E._band.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/c/cb/E._band.svg/240px-E._band.svg.png 2x" data-file-width="78" data-file-height="33" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:E._band.svg" class="galleryfilename galleryfilename-truncate" title="File:E. band.svg">E. band.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:19.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Common_myeloid_progenitor.svg" class="image"><img alt="Common myeloid progenitor.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Common_myeloid_progenitor.svg/120px-Common_myeloid_progenitor.svg.png" decoding="async" width="120" height="111" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Common_myeloid_progenitor.svg/180px-Common_myeloid_progenitor.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Common_myeloid_progenitor.svg/240px-Common_myeloid_progenitor.svg.png 2x" data-file-width="41" data-file-height="38" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Common_myeloid_progenitor.svg" class="galleryfilename galleryfilename-truncate" title="File:Common myeloid progenitor.svg">Common myeloid progenitor.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:18.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:E._metamyelocyte.svg" class="image"><img alt="E. metamyelocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/E._metamyelocyte.svg/120px-E._metamyelocyte.svg.png" decoding="async" width="120" height="113" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/E._metamyelocyte.svg/180px-E._metamyelocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/E._metamyelocyte.svg/240px-E._metamyelocyte.svg.png 2x" data-file-width="35" data-file-height="33" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:E._metamyelocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:E. metamyelocyte.svg">E. metamyelocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:19.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:E._promyelocyte.svg" class="image"><img alt="E. promyelocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/E._promyelocyte.svg/120px-E._promyelocyte.svg.png" decoding="async" width="120" height="111" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/E._promyelocyte.svg/180px-E._promyelocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/E._promyelocyte.svg/240px-E._promyelocyte.svg.png 2x" data-file-width="52" data-file-height="48" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:E._promyelocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:E. promyelocyte.svg">E. promyelocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:23.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:E._myelocyte.svg" class="image"><img alt="E. myelocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/E._myelocyte.svg/120px-E._myelocyte.svg.png" decoding="async" width="120" height="103" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/E._myelocyte.svg/180px-E._myelocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/E._myelocyte.svg/240px-E._myelocyte.svg.png 2x" data-file-width="50" data-file-height="43" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:E._myelocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:E. myelocyte.svg">E. myelocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:47.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Erythrocyte_(2).svg" class="image"><img alt="Erythrocyte (2).svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2b/Erythrocyte_(2).svg/120px-Erythrocyte_(2).svg.png" decoding="async" width="120" height="55" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2b/Erythrocyte_%282%29.svg/180px-Erythrocyte_%282%29.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/2b/Erythrocyte_%282%29.svg/240px-Erythrocyte_%282%29.svg.png 2x" data-file-width="57" data-file-height="26" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Erythrocyte_(2).svg" class="galleryfilename galleryfilename-truncate" title="File:Erythrocyte (2).svg">Erythrocyte (2).svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:21.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Eosinophil.svg" class="image"><img alt="Eosinophil.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/Eosinophil.svg/120px-Eosinophil.svg.png" decoding="async" width="120" height="107" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/Eosinophil.svg/180px-Eosinophil.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/Eosinophil.svg/240px-Eosinophil.svg.png 2x" data-file-width="36" data-file-height="32" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Eosinophil.svg" class="galleryfilename galleryfilename-truncate" title="File:Eosinophil.svg">Eosinophil.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:21.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Lymphoblast.svg" class="image"><img alt="Lymphoblast.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/Lymphoblast.svg/120px-Lymphoblast.svg.png" decoding="async" width="120" height="107" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/Lymphoblast.svg/180px-Lymphoblast.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/Lymphoblast.svg/240px-Lymphoblast.svg.png 2x" data-file-width="54" data-file-height="48" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Lymphoblast.svg" class="galleryfilename galleryfilename-truncate" title="File:Lymphoblast.svg">Lymphoblast.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:19px auto;"><a href="https://commons.wikimedia.org/wiki/File:Lymphoid_dendritic_cell_(3).svg" class="image"><img alt="Lymphoid dendritic cell (3).svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/Lymphoid_dendritic_cell_(3).svg/120px-Lymphoid_dendritic_cell_(3).svg.png" decoding="async" width="120" height="112" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/Lymphoid_dendritic_cell_%283%29.svg/180px-Lymphoid_dendritic_cell_%283%29.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/Lymphoid_dendritic_cell_%283%29.svg/240px-Lymphoid_dendritic_cell_%283%29.svg.png 2x" data-file-width="89" data-file-height="83" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Lymphoid_dendritic_cell_(3).svg" class="galleryfilename galleryfilename-truncate" title="File:Lymphoid dendritic cell (3).svg">Lymphoid dendritic cell (3).svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:18px auto;"><a href="https://commons.wikimedia.org/wiki/File:Megakaryoblast.svg" class="image"><img alt="Megakaryoblast.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/78/Megakaryoblast.svg/120px-Megakaryoblast.svg.png" decoding="async" width="120" height="114" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/7/78/Megakaryoblast.svg/180px-Megakaryoblast.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/7/78/Megakaryoblast.svg/240px-Megakaryoblast.svg.png 2x" data-file-width="62" data-file-height="59" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Megakaryoblast.svg" class="galleryfilename galleryfilename-truncate" title="File:Megakaryoblast.svg">Megakaryoblast.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:52px auto;"><a href="https://commons.wikimedia.org/wiki/File:Mast_cell.svg" class="image"><img alt="Mast cell.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f5/Mast_cell.svg/120px-Mast_cell.svg.png" decoding="async" width="120" height="46" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f5/Mast_cell.svg/180px-Mast_cell.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/f5/Mast_cell.svg/240px-Mast_cell.svg.png 2x" data-file-width="68" data-file-height="26" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Mast_cell.svg" class="galleryfilename galleryfilename-truncate" title="File:Mast cell.svg">Mast cell.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:20.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Megakaryocyte.svg" class="image"><img alt="Megakaryocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/Megakaryocyte.svg/120px-Megakaryocyte.svg.png" decoding="async" width="120" height="109" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/Megakaryocyte.svg/180px-Megakaryocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/Megakaryocyte.svg/240px-Megakaryocyte.svg.png 2x" data-file-width="138" data-file-height="125" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Megakaryocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:Megakaryocyte.svg">Megakaryocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:20.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Monoblast.svg" class="image"><img alt="Monoblast.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d1/Monoblast.svg/120px-Monoblast.svg.png" decoding="async" width="120" height="109" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d1/Monoblast.svg/180px-Monoblast.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/d/d1/Monoblast.svg/240px-Monoblast.svg.png 2x" data-file-width="56" data-file-height="51" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Monoblast.svg" class="galleryfilename galleryfilename-truncate" title="File:Monoblast.svg">Monoblast.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:16.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Multipotential_hematopoietic_stem_cell.svg" class="image"><img alt="Multipotential hematopoietic stem cell.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/Multipotential_hematopoietic_stem_cell.svg/120px-Multipotential_hematopoietic_stem_cell.svg.png" decoding="async" width="120" height="117" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/Multipotential_hematopoietic_stem_cell.svg/180px-Multipotential_hematopoietic_stem_cell.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/Multipotential_hematopoietic_stem_cell.svg/240px-Multipotential_hematopoietic_stem_cell.svg.png 2x" data-file-width="39" data-file-height="38" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Multipotential_hematopoietic_stem_cell.svg" class="galleryfilename galleryfilename-truncate" title="File:Multipotential hematopoietic stem cell.svg">Multipotential hematopoietic stem cell.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:23px auto;"><a href="https://commons.wikimedia.org/wiki/File:Myeloblast.svg" class="image"><img alt="Myeloblast.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/df/Myeloblast.svg/120px-Myeloblast.svg.png" decoding="async" width="120" height="104" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/d/df/Myeloblast.svg/180px-Myeloblast.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/d/df/Myeloblast.svg/240px-Myeloblast.svg.png 2x" data-file-width="60" data-file-height="52" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Myeloblast.svg" class="galleryfilename galleryfilename-truncate" title="File:Myeloblast.svg">Myeloblast.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:19px auto;"><a href="https://commons.wikimedia.org/wiki/File:Myeloid_dendritic_cell_(3).svg" class="image"><img alt="Myeloid dendritic cell (3).svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Myeloid_dendritic_cell_(3).svg/120px-Myeloid_dendritic_cell_(3).svg.png" decoding="async" width="120" height="112" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Myeloid_dendritic_cell_%283%29.svg/180px-Myeloid_dendritic_cell_%283%29.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Myeloid_dendritic_cell_%283%29.svg/240px-Myeloid_dendritic_cell_%283%29.svg.png 2x" data-file-width="89" data-file-height="83" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Myeloid_dendritic_cell_(3).svg" class="galleryfilename galleryfilename-truncate" title="File:Myeloid dendritic cell (3).svg">Myeloid dendritic cell (3).svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:48.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Monocyte.svg" class="image"><img alt="Monocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Monocyte.svg/120px-Monocyte.svg.png" decoding="async" width="120" height="53" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Monocyte.svg/180px-Monocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Monocyte.svg/240px-Monocyte.svg.png 2x" data-file-width="96" data-file-height="42" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Monocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:Monocyte.svg">Monocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:47px auto;"><a href="https://commons.wikimedia.org/wiki/File:N._band.svg" class="image"><img alt="N. band.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/N._band.svg/120px-N._band.svg.png" decoding="async" width="120" height="56" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/N._band.svg/180px-N._band.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/N._band.svg/240px-N._band.svg.png 2x" data-file-width="79" data-file-height="37" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:N._band.svg" class="galleryfilename galleryfilename-truncate" title="File:N. band.svg">N. band.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:N._metamyelocyte.svg" class="image"><img alt="N. metamyelocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/N._metamyelocyte.svg/116px-N._metamyelocyte.svg.png" decoding="async" width="116" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/N._metamyelocyte.svg/174px-N._metamyelocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/N._metamyelocyte.svg/232px-N._metamyelocyte.svg.png 2x" data-file-width="30" data-file-height="31" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:N._metamyelocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:N. metamyelocyte.svg">N. metamyelocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:23.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:N._myelocyte.svg" class="image"><img alt="N. myelocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/N._myelocyte.svg/120px-N._myelocyte.svg.png" decoding="async" width="120" height="103" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/N._myelocyte.svg/180px-N._myelocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/N._myelocyte.svg/240px-N._myelocyte.svg.png 2x" data-file-width="57" data-file-height="49" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:N._myelocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:N. myelocyte.svg">N. myelocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:24px auto;"><a href="https://commons.wikimedia.org/wiki/File:N._promyelocyte.svg" class="image"><img alt="N. promyelocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/N._promyelocyte.svg/120px-N._promyelocyte.svg.png" decoding="async" width="120" height="102" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/N._promyelocyte.svg/180px-N._promyelocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/N._promyelocyte.svg/240px-N._promyelocyte.svg.png 2x" data-file-width="59" data-file-height="50" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:N._promyelocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:N. promyelocyte.svg">N. promyelocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:23.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Nautral_killer_cell_(Large_granular_lymphocyte).svg" class="image"><img alt="Nautral killer cell (Large granular lymphocyte).svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Nautral_killer_cell_(Large_granular_lymphocyte).svg/120px-Nautral_killer_cell_(Large_granular_lymphocyte).svg.png" decoding="async" width="120" height="103" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Nautral_killer_cell_%28Large_granular_lymphocyte%29.svg/180px-Nautral_killer_cell_%28Large_granular_lymphocyte%29.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Nautral_killer_cell_%28Large_granular_lymphocyte%29.svg/240px-Nautral_killer_cell_%28Large_granular_lymphocyte%29.svg.png 2x" data-file-width="49" data-file-height="42" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Nautral_killer_cell_(Large_granular_lymphocyte).svg" class="galleryfilename galleryfilename-truncate" title="File:Nautral killer cell (Large granular lymphocyte).svg">Nautral killer cell (Large granular lymphocyte).svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Orthochromatic_erythroblast_(Normoblast).svg" class="image"><img alt="Orthochromatic erythroblast (Normoblast).svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/31/Orthochromatic_erythroblast_(Normoblast).svg/109px-Orthochromatic_erythroblast_(Normoblast).svg.png" decoding="async" width="109" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/3/31/Orthochromatic_erythroblast_%28Normoblast%29.svg/163px-Orthochromatic_erythroblast_%28Normoblast%29.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/3/31/Orthochromatic_erythroblast_%28Normoblast%29.svg/217px-Orthochromatic_erythroblast_%28Normoblast%29.svg.png 2x" data-file-width="29" data-file-height="32" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Orthochromatic_erythroblast_(Normoblast).svg" class="galleryfilename galleryfilename-truncate" title="File:Orthochromatic erythroblast (Normoblast).svg">Orthochromatic erythroblast (Normoblast).svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:46.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Polychromatic_erythtocyte_(1)_(Reticulocyte).svg" class="image"><img alt="Polychromatic erythtocyte (1) (Reticulocyte).svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7f/Polychromatic_erythtocyte_(1)_(Reticulocyte).svg/120px-Polychromatic_erythtocyte_(1)_(Reticulocyte).svg.png" decoding="async" width="120" height="57" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7f/Polychromatic_erythtocyte_%281%29_%28Reticulocyte%29.svg/180px-Polychromatic_erythtocyte_%281%29_%28Reticulocyte%29.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/7/7f/Polychromatic_erythtocyte_%281%29_%28Reticulocyte%29.svg/240px-Polychromatic_erythtocyte_%281%29_%28Reticulocyte%29.svg.png 2x" data-file-width="63" data-file-height="30" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Polychromatic_erythtocyte_(1)_(Reticulocyte).svg" class="galleryfilename galleryfilename-truncate" title="File:Polychromatic erythtocyte (1) (Reticulocyte).svg">Polychromatic erythtocyte (1) (Reticulocyte).svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:16.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Plasma_cell.svg" class="image"><img alt="Plasma cell.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/25/Plasma_cell.svg/120px-Plasma_cell.svg.png" decoding="async" width="120" height="117" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/2/25/Plasma_cell.svg/180px-Plasma_cell.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/2/25/Plasma_cell.svg/240px-Plasma_cell.svg.png 2x" data-file-width="47" data-file-height="46" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Plasma_cell.svg" class="galleryfilename galleryfilename-truncate" title="File:Plasma cell.svg">Plasma cell.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:18.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Polychromatic_erythroblast.svg" class="image"><img alt="Polychromatic erythroblast.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/Polychromatic_erythroblast.svg/120px-Polychromatic_erythroblast.svg.png" decoding="async" width="120" height="113" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/Polychromatic_erythroblast.svg/180px-Polychromatic_erythroblast.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/Polychromatic_erythroblast.svg/240px-Polychromatic_erythroblast.svg.png 2x" data-file-width="34" data-file-height="32" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Polychromatic_erythroblast.svg" class="galleryfilename galleryfilename-truncate" title="File:Polychromatic erythroblast.svg">Polychromatic erythroblast.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:19px auto;"><a href="https://commons.wikimedia.org/wiki/File:Proerythroblast_(Pronormoblast).svg" class="image"><img alt="Proerythroblast (Pronormoblast).svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Proerythroblast_(Pronormoblast).svg/120px-Proerythroblast_(Pronormoblast).svg.png" decoding="async" width="120" height="112" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Proerythroblast_%28Pronormoblast%29.svg/180px-Proerythroblast_%28Pronormoblast%29.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Proerythroblast_%28Pronormoblast%29.svg/240px-Proerythroblast_%28Pronormoblast%29.svg.png 2x" data-file-width="47" data-file-height="44" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Proerythroblast_(Pronormoblast).svg" class="galleryfilename galleryfilename-truncate" title="File:Proerythroblast (Pronormoblast).svg">Proerythroblast (Pronormoblast).svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:17.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Prolymphocyte.svg" class="image"><img alt="Prolymphocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f2/Prolymphocyte.svg/120px-Prolymphocyte.svg.png" decoding="async" width="120" height="115" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f2/Prolymphocyte.svg/180px-Prolymphocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/f/f2/Prolymphocyte.svg/240px-Prolymphocyte.svg.png 2x" data-file-width="50" data-file-height="48" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Prolymphocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:Prolymphocyte.svg">Prolymphocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:18px auto;"><a href="https://commons.wikimedia.org/wiki/File:Promegakaryocyte.svg" class="image"><img alt="Promegakaryocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/Promegakaryocyte.svg/120px-Promegakaryocyte.svg.png" decoding="async" width="120" height="114" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/Promegakaryocyte.svg/180px-Promegakaryocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/Promegakaryocyte.svg/240px-Promegakaryocyte.svg.png 2x" data-file-width="82" data-file-height="78" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Promegakaryocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:Promegakaryocyte.svg">Promegakaryocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:18.5px auto;"><a href="https://commons.wikimedia.org/wiki/File:Promonocyte.svg" class="image"><img alt="Promonocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/Promonocyte.svg/120px-Promonocyte.svg.png" decoding="async" width="120" height="113" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/Promonocyte.svg/180px-Promonocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/Promonocyte.svg/240px-Promonocyte.svg.png 2x" data-file-width="52" data-file-height="49" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Promonocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:Promonocyte.svg">Promonocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Small_lymphocyte_(4).svg" class="image"><img alt="Small lymphocyte (4).svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/be/Small_lymphocyte_(4).svg/116px-Small_lymphocyte_(4).svg.png" decoding="async" width="116" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/b/be/Small_lymphocyte_%284%29.svg/175px-Small_lymphocyte_%284%29.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/b/be/Small_lymphocyte_%284%29.svg/233px-Small_lymphocyte_%284%29.svg.png 2x" data-file-width="33" data-file-height="34" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Small_lymphocyte_(4).svg" class="galleryfilename galleryfilename-truncate" title="File:Small lymphocyte (4).svg">Small lymphocyte (4).svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:43px auto;"><a href="https://commons.wikimedia.org/wiki/File:Thrombocytes.svg" class="image"><img alt="Thrombocytes.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Thrombocytes.svg/120px-Thrombocytes.svg.png" decoding="async" width="120" height="64" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Thrombocytes.svg/180px-Thrombocytes.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Thrombocytes.svg/240px-Thrombocytes.svg.png 2x" data-file-width="41" data-file-height="22" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Thrombocytes.svg" class="galleryfilename galleryfilename-truncate" title="File:Thrombocytes.svg">Thrombocytes.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:T_lymphocyte.svg" class="image"><img alt="T lymphocyte.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/T_lymphocyte.svg/116px-T_lymphocyte.svg.png" decoding="async" width="116" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/T_lymphocyte.svg/175px-T_lymphocyte.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/T_lymphocyte.svg/233px-T_lymphocyte.svg.png 2x" data-file-width="33" data-file-height="34" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:T_lymphocyte.svg" class="galleryfilename galleryfilename-truncate" title="File:T lymphocyte.svg">T lymphocyte.svg</a>
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="https://commons.wikimedia.org/wiki/File:Neutrophil.svg" class="image"><img alt="Neutrophil.svg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/39/Neutrophil.svg/117px-Neutrophil.svg.png" decoding="async" width="117" height="120" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/3/39/Neutrophil.svg/175px-Neutrophil.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/3/39/Neutrophil.svg/233px-Neutrophil.svg.png 2x" data-file-width="34" data-file-height="35" /></a></div></div>
			<div class="gallerytext">
<p><a href="https://commons.wikimedia.org/wiki/File:Neutrophil.svg" class="galleryfilename galleryfilename-truncate" title="File:Neutrophil.svg">Neutrophil.svg</a>
</p>
			</div>
		</div></li>
</ul>
<h2><span class="mw-headline" id="Copyright">Copyright</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=149" title="Edit section: Copyright">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li><a class="external free" href="https://commons.wikimedia.org/wiki/Commons:Graphic_Lab/Illustration_workshop/Archive/2022#SVG_for_a_common_anti-capitalist_graffiti">https://commons.wikimedia.org/wiki/Commons:Graphic_Lab/Illustration_workshop/Archive/2022#SVG_for_a_common_anti-capitalist_graffiti</a></li>
<li><a class="external free" href="https://commons.wikimedia.org/w/index.php?title=Commons:Village_pump/Copyright&amp;diff=672607382&amp;oldid=672478602#IWM_Non_Commercial_Licence">https://commons.wikimedia.org/w/index.php?title=Commons:Village_pump/Copyright&amp;diff=672607382&amp;oldid=672478602#IWM_Non_Commercial_Licence</a></li></ul>
<h2><span class="mw-headline" id="MediaWiki_upgrades">MediaWiki upgrades</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=150" title="Edit section: MediaWiki upgrades">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>See <a href="https://phabricator.wikimedia.org/T265549#8145732" class="extiw" title="phab:T265549">Phab:T265549#8145732</a> <a href="https://phabricator.wikimedia.org/T216815" class="extiw" title="phab:T216815">Phab:T216815</a>
</p><p>The new version of <code>librsvg</code> now takes the langtag through the <code>--accept-language</code> command line argument rather than the <code>$LANG</code> environment variable. Well, it still uses the <code>$LANG</code> and other environment locale variables, but those environment variables must now be Unix locale strings.
</p><p>In general, an SVG langtag should never be passed through the <code>$LANG</code> environment variable. The latter takes an opaque Unix locale string rather than an IETF language tag. It happened to work for early versions of <code>librsvg</code> because those versions did a <code>getenv("LANG")</code> and used that result as an IETF langtag. (As a separate issue, the early versions also did not process hyphenated langtags correctly.) The Rust versions of <code>librsvg</code> now use a library routine to digest the locale string.
</p>
<h3><span class="mw-headline" id="Command_line_arguments">Command line arguments</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=151" title="Edit section: Command line arguments">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Outdated man page:
</p>
<ul><li><a rel="nofollow" class="external free" href="https://manpages.ubuntu.com/manpages/trusty/man1/rsvg-convert.1.html">https://manpages.ubuntu.com/manpages/trusty/man1/rsvg-convert.1.html</a></li></ul>
<ol><li>-f --format: png</li>
<li>-w --width: integer</li>
<li>-h --height: integer</li>
<li>-o --output filename</li>
<li>-d --dpi-x (default 90!)</li>
<li>-p --dpi-y (default 90!)</li>
<li>-a --keep-aspect-ratio</li>
<li>-u undocumented; see unlimited below</li></ol>
<p>Source
</p>
<ul><li><a rel="nofollow" class="external free" href="https://gitlab.gnome.org/GNOME/librsvg">https://gitlab.gnome.org/GNOME/librsvg</a></li>
<li><a rel="nofollow" class="external free" href="https://gitlab.gnome.org/GNOME/librsvg/-/blob/main/src/accept_language.rs">https://gitlab.gnome.org/GNOME/librsvg/-/blob/main/src/accept_language.rs</a></li>
<li><a rel="nofollow" class="external free" href="https://gitlab.gnome.org/GNOME/librsvg/-/blob/main/rsvg-convert.rst">https://gitlab.gnome.org/GNOME/librsvg/-/blob/main/rsvg-convert.rst</a>
<dl><dd>This wants to use different argument names?
<ol><li>-w --width</li>
<li>-h --height</li>
<li>-o --output</li>
<li>-f --format</li>
<li>-a --keep-aspect-ratio</li>
<li>-d --dpi-x</li>
<li>-p --dpi-y</li>
<li>-l --accept-language (New)</li>
<li>-u --unlimited; turn off limited XML parsing</li></ol></dd></dl></li></ul>
<h3><span class="mw-headline" id="Resvg_command_line_arguments">Resvg command line arguments</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=152" title="Edit section: Resvg command line arguments">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li><a rel="nofollow" class="external free" href="https://github.com/RazrFalcon/resvg">https://github.com/RazrFalcon/resvg</a></li>
<li><a rel="nofollow" class="external free" href="https://github.com/RazrFalcon/resvg/blob/master/src/main.rs">https://github.com/RazrFalcon/resvg/blob/master/src/main.rs</a>
<ol><li>resvg in.svg out.png</li>
<li>-w --width</li>
<li>-h --height</li>
<li>--dpi (default 96)</li>
<li>--languages</li></ol></li></ul>
<h3><span class="mw-headline" id="MediaWiki_external_converter">MediaWiki external converter</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=153" title="Edit section: MediaWiki external converter">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>For conventional MediaWiki, there is a configuration variable:
</p>
<ul><li><a class="external free" href="https://www.mediawiki.org/wiki/Manual:$wgSVGConverters">https://www.mediawiki.org/wiki/Manual:$wgSVGConverters</a></li></ul>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr" dir="ltr"><pre><span></span><span class="nv">$wgSVGConverters</span> <span class="o">=</span> <span class="p">[</span>
	<span class="s1">&#39;ImageMagick&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;$path/convert -background &quot;#ffffff00&quot; -thumbnail $widthx$height\\! $input PNG:$output&#39;</span><span class="p">,</span>
	<span class="s1">&#39;sodipodi&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;$path/sodipodi -z -w $width -f $input -e $output&#39;</span><span class="p">,</span>
	<span class="s1">&#39;inkscape&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;$path/inkscape -z -w $width -f $input -e $output&#39;</span><span class="p">,</span>
	<span class="s1">&#39;batik&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;java -Djava.awt.headless=true -jar $path/batik-rasterizer.jar -w $width -d $output $input&#39;</span><span class="p">,</span>
	<span class="s1">&#39;rsvg&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;$path/rsvg-convert -w $width -h $height -o $output $input&#39;</span><span class="p">,</span>
	<span class="s1">&#39;imgserv&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;$path/imgserv-wrapper -i svg -o png -w$width $input $output&#39;</span><span class="p">,</span>
	<span class="s1">&#39;ImagickExt&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s1">&#39;SvgHandler::rasterizeImagickExt&#39;</span><span class="p">,</span> <span class="p">],</span>
<span class="p">];</span>
</pre></div>
<p>The configuration should set the <code>$wgSVGConverter</code> variable. Presumably, that is set to <code>rsvg</code>.
</p><p>I thought there were type declarations in MediaWiki PHP code. See, for example,
</p>
<ul><li><a class="external free" href="https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/refs/heads/master/includes/upload/UploadBase.php">https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/refs/heads/master/includes/upload/UploadBase.php</a></li>
<li><a rel="nofollow" class="external free" href="https://github.com/wikimedia/svgtranslate">https://github.com/wikimedia/svgtranslate</a>
<ul><li><a rel="nofollow" class="external free" href="https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php">https://github.com/wikimedia/svgtranslate/blob/master/src/Model/Svg/SvgFile.php</a></li></ul></li></ul>
<p>See PHP info:
</p>
<ul><li><a rel="nofollow" class="external free" href="https://www.php.net/manual/en/language.types.declarations.php">https://www.php.net/manual/en/language.types.declarations.php</a></li></ul>
<p>It looks like the SVG Translate source has JavaDoc style annotations (but there was a strict assignment).
See
</p>
<ul><li><a rel="nofollow" class="external free" href="https://docs.phpdoc.org/">https://docs.phpdoc.org/</a></li></ul>
<p>See <a rel="nofollow" class="external free" href="https://www.php.net/manual/en/function.str-replace.php">https://www.php.net/manual/en/function.str-replace.php</a> and its "Replacement order gotcha" comment. Replacement is done left to right. The filename should always be rightmost.
</p>
<ul><li><a class="external free" href="https://doc.wikimedia.org/mediawiki-core/master/php/SvgHandler_8php_source.html">https://doc.wikimedia.org/mediawiki-core/master/php/SvgHandler_8php_source.html</a></li></ul>
<div class="mw-highlight mw-highlight-lang-php mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="327"></span>     <span class="k">public</span> <span class="k">function</span> <span class="nf">rasterize</span><span class="p">(</span> <span class="nv">$srcPath</span><span class="p">,</span> <span class="nv">$dstPath</span><span class="p">,</span> <span class="nv">$width</span><span class="p">,</span> <span class="nv">$height</span><span class="p">,</span> <span class="nv">$lang</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="328"></span>         <span class="nv">$mainConfig</span> <span class="o">=</span> <span class="nx">MediaWikiServices</span><span class="o">::</span><span class="na">getInstance</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getMainConfig</span><span class="p">();</span>
<span class="linenos" data-line="329"></span>         <span class="nv">$svgConverters</span> <span class="o">=</span> <span class="nv">$mainConfig</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span> <span class="nx">MainConfigNames</span><span class="o">::</span><span class="na">SVGConverters</span> <span class="p">);</span>
<span class="linenos" data-line="330"></span>         <span class="nv">$svgConverter</span> <span class="o">=</span> <span class="nv">$mainConfig</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span> <span class="nx">MainConfigNames</span><span class="o">::</span><span class="na">SVGConverter</span> <span class="p">);</span>
<span class="linenos" data-line="331"></span>         <span class="nv">$svgConverterPath</span> <span class="o">=</span> <span class="nv">$mainConfig</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span> <span class="nx">MainConfigNames</span><span class="o">::</span><span class="na">SVGConverterPath</span> <span class="p">);</span>
<span class="linenos" data-line="332"></span>         <span class="nv">$err</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="linenos" data-line="333"></span>         <span class="nv">$retval</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="linenos" data-line="334"></span>         <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$svgConverters</span><span class="p">[</span><span class="nv">$svgConverter</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="335"></span>             <span class="k">if</span> <span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$svgConverters</span><span class="p">[</span><span class="nv">$svgConverter</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="336"></span>                 <span class="c1">// This is a PHP callable</span>
<span class="linenos" data-line="337"></span>                 <span class="nv">$func</span> <span class="o">=</span> <span class="nv">$svgConverters</span><span class="p">[</span><span class="nv">$svgConverter</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
<span class="linenos" data-line="338"></span>                 <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">is_callable</span><span class="p">(</span> <span class="nv">$func</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="339"></span>                     <span class="k">throw</span> <span class="k">new</span> <span class="nx">MWException</span><span class="p">(</span> <span class="s2">&quot;</span><span class="si">$func</span><span class="s2"> is not callable&quot;</span> <span class="p">);</span>
<span class="linenos" data-line="340"></span>                 <span class="p">}</span>
<span class="linenos" data-line="341"></span>                 <span class="nv">$err</span> <span class="o">=</span> <span class="nv">$func</span><span class="p">(</span> <span class="nv">$srcPath</span><span class="p">,</span>
<span class="linenos" data-line="342"></span>                     <span class="nv">$dstPath</span><span class="p">,</span>
<span class="linenos" data-line="343"></span>                     <span class="nv">$width</span><span class="p">,</span>
<span class="linenos" data-line="344"></span>                     <span class="nv">$height</span><span class="p">,</span>
<span class="linenos" data-line="345"></span>                     <span class="nv">$lang</span><span class="p">,</span>
<span class="linenos" data-line="346"></span>                     <span class="o">...</span><span class="nb">array_slice</span><span class="p">(</span> <span class="nv">$svgConverters</span><span class="p">[</span><span class="nv">$svgConverter</span><span class="p">],</span> <span class="mi">1</span> <span class="p">)</span>
<span class="linenos" data-line="347"></span>                 <span class="p">);</span>
<span class="linenos" data-line="348"></span>                 <span class="nv">$retval</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bool</span><span class="p">)</span><span class="nv">$err</span><span class="p">;</span>
<span class="linenos" data-line="349"></span>             <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="linenos" data-line="350"></span>                 <span class="c1">// External command</span>
<span class="linenos" data-line="351"></span>                 <span class="nv">$cmd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span>
<span class="linenos" data-line="352"></span>                     <span class="p">[</span> <span class="s1">&#39;$path/&#39;</span><span class="p">,</span> <span class="s1">&#39;$width&#39;</span><span class="p">,</span> <span class="s1">&#39;$height&#39;</span><span class="p">,</span> <span class="s1">&#39;$input&#39;</span><span class="p">,</span> <span class="s1">&#39;$output&#39;</span> <span class="p">],</span>
<span class="linenos" data-line="353"></span>                     <span class="p">[</span> <span class="nv">$svgConverterPath</span> <span class="o">?</span> <span class="nx">Shell</span><span class="o">::</span><span class="na">escape</span><span class="p">(</span> <span class="s2">&quot;</span><span class="si">{</span><span class="nv">$svgConverterPath</span><span class="si">}</span><span class="s2">/&quot;</span> <span class="p">)</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos" data-line="354"></span>                         <span class="nb">intval</span><span class="p">(</span> <span class="nv">$width</span> <span class="p">),</span>
<span class="linenos" data-line="355"></span>                         <span class="nb">intval</span><span class="p">(</span> <span class="nv">$height</span> <span class="p">),</span>
<span class="linenos" data-line="356"></span>                         <span class="nx">Shell</span><span class="o">::</span><span class="na">escape</span><span class="p">(</span> <span class="nv">$srcPath</span> <span class="p">),</span>
<span class="linenos" data-line="357"></span>                         <span class="nx">Shell</span><span class="o">::</span><span class="na">escape</span><span class="p">(</span> <span class="nv">$dstPath</span> <span class="p">)</span> <span class="p">],</span>
<span class="linenos" data-line="358"></span>                     <span class="nv">$svgConverters</span><span class="p">[</span><span class="nv">$svgConverter</span><span class="p">]</span>
<span class="linenos" data-line="359"></span>                 <span class="p">);</span>
<span class="linenos" data-line="360"></span>  
<span class="linenos" data-line="361"></span>                 <span class="nv">$env</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos" data-line="362"></span>                 <span class="k">if</span> <span class="p">(</span> <span class="nv">$lang</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="363"></span>                     <span class="nv">$env</span><span class="p">[</span><span class="s1">&#39;LANG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$lang</span><span class="p">;</span>
<span class="linenos" data-line="364"></span>                 <span class="p">}</span>
<span class="linenos" data-line="365"></span>  
<span class="linenos" data-line="366"></span>                 <span class="nx">wfDebug</span><span class="p">(</span> <span class="no">__METHOD__</span> <span class="o">.</span> <span class="s2">&quot;: </span><span class="si">$cmd</span><span class="s2">&quot;</span> <span class="p">);</span>
<span class="linenos" data-line="367"></span>                 <span class="nv">$err</span> <span class="o">=</span> <span class="nx">wfShellExecWithStderr</span><span class="p">(</span> <span class="nv">$cmd</span><span class="p">,</span> <span class="nv">$retval</span><span class="p">,</span> <span class="nv">$env</span> <span class="p">);</span>
<span class="linenos" data-line="368"></span>             <span class="p">}</span>
<span class="linenos" data-line="369"></span>         <span class="p">}</span>
<span class="linenos" data-line="370"></span>         <span class="c1">// @phan-suppress-next-line PhanTypeMismatchArgumentNullable False positive</span>
<span class="linenos" data-line="371"></span>         <span class="nv">$removed</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">removeBadFile</span><span class="p">(</span> <span class="nv">$dstPath</span><span class="p">,</span> <span class="nv">$retval</span> <span class="p">);</span>
<span class="linenos" data-line="372"></span>         <span class="k">if</span> <span class="p">(</span> <span class="nv">$retval</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">||</span> <span class="nv">$removed</span> <span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-line="373"></span>             <span class="c1">// @phan-suppress-next-next-line PhanPossiblyUndeclaredVariable cmd is set when used</span>
<span class="linenos" data-line="374"></span>             <span class="c1">// @phan-suppress-next-line PhanTypeMismatchArgumentNullable cmd is set when used</span>
<span class="linenos" data-line="375"></span>             <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">logErrorForExternalProcess</span><span class="p">(</span> <span class="nv">$retval</span><span class="p">,</span> <span class="nv">$err</span><span class="p">,</span> <span class="nv">$cmd</span> <span class="p">);</span>
<span class="linenos" data-line="376"></span>             <span class="k">return</span> <span class="k">new</span> <span class="nx">MediaTransformError</span><span class="p">(</span> <span class="s1">&#39;thumbnail_error&#39;</span><span class="p">,</span> <span class="nv">$width</span><span class="p">,</span> <span class="nv">$height</span><span class="p">,</span> <span class="nv">$err</span> <span class="p">);</span>
<span class="linenos" data-line="377"></span>         <span class="p">}</span>
<span class="linenos" data-line="378"></span>  
<span class="linenos" data-line="379"></span>         <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="linenos" data-line="380"></span>     <span class="p">}</span>
</pre></div>
<p>The change is straightforward.
</p><p>Change the <code>rsvg</code> configuration (or make a <code>rsvglang</code>).
</p>
<dl><dd><code>'rsvg' =&gt; '$path/rsvg-convert -w $width -h $height -l $lang -o $output $input',</code></dd></dl>
<p>Should this line also have a <code>-u</code> to match Thumbor?
</p><p>Also add a <code>resvg</code> line
</p>
<dl><dd><code>'resvg' =&gt; '$path/resvg -w $width -h $height --languages $lang $input $output',</code></dd></dl>
<p>Before line 350, set <code>$lang</code> to an actual langtag:
</p>
<dl><dd><code>if ( $lang === false ) $lang = "en";</code></dd></dl>
<p>It might be cleaner to default <code>$lang = 'en'</code> in the argument list.... Declare the argument to be a string type.
</p><p>Add a <code>"$lang"</code> substitution in lines 352&#8211;357. The substitution should be before the <code>$input</code> position in the array.
</p><p>Delete lines 362&#8211;364 (do not pass a langtag in the environment). This will break old versions of <code>librsvg</code>.
</p>
<h3><span class="mw-headline" id="Thumbor">Thumbor</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=154" title="Edit section: Thumbor">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>For <code>librsvg</code> used by Thumbor
</p>
<ul><li><code><i>rsvg-convert</i> <i>source.svg</i> -u -f png -w <i>width</i> -h <i>height</i> --accept-language <i>lang</i></code></li></ul>
<ul><li><a class="external free" href="https://gerrit.wikimedia.org/r/plugins/gitiles/operations/software/thumbor-plugins/+/refs/heads/master/wikimedia_thumbor/engine/svg/svg.py">https://gerrit.wikimedia.org/r/plugins/gitiles/operations/software/thumbor-plugins/+/refs/heads/master/wikimedia_thumbor/engine/svg/svg.py</a></li></ul>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="40"></span>    <span class="k">def</span> <span class="nf">create_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer</span><span class="p">):</span>
<span class="linenos" data-line="41"></span>        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_source</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
<span class="linenos" data-line="42"></span>
<span class="linenos" data-line="43"></span>        <span class="n">command</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos" data-line="44"></span>            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">RSVG_CONVERT_PATH</span><span class="p">,</span>
<span class="linenos" data-line="45"></span>            <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">,</span>
<span class="linenos" data-line="46"></span>            <span class="s1">&#39;-u&#39;</span><span class="p">,</span>
<span class="linenos" data-line="47"></span>            <span class="s1">&#39;-f&#39;</span><span class="p">,</span>
<span class="linenos" data-line="48"></span>            <span class="s1">&#39;png&#39;</span>
<span class="linenos" data-line="49"></span>        <span class="p">]</span>
<span class="linenos" data-line="50"></span>
<span class="linenos" data-line="51"></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos" data-line="52"></span>            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;-w&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">width</span><span class="p">]</span>
<span class="linenos" data-line="53"></span>
<span class="linenos" data-line="54"></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="linenos" data-line="55"></span>            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;-h&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">height</span><span class="p">]</span>
<span class="linenos" data-line="56"></span>
<span class="linenos" data-line="57"></span>        <span class="n">env</span> <span class="o">=</span> <span class="kc">None</span>
<span class="linenos" data-line="58"></span>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">):</span>
<span class="linenos" data-line="59"></span>            <span class="n">env</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LANG&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">upper</span><span class="p">()}</span>
<span class="linenos" data-line="60"></span>
<span class="linenos" data-line="61"></span>        <span class="n">png</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
<span class="linenos" data-line="62"></span>
<span class="linenos" data-line="63"></span>        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="n">png</span><span class="p">)</span>
</pre></div>
<p>Change the above code:
</p><p>Add before line 57:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">lang</span><span class="p">]</span>
</pre></div>
<p>The <code>.upper()</code> is not needed; langtags are not case sensitive. Alternatively, an unspecified lang may be set to "en".
</p><p>Delete lines 58&#8211;59; do not pass the langtag in the environment.
</p>
<h2><span class="mw-headline" id="HTML_5">HTML 5</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=155" title="Edit section: HTML 5">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Wikitext supports some HTML markup.
</p>
<ul><li><abbr title="abbreviation">abbr</abbr></li>
<li>&lt;acronym title="Central Intelligence Agency"&gt;acronym CIA&lt;/acronym&gt; (deprecated)</li>
<li>&lt;address&gt;address&lt;/address&gt;</li>
<li>&lt;aside&gt;aside&lt;/aside&gt; (aside)</li>
<li><cite>cite</cite> (usage advice varies a lot for this element)</li>
<li><code>code</code></li>
<li><data value="17" title="value is 17">data</data></li>
<li>&lt;details&gt;&lt;summary&gt;details&lt;/summary&gt; The expanded description.&lt;/details&gt;</li>
<li><kbd>kbd (user input)</kbd></li>
<li><mark>mark</mark></li>
<li><q>q</q></li>
<li><rp>rp</rp> (rp should disappear; part of ruby)</li>
<li><ruby>ruby&#160; <rp>(</rp><rt>text</rt><rp>)</rp> 漢 <rp>(</rp><rt>kan</rt><rp>)</rp>字 <rp>(</rp><rt>ji</rt><rp>)</rp></ruby></li>
<li><samp>samp</samp> (sample output)</li>
<li><time datetime="12:00" title="12:00">time</time></li>
<li><var>var</var></li></ul>
<h2><span class="mw-headline" id="References">References</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit&amp;section=156" title="Edit section: References">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="reflist references-column-width" style="-moz-column-width:30em;-webkit-column-width:30em;column-width:30em; list-style-type: decimal;">
<ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="#cite_ref-1">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external text" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Caching">Caching</a>, Mozilla.org</span>
</li>
<li id="cite_note-2"><span class="mw-cite-backlink"><a href="#cite_ref-2">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://www.alibabacloud.com/blog/what-is-domain-resolution-and-how-it-works_597610">https://www.alibabacloud.com/blog/what-is-domain-resolution-and-how-it-works_597610</a></span>
</li>
<li id="cite_note-3"><span class="mw-cite-backlink"><a href="#cite_ref-3">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://serverfault.com/questions/347689/how-to-share-domain-name-with-multiple-servers">https://serverfault.com/questions/347689/how-to-share-domain-name-with-multiple-servers</a></span>
</li>
<li id="cite_note-4"><span class="mw-cite-backlink"><a href="#cite_ref-4">↑</a></span> <span class="reference-text">See <a rel="nofollow" class="external free" href="https://aeronav.faa.gov/user_guide/20211202/cug-complete.pdf">https://aeronav.faa.gov/user_guide/20211202/cug-complete.pdf</a> at page 43. In those images, the NDB symbol is a dot, ring, and only 5 dotted rings.</span>
</li>
<li id="cite_note-5"><span class="mw-cite-backlink"><a href="#cite_ref-5">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external text" href="https://www.w3.org/TR/SVG2/struct.html#DescriptionAndTitleElements">SVG 2.0 Chapter 5 Document Structure &#167; 5.8</a></span>
</li>
<li id="cite_note-6"><span class="mw-cite-backlink"><a href="#cite_ref-6">↑</a></span> <span class="reference-text">Cory Doctorow, <a rel="nofollow" class="external text" href="https://doctorow.medium.com/a-bug-in-early-creative-commons-licenses-has-enabled-a-new-breed-of-superpredator-5f6360713299">A Bug in early Creative Commons licenses has enabled a new breed of superpredator</a></span>
</li>
<li id="cite_note-7"><span class="mw-cite-backlink"><a href="#cite_ref-7">↑</a></span> <span class="reference-text"><a href="https://commons.wikimedia.org/wiki/Commons:Village_pump/Archive/2022/01#Cory_Doctorow_post_on_&quot;copyleft_trolls&quot;_mentions_Commons" title="Commons:Village pump/Archive/2022/01">Village Pump: Cory Doctorow post on "copyleft trolls" mentions Commons</a></span>
</li>
<li id="cite_note-8"><span class="mw-cite-backlink"><a href="#cite_ref-8">↑</a></span> <span class="reference-text"><a href="https://commons.wikimedia.org/wiki/Commons:Village_pump/Archive/2022/02#cc-by_&lt;_4.0_not_ok_any_more" title="Commons:Village pump/Archive/2022/02">Village pump:cc-by &lt; 4.0 not ok any more</a></span>
</li>
<li id="cite_note-9"><span class="mw-cite-backlink"><a href="#cite_ref-9">↑</a></span> <span class="reference-text">e.g., <a rel="nofollow" class="external free" href="https://id.loc.gov/vocabulary/relators.html">https://id.loc.gov/vocabulary/relators.html</a></span>
</li>
<li id="cite_note-10"><span class="mw-cite-backlink"><a href="#cite_ref-10">↑</a></span> <span class="reference-text">Adobe, <a rel="nofollow" class="external text" href="https://wwwimages2.adobe.com/content/dam/acom/en/devnet/xmp/pdfs/XMP SDK Release cc-2016-08/XMPSpecificationPart1.pdf">XMP Specification Part 1</a> at Table 4.</span>
</li>
<li id="cite_note-11"><span class="mw-cite-backlink"><a href="#cite_ref-11">↑</a></span> <span class="reference-text">Nevile, Liddy&#59; Lissonnet, Sophie&#32;(January 2004)&#32;<cite>The Case for a Person/Agent Dublin Core Metadata Element Set</cite><sup><a rel="nofollow" class="external autonumber" href="https://dcpapers.dublincore.org/pubs/article/download/780/776.pdf">[1]</a></sup></span>
</li>
<li id="cite_note-12"><span class="mw-cite-backlink"><a href="#cite_ref-12">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://www.compart.com/en/unicode/charsets/Adobe-Symbol-Encoding">https://www.compart.com/en/unicode/charsets/Adobe-Symbol-Encoding</a></span>
</li>
<li id="cite_note-13"><span class="mw-cite-backlink"><a href="#cite_ref-13">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://www.compart.com/en/unicode/charsets/x-Adobe-Zapf-Dingbats-Encoding">https://www.compart.com/en/unicode/charsets/x-Adobe-Zapf-Dingbats-Encoding</a></span>
</li>
<li id="cite_note-14"><span class="mw-cite-backlink"><a href="#cite_ref-14">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://fonts2u.com/sonata.font">https://fonts2u.com/sonata.font</a> <a rel="nofollow" class="external free" href="https://adobe-type-tools.github.io/font-tech-notes/pdfs/5045.Sonata.pdf">https://adobe-type-tools.github.io/font-tech-notes/pdfs/5045.Sonata.pdf</a></span>
</li>
<li id="cite_note-15"><span class="mw-cite-backlink"><a href="#cite_ref-15">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://stackoverflow.com/questions/36486716/the-14-standard-pdf-fonts-and-character-encoding">https://stackoverflow.com/questions/36486716/the-14-standard-pdf-fonts-and-character-encoding</a></span>
</li>
<li id="cite_note-16"><span class="mw-cite-backlink"><a href="#cite_ref-16">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://www.compart.com/en/unicode/charsets/Adobe-Standard-Encoding">https://www.compart.com/en/unicode/charsets/Adobe-Standard-Encoding</a></span>
</li>
<li id="cite_note-17"><span class="mw-cite-backlink"><a href="#cite_ref-17">↑</a></span> <span class="reference-text">Mozilla&#32;(2021)&#32;<cite>SVG Fonts</cite><sup><a rel="nofollow" class="external autonumber" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/SVG_fonts">[2]</a></sup></span>
</li>
<li id="cite_note-18"><span class="mw-cite-backlink"><a href="#cite_ref-18">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://www.enzolifesciences.com/science-center/technotes/2019/december/what-are-the-differences-between-northern-southern-and-western-blotting?/">https://www.enzolifesciences.com/science-center/technotes/2019/december/what-are-the-differences-between-northern-southern-and-western-blotting?/</a></span>
</li>
<li id="cite_note-19"><span class="mw-cite-backlink"><a href="#cite_ref-19">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://thumbor.readthedocs.io/en/latest/">https://thumbor.readthedocs.io/en/latest/</a></span>
</li>
<li id="cite_note-20"><span class="mw-cite-backlink"><a href="#cite_ref-20">↑</a></span> <span class="reference-text">“ꝺ” U+A77A Latin Small Letter Insular D Unicode Character</span>
</li>
<li id="cite_note-21"><span class="mw-cite-backlink"><a href="#cite_ref-21">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://linux.die.net/man/1/xsltproc">https://linux.die.net/man/1/xsltproc</a></span>
</li>
<li id="cite_note-22"><span class="mw-cite-backlink"><a href="#cite_ref-22">↑</a></span> <span class="reference-text"><a class="external free" href="https://www.wikidata.org/w/index.php?title=Special:Search&amp;limit=100&amp;offset=0&amp;profile=default&amp;search=Pershotravneve&amp;ns0=1&amp;ns120=1">https://www.wikidata.org/w/index.php?title=Special:Search&amp;limit=100&amp;offset=0&amp;profile=default&amp;search=Pershotravneve&amp;ns0=1&amp;ns120=1</a></span>
</li>
<li id="cite_note-23"><span class="mw-cite-backlink"><a href="#cite_ref-23">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://www.google.com/maps/place/Radekhiv,+Lviv+Oblast,+Ukraine/@50.2811748,24.6012475,13z">https://www.google.com/maps/place/Radekhiv,+Lviv+Oblast,+Ukraine/@50.2811748,24.6012475,13z</a></span>
</li>
<li id="cite_note-24"><span class="mw-cite-backlink"><a href="#cite_ref-24">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/circle">https://developer.mozilla.org/en-US/docs/Web/SVG/Element/circle</a></span>
</li>
<li id="cite_note-25"><span class="mw-cite-backlink"><a href="#cite_ref-25">↑</a></span> <span class="reference-text">See <a href="https://commons.wikimedia.org/wiki/File:SVG_CSS_Test.svg" title="File:SVG CSS Test.svg">File:SVG CSS Test.svg</a> for a test of <code>.cls2.cls3</code> selection.</span>
</li>
<li id="cite_note-26"><span class="mw-cite-backlink"><a href="#cite_ref-26">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://tc39.es/ecma402/#sec-intl-datetimeformat-constructor">https://tc39.es/ecma402/#sec-intl-datetimeformat-constructor</a></span>
</li>
<li id="cite_note-27"><span class="mw-cite-backlink"><a href="#cite_ref-27">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external text" href="https://www.wikihow.com/Write-the-Date-in-French">Write the Date in French</a>, wikihow.com. The first is pronounced "premier".</span>
</li>
<li id="cite_note-28"><span class="mw-cite-backlink"><a href="#cite_ref-28">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external text" href="https://www.thoughtco.com/italian-ordinal-numbers-2011379">Italian Ordinal Numbers and Numerical Rank</a>, thoughtco.com. "il primo".</span>
</li>
<li id="cite_note-29"><span class="mw-cite-backlink"><a href="#cite_ref-29">↑</a></span> <span class="reference-text">Inkscape Tutorial. Chapter 6. SVG File Format. <a rel="nofollow" class="external free" href="https://inkscapetutorial.org/svg-file-format.html">https://inkscapetutorial.org/svg-file-format.html</a></span>
</li>
<li id="cite_note-30"><span class="mw-cite-backlink"><a href="#cite_ref-30">↑</a></span> <span class="reference-text"><a class="external free" href="https://www.mediawiki.org/wiki/User:Jarry1250/GSoC_2012_roadmap">https://www.mediawiki.org/wiki/User:Jarry1250/GSoC_2012_roadmap</a></span>
</li>
<li id="cite_note-31"><span class="mw-cite-backlink"><a href="#cite_ref-31">↑</a></span> <span class="reference-text"><a href="https://meta.wikimedia.org/wiki/Community_Tech/SVG_translation" class="extiw" title="meta:Community Tech/SVG translation">Meta:Community Tech/SVG translation</a></span>
</li>
<li id="cite_note-32"><span class="mw-cite-backlink"><a href="#cite_ref-32">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://www.w3.org/TR/SVG/styling.html">https://www.w3.org/TR/SVG/styling.html</a></span>
</li>
<li id="cite_note-33"><span class="mw-cite-backlink"><a href="#cite_ref-33">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://drafts.csswg.org/selectors/#specificity-rules">https://drafts.csswg.org/selectors/#specificity-rules</a></span>
</li>
</ol></div>
<!-- 
NewPP limit report
Parsed by mw2305
Cached time: 20221014202427
Cache expiry: 1814400
Reduced expiry: false
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.579 seconds
Real time usage: 1.053 seconds
Preprocessor visited node count: 9746/1000000
Post‐expand include size: 52154/2097152 bytes
Template argument size: 14231/2097152 bytes
Highest expansion depth: 13/100
Expensive parser function count: 74/500
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 249042/5000000 bytes
Lua time usage: 0.062/10.000 seconds
Lua memory usage: 2149140/52428800 bytes
Number of Wikibase entities loaded: 0/400
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  659.565      1 -total
 19.78%  130.460     36 Template:Q
 18.94%  124.907     36 Template:Label
  4.32%   28.510      6 Template:Tracked/layout
  3.93%   25.899      1 Template:Reflist
  3.75%   24.708      3 Template:Phabricator
  3.21%   21.178     15 Template:Tl
  2.79%   18.390     15 Template:T/main
  2.01%   13.256      7 Template:Color
  1.90%   12.562      5 Template:Para
-->

<!-- Saved in parser cache with key commonswiki:pcache:idhash:113551363-0!dateformat=default and timestamp 20221014202426 and revision id 696349561.
 -->
</div><noscript><img src="http://commons.wikimedia.org/wiki/Special:CentralAutoLogin/start?type=1x1" alt="" title="" width="1" height="1" style="border: none; position: absolute;" /></noscript>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;oldid=696349561">https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;oldid=696349561</a>"</div></div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		

<nav id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" aria-labelledby="p-personal-label" role="navigation"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-uls" class="mw-list-item active"><a class="uls-trigger" href="#"><span>English</span></a></li><li id="pt-anonuserpage" class="mw-list-item"><span title="The user page for the IP address you are editing as">Not logged in</span></li><li id="pt-anontalk" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:MyTalk" title="Discussion about edits from this IP address [n]" accesskey="n"><span>Talk</span></a></li><li id="pt-anoncontribs" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:MyContributions" title="A list of edits made from this IP address [y]" accesskey="y"><span>Contributions</span></a></li><li id="pt-createaccount" class="mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=Special:CreateAccount&amp;returnto=User%3AGlrx" title="You are encouraged to create an account and log in; however, it is not mandatory"><span>Create account</span></a></li><li id="pt-login" class="mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=Special:UserLogin&amp;returnto=User%3AGlrx" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			

<nav id="p-namespaces" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-namespaces-label" role="navigation"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-user" class="selected mw-list-item"><a href="https://commons.wikimedia.org/wiki/User:Glrx" title="View the user page [c]" accesskey="c"><span>User page</span></a></li><li id="ca-talk" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/User_talk:Glrx" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown-noicon vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	/>
	<label
		id="p-variants-label"
		 aria-label="Change language variant"
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			

<nav id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-views-label" role="navigation"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected vector-tab-noicon mw-list-item"><a href="https://commons.wikimedia.org/wiki/User:Glrx"><span>View</span></a></li><li id="ca-edit" class="vector-tab-noicon mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=edit" title="Edit this page [e]" accesskey="e"><span>Edit</span></a></li><li id="ca-history" class="vector-tab-noicon mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>History</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown-noicon vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	/>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="https://commons.wikimedia.org/w/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search Wikimedia Commons" aria-label="Search Wikimedia Commons" autocapitalize="sentences" title="Search Wikimedia Commons [f]" accesskey="f" id="searchInput"
				>
				<input type="hidden" name="title" value="Special:MediaSearch">
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="https://commons.wikimedia.org/wiki/Main_Page"
			title="Visit the main page"></a>
	</div>
	

<nav id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigate</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-mainpage-description" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"><span>Main page</span></a></li><li id="n-welcome" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Commons:Welcome"><span>Welcome</span></a></li><li id="n-portal" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Commons:Community_portal" title="About the project, what you can do, where to find things"><span>Community portal</span></a></li><li id="n-village-pump" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Commons:Village_pump"><span>Village pump</span></a></li><li id="n-help" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out"><span>Help center</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-participate" class="vector-menu mw-portlet mw-portlet-participate vector-menu-portal portal" aria-labelledby="p-participate-label" role="navigation"  >
	<h3
		id="p-participate-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Participate</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-uploadbtn" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:UploadWizard"><span>Upload file</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-latestfiles" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:NewFiles"><span>Latest files</span></a></li><li id="n-randomimage" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:Random/File" title="Load a random file [x]" accesskey="x"><span>Random file</span></a></li><li id="n-contact" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Commons:Contact_us"><span>Contact us</span></a></li></ul>
		
	</div>
</nav>


<nav id="p-tb" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:WhatLinksHere/User:Glrx" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:RecentChangesLinked/User:Glrx" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="tb-uploads" class="mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=Special:ListFiles/Glrx&amp;ilshowall=1" title="A list of uploads by this user"><span>User uploads</span></a></li><li id="t-contributions" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:Contributions/Glrx" title="A list of contributions by this user"><span>User contributions</span></a></li><li id="t-log" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:Log/Glrx"><span>Logs</span></a></li><li id="t-userrights" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:UserRights/Glrx"><span>View user groups</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-permalink" class="mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;oldid=696349561" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;action=info" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>


<nav id="p-coll-print_export" class="vector-menu mw-portlet mw-portlet-coll-print_export vector-menu-portal portal" aria-labelledby="p-coll-print_export-label" role="navigation"  >
	<h3
		id="p-coll-print_export-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Print/export</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="coll-create_a_book" class="mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=Special:Book&amp;bookcmd=book_creator&amp;referer=User%3AGlrx"><span>Create a book</span></a></li><li id="coll-download-as-rl" class="mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=Special:DownloadAsPdf&amp;page=User%3AGlrx&amp;action=show-download-screen"><span>Download as PDF</span></a></li><li id="t-print" class="mw-list-item"><a href="https://commons.wikimedia.org/w/index.php?title=User:Glrx&amp;printable=yes" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 14 October 2022, at 15:20.</li>
	<li id="footer-info-copyright">Files are available under licenses specified on their description page. All structured data from the file namespace is available under the <a href="https://creativecommons.org/publicdomain/zero/1.0/" title="Definition of the Creative Commons CC0 License">Creative Commons CC0 License</a>; all unstructured text is available under the <a href="https://creativecommons.org/licenses/by-sa/3.0/" title="Definition of the Creative Commons Attribution/Share-Alike License">Creative Commons Attribution-ShareAlike License</a>;
additional terms may apply.
By using this site, you agree to the <a href="http://foundation.wikimedia.org/wiki/Terms_of_Use" title="Wikimedia Foundation Terms of Use">Terms of Use</a> and the <a href="http://foundation.wikimedia.org/wiki/Privacy_policy" title="Wikimedia Foundation Privacy Policy">Privacy Policy</a>.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://foundation.wikimedia.org/wiki/Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="https://commons.wikimedia.org/wiki/Commons:Welcome">About Wikimedia Commons</a></li>
	<li id="footer-places-disclaimers"><a href="https://commons.wikimedia.org/wiki/Commons:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="http://commons.m.wikimedia.org/w/index.php?title=User:Glrx&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
	<li id="footer-places-developers"><a href="https://developer.wikimedia.org/">Developers</a></li>
	<li id="footer-places-statslink"><a href="https://stats.wikimedia.org/#/commons.wikimedia.org">Statistics</a></li>
	<li id="footer-places-cookiestatement"><a href="https://foundation.wikimedia.org/wiki/Cookie_statement">Cookie statement</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://wikimediafoundation.org/"><img src="https://commons.wikimedia.org/static/images/footer/wikimedia-button.png" srcset="/static/images/footer/wikimedia-button-1.5x.png 1.5x, /static/images/footer/wikimedia-button-2x.png 2x" width="88" height="31" alt="Wikimedia Foundation" loading="lazy" /></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="https://commons.wikimedia.org/static/images/footer/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/static/images/footer/poweredby_mediawiki_132x47.png 1.5x, /static/images/footer/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.579","walltime":"1.053","ppvisitednodes":{"value":9746,"limit":1000000},"postexpandincludesize":{"value":52154,"limit":2097152},"templateargumentsize":{"value":14231,"limit":2097152},"expansiondepth":{"value":13,"limit":100},"expensivefunctioncount":{"value":74,"limit":500},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":249042,"limit":5000000},"entityaccesscount":{"value":0,"limit":400},"timingprofile":["100.00%  659.565      1 -total"," 19.78%  130.460     36 Template:Q"," 18.94%  124.907     36 Template:Label","  4.32%   28.510      6 Template:Tracked/layout","  3.93%   25.899      1 Template:Reflist","  3.75%   24.708      3 Template:Phabricator","  3.21%   21.178     15 Template:Tl","  2.79%   18.390     15 Template:T/main","  2.01%   13.256      7 Template:Color","  1.90%   12.562      5 Template:Para"]},"scribunto":{"limitreport-timeusage":{"value":"0.062","limit":"10.000"},"limitreport-memusage":{"value":2149140,"limit":52428800}},"cachereport":{"origin":"mw2305","timestamp":"20221014202427","ttl":1814400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":149,"wgHostname":"mw2276"});});</script>
</body>

<!-- Mirrored from commons.wikimedia.org/wiki/User:Glrx by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 15 Oct 2022 19:10:17 GMT -->
</html>